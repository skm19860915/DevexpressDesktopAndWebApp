(function(a){a.createUIComponent("autoCompleteFactory",{initialize:function(){return new EzRez.UI.AutoCompleteFactory();},applyListeners:function(b){b.createAll();}});a.load("autoCompleteFactory");})(EzRez.Application);(function(a){a.createUIComponent("waitingDialog",{initialize:function(b){var c=Object.extend({name:"waiting_dialog",position:"center"},b);return new EzRez.UI.Dialog(c);}});})(EzRez.Application);(function(b){var a=EzRez.Util.Event.pubsub;b.createUIComponent("options-click-manager",(function(){var c=function(d){var i=$H({optionsDivId:"optionsContainer"}).merge(d).toObject();var f;var h=[];var e=0;var j=function(k){for(var l=0;l<e;l++){h[l](k);}};var g=function(){if(f){Event.stopObserving(f,"click",j);f=null;}f=document.getElementById(i.optionsDivId);if(f){Event.observe(f,"click",j);}};this.registerListenerCallback=function(k,l){h.push(l);e++;};g();this.updateClickManager=g;};return{initialize:function(d){return new c(d);}};})());b.createUIComponent("pagination-handler",(function(){var c=function(l){var Q=$H({optionsContainerId:"optionsContainer",paginationSummaryContainerId:"paginationSummary",paginationFooterContainerId:"optionsFooter",activePageClassName:"pageActive",disabledPageClassName:"pageLinkDisabled",nextPageClassName:"pageNext",previousPageClassName:"pagePrevious",pageNumberIdPrefix:"pageNum",pageNavigationContainerClassName:"paginationContainer",resultsPerPage:10,resultsPerPageParamName:"results_per_page",sortingParamName:"sorting",currentSorting:"",pageParamName:"page_requested",numResultsClassName:"numResults",dataUrl:"/travel/arc_process.cfm",responseType:"json",waitingText:"Updating Airlines, please wait...",additionalPaginationGetParams:{},filteringManagerComponentName:"air-shop-filtering"}).merge(l).toObject();var p=1;var r;var O=parseInt(Q.resultsPerPage,10);var g=Q.currentSorting;var D=null;var o={};var k={setFilteredResultsTotal:function(){console.log("filterManager not implemented");}};var I;var N=0;var q=function(){N++;if(N>=4){clearInterval(I);}if(!b.use(Q.filteringManagerComponentName)){return;}k=b.use(Q.filteringManagerComponentName);D=k.currentActiveFilters();clearInterval(I);};I=setInterval(q,100);var A=YAHOO.util.Connect;var G=false;var z;var H="";for(var m in Q.additionalPaginationGetParams){H+="&"+encodeURIComponent(m)+"="+encodeURIComponent(Q.additionalPaginationGetParams[m]);}var x=new EzRez.UI.Dialog({name:"waiting_dialog",headerContent:Q.waitingText});var B=document.getElementById("paginationSummary");var h=document.getElementById(Q.optionsContainerId);if(!h||h=="undefined"){return;}var E;var C;var M=document.getElementById(Q.paginationSummaryContainerId);var R=document.getElementById(Q.paginationFooterContainerId);var u=Element.down(M,"div."+Q.pageNavigationContainerClassName);var j=Element.down(R,"div."+Q.pageNavigationContainerClassName);var J=function(S){var i={STATUS:"false",MESSAGE:"invalid response"};if(S.responseXML){var t=S.responseXML.documentElement;i.STATUS=t.getElementsByTagName("status")[0].firstChild.nodeValue;if(i.STATUS=="true"){i.MESSAGE=t.getElementsByTagName("responseMessage")[0].firstChild.nodeValue;i.CONTENT=t.getElementsByTagName("content")[0].firstChild.nodeValue;i.STARTINDEX=parseInt(t.getElementsByTagName("startIndex")[0].firstChild.nodeValue,10);i.ENDINDEX=parseInt(t.getElementsByTagName("endIndex")[0].firstChild.nodeValue,10);i.NUMBER_RESULTS_RETURNED=parseInt(t.getElementsByTagName("numberResultsReturned")[0].firstChild.nodeValue,10);i.PAGE=parseInt(t.getElementsByTagName("page")[0].firstChild.nodeValue,10);i.TOTALRESULTS=parseInt(t.getElementsByTagName("totalResults")[0].firstChild.nodeValue,10);}}return i;};var f=function(i){if(Q.responseType=="json"){try{return i.responseText.evalJSON();}catch(t){return{STATUS:false,MESSAGE:t.message};}}else{if(Q.responseType=="xml"){return J(i);}else{throw new Error("unrecognized response type: "+Q.responseType);}}};var w=function(t){if(t.status!=200){v(t);}var i=f(t);if(i.STATUS!=true){v(t);return;}h=e(h,i.CONTENT);if(b.use("options-click-manager")){b.use("options-click-manager").updateClickManager();}if(b.use("showFareRulesComponent")){b.use("showFareRulesComponent").updateListeners();}if(b.use("showBrandedFaresComponent")){b.use("showBrandedFaresComponent").updateListeners();}if(b.use("carSelectButtonHandler")){b.use("carSelectButtonHandler").reloadListeners(D);}k.setFilteredResultsTotal(i.TOTALRESULTS);d(i);if(B&&G){Element.scrollTo(B);}G=false;x.hide();if(Q.amexRuleMessageEnabled){AmexFalcon.init();}a.publish("pagination-handler/succeeded");};var e;if(Prototype.Browser.IE){e=function(S,t){var i=typeof S==="string"?document.getElementById(S):S;i.innerHTML=t;return i;};}else{e=function(S,t){var i=typeof S==="string"?document.getElementById(S):S;var T=i.cloneNode(false);T.innerHTML=t;i.parentNode.replaceChild(T,i);return T;};}var y=function(S,V,Y){var X=true,T="dummy=1";for(var t in V){if(V.hasOwnProperty(t)){var U=V[t],Z=S[t];if(X&&(!Z||Z.length!=U.length)){X=false;}for(var W=0;W<U.length;W++){if(X&&(U[W]!=Z[W])){X=false;}U[W]=U[W].replace(/,/g,"~");T+="&"+encodeURIComponent(t)+"="+encodeURIComponent(U[W]);}}}Y._val=T;return X;};var F=function(S,Y,V){var X=Object.keys(S).length==Object.keys(Y).length,T="";for(var t in Y){if(Y.hasOwnProperty(t)){var U=Y[t],Z=S[t];if(U){if(X&&(!Z||U!=Z)){X=false;}T+="&"+encodeURIComponent("selectedAirPnr")+"="+encodeURIComponent(t);for(var W=0;W<U.length;W++){T+="&"+encodeURIComponent("selectedLegs")+"="+encodeURIComponent(U[W]);}}else{X=false;}}}V._val=X?"":T;return X;};var v=function(t){x.hide();var i=unescape(window.location.pathname);window.location.replace(i);};var K=function(i){v(i);};var P={success:w,failure:K};var d=function(U){p=parseInt(U.PAGE,10);var Y=parseInt(U.TOTALRESULTS,10);r=Math.ceil(Y/O);if(E){var S=(U.PAGE*O)-O+1;var W=S+O-1;if(W>Y){W=Y;}E.innerHTML=String(S)+" - "+String(W);if(C){C.innerHTML=String(Y);}}var X=Element.select(u,"a");if(u){var i=Element.down(u,"."+Q.activePageClassName);if(i){Element.removeClassName(i,Q.activePageClassName);}var t=1;if(p<=3||r<=5){t=1;}else{if(p>=(r-2)){t=(r-4);}else{t=p-2;}}for(var T=1;T<=5;T++){var V=t+(T-1);if(V>r){V="&nbsp;";Element.addClassName(X[T],Q.disabledPageClassName);Element.setStyle(X[T],{textDecoration:"none"});}else{Element.removeClassName(X[T],Q.disabledPageClassName);Element.setStyle(X[T],{textDecoration:""});}X[T].innerHTML=V;if(V==p){Element.addClassName(X[T],Q.activePageClassName);}else{Element.removeClassName(X[T],Q.activePageClassName);}}if(p===1){Element.addClassName(X[0],Q.disabledPageClassName);}else{Element.removeClassName(X[0],Q.disabledPageClassName);}if(p===r){Element.addClassName(X[6],Q.disabledPageClassName);}else{Element.removeClassName(X[6],Q.disabledPageClassName);}if(j){j.innerHTML=u.innerHTML;}}};var s=function(ac,U,i,Z,t,X){G=!!Z;i=i||D;U=U||g;ac=ac||p;t=t||o;var Y={_val:""},V={_val:""},W=y(D,i,Y),T=F(o,t,V);if(!X){if(ac==p&&U==g&&W&&T){a.publish("pagination-handler/nothingChanged");return;}}D=i;o=t;var S=false,ab=U;if(U.toLowerCase().match("desc$")=="desc"){S=true;ab=U.substr(0,(U.length-4));}g=U;x.show();var aa=Q.dataUrl+"?content_type="+Q.responseType+"&"+encodeURIComponent(Q.pageParamName)+"="+ac+"&"+encodeURIComponent(Q.resultsPerPageParamName)+"="+O+"&sortDesc="+encodeURIComponent(S)+"&"+encodeURIComponent(Q.sortingParamName)+"="+encodeURIComponent(ab)+H;if(z&&A.isCallInProgress(z)){A.abort(z,null,false);}z=A.asyncRequest("POST",aa,P,Y._val+V._val);};var L=function(V){var T=Event.element(V);if(T.tagName.toLowerCase()!="a"){return;}if(Element.hasClassName(T,Q.activePageClassName)){Event.stop(V);return;}var S=T.parentNode;if(!Element.hasClassName(S,Q.pageNavigationContainerClassName)){return;}Event.stop(V);var t=false;var U=Element.up(T,"#"+Q.paginationFooterContainerId);if(U){t=true;}var i;if(Element.hasClassName(T,Q.disabledPageClassName)){return;}else{if(Element.hasClassName(T,Q.nextPageClassName)){i=p+1;if(i>r){return;}}else{if(Element.hasClassName(T,Q.previousPageClassName)){i=p-1;if(i<0){return;}}else{i=parseInt(T.firstChild.nodeValue,10);}}}T.blur();s(i,null,null,t);a.publish("pagination-handler/paginationClicked",[i]);};if(M){Event.observe(M,"click",L);var n=Element.select(M,"span."+Q.numResultsClassName+" strong");E=n[0];C=n[1];}if(R){Event.observe(R,"click",L);}this.getPageContentAndUpdate=s;};return{initialize:function(d){return new c(d);}};})());b.createUIComponent("availability-sorting",(function(){var c=function(d){var h=$H({sortingContainerDiv:"optionsSorting",availableSorting:["sortAirline","sortDepart","sortArrive","sortDuration","sortPrice"],defaultSorting:"sortPrice",defaultSortDirection:"ascending",ascendingSortClass:"sortAscending",descendingSortClass:"sortDescending"}).merge(d).toObject();var f=document.getElementById(h.sortingContainerDiv);if(!f){throw new Error("Missing sorting box: #"+h.sortingContainerDiv);}var e=h.defaultSorting;if(h.defaultSortDirection=="descending"){e=e+"Desc";}var g=function(j){e=j;b.use("pagination-handler").getPageContentAndUpdate(1,j);};var i=function(o){var r=Event.element(o);if(r.tagName.toLowerCase()!="a"){r=Element.up(r,"a");if(!r){return;}}if(r.parentNode.tagName.toLowerCase()!="div"){return;}var l="";var q=h.availableSorting.length;for(var p=0;p<q;p++){if(Element.hasClassName(r.parentNode,h.availableSorting[p])){l=h.availableSorting[p];break;}}if(l==""){return;}Event.stop(o);var k=Element.select(f,"."+h.ascendingSortClass);k.each(function(n){Element.removeClassName(n,h.ascendingSortClass);});var j=Element.select(f,"."+h.descendingSortClass);j.each(function(n){Element.removeClassName(n,h.descendingSortClass);});a.publish("pagination-handler/sortingClicked",[l]);var m=h.ascendingSortClass;if(l==e){l=l+"Desc";m=h.descendingSortClass;}Element.addClassName(r.parentNode,m);g(l);};Event.observe(f,"click",i);};return{initialize:function(d){return new c(d);}};})());})(EzRez.Application);(function(a){var c=window.addEventListener,b=window.attachEvent;a.createUIComponent("activityPagination",(function(){var d=function(n){var p=$H({pagerLinks:$$(".arc_pager a.page").findAll(function(v){return !v.hasClassName("inactive");}),activityAvailabilityForm:$$('[name="activityAvailabilityForm"]')[0],actStartIndexField:$$('[name="act_start_index"]')[0],actIsChangingPageField:$$('[name="act_is_changing_page"]')[0],moreActivityCategories:$$(".activity_more_categories_button"),selectedActivityChoicesField:$$('[name="selected_activity_choices_in_other_pages"]')[0]}).merge(n).toObject(),h=[],i;if(p.selectedActivityChoicesField&&p.selectedActivityChoicesField.value.length>0){i=JSON.parse(p.selectedActivityChoicesField.value);if(i.choices&&i.choices.length){var k,r;for(var f=0;f<i.choices.length;f++){k=i.choices[f];r=$$("input[value='"+k.key+"']");var t=(r&&r.length>0);if(!t){h.push(k);}else{r[0].checked=true;if(k.event){var u="[name='"+k.event.fieldName+"']";$$(u)[0].value=k.event.fieldValue;}if(k.crsName){$$("[name='"+k.crsName.fieldName+"']")[0].value=k.crsName.fieldValue;}if(k.quanties){var m=$$("[name='"+k.quanties.fieldName+"']");if(m&&m.length>0){for(var s=0;s<m.length;s++){m[s].value=k.quanties.selectedQuantities[s];}}}}}}}i={choices:h};function l(x,w){x=x.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var v="[\\?&]"+x+"=([^&#]*)";var z=new RegExp(v);var y=z.exec(w);if(y===null){return"";}else{return decodeURIComponent(y[1].replace(/\+/g," "));}}function o(){var B=$$(".activity_choice_card"),F=[];for(var z=0;z<B.length;z++){var E=B[z],v=E.down('input[name="activityChoicesKeys"]'),A=E.down(".date_events"),w=E.down(".crsName"),D=E.select(".activity_quantity"),y;if(A&&A.selectedIndex>=0){y=A.options[A.selectedIndex].value;}if(D===undefined||D.length===0){D=E.select('input[type="hidden"]').findAll(function(G){return G.name.indexOf("qty_")>=0;});}if(v.type==="hidden"||(v.type==="checkbox"&&v.checked&&y)){var x={key:v.value};if(A!==undefined){x.event={fieldName:A.name,fieldValue:A.value};}if(w!==undefined){x.crsName={fieldName:w.name,fieldValue:w.value};}if(D&&D.length>0){x.quanties={fieldName:D[0].name,selectedQuantities:[]};for(var C=0;C<D.length;C++){x.quanties.selectedQuantities.push(D[C].value);}}F.push(x);}}return F;}function g(){var v=$$('[name="activityChoicesKeys"]');for(var w=0;w<v.length;w++){v[w].checked=false;}}function q(v){document.activityAvailabilityForm.add_activity_and_continue_to_checkout.value="false";document.activityAvailabilityForm.act_start_index.value="1";document.activityAvailabilityForm.show_alone_activity_choices.value="true";e();}function j(y){var w=y.target,v=y.srcElement;y.preventDefault?y.preventDefault():y.returnValue=false;function x(z){p.actStartIndexField.value=l("act_start_index",z.href);}if(w){x(w);}else{if(v){x(v);}}e();}function e(){var w=a.use("activityValidator");var v=o();i.choices=i.choices.concat(v);if(i.choices.length>0){p.selectedActivityChoicesField.value=JSON.stringify(i);}else{p.selectedActivityChoicesField.value="";}p.actIsChangingPageField.value="true";w.validateAndSubmit(p.activityAvailabilityForm);}this.applyListeners=function(){for(var w=0;w<p.pagerLinks.length;w++){var v=p.pagerLinks[w];if(v&&c){v.addEventListener("click",j);}else{if(v&&b){v.attachEvent("onclick",j);}}}var x=p.moreActivityCategories;if(x.length>0){x.each(function(y){y.addEventListener("click",q);});}};this.removeListeners=function(){};};return{initialize:function(e){return new d(e);},applyListeners:function(e){e.applyListeners();},removeListeners:function(e){e.removeListeners();},unload:function(e){e.removeListeners();}};})());a.createUIComponent("activityFiltersMap",(function(){var d=function(){var e=a.load("activityAutoCompleteController");};return{initialize:function(){var e=new d();return e;}};})());a.createUIComponent("activityValidator",(function(){var d=function(f){var j=true;this.setUserConfirm=function(m){j=m;};function i(n,o){var r=false;var m=n.isSpecial?n.isSpecial.value:false;var q=n.is_fit_add_to?n.is_fit_add_to.value:false;var p=a.use("waitingDialog");if(m==="true"){r=l(o);}else{if(q==="true"){r=h(n,o);}else{r=h(n,o);}}if(r&&g()){if(p!==null){p.show();}submitForm(n.name);}}function g(){return !a.use("quickAddAir")||(a.use("quickAddAir")&&a.use("quickAddAir").isQuickAirConfirmed());}function h(m,s){j=true;EzRez.Util.Event.pubsub.publish("itinerary/submitForm",[s]);if(!j){return false;}var n=$$('input[name^="activityChoicesKeys"]'),o,t=[],q,p,r=[],v=[],u;for(q=0;q<n.length;q+=1){if(n[q].checked||n[q].type==="hidden"){o=n[q];p=o.up(".activity_choice_card").select(".date_events").first();if(p){u=0;if(!p.options[p.selectedIndex].value){alert(f.translations.ACTIVITY_DATE_NOT_SELECTED_ALERT);return false;}else{r=o.up(".activity_choice_card").select(".activity_quantity");r.each(function(x){var w=x.options[x.selectedIndex].value;if(w>0){u=w;}});v=o.up(".activity_choice_card").select('input[name^="qty_"]');v.each(function(w){if(w&&w.value>0){u=w.value;}});if(u<=0){alert(f.translations.ACTIVITY_MORE_INFO_REQUIRED);return false;}}}}}return true;}function l(q){j=true;EzRez.Util.Event.pubsub.publish("itinerary/submitForm",[q]);if(!j){return false;}var t=$$(".activity_card");var o=0;var p=false;for(var n=0;n<t.length;n+=1){var m=t[n];var r=m.down("input[type=radio]");var s=null;if(r!==null&&typeof r!=="undefined"){s=m.down("input[type=radio]:checked");}else{s=m.down("input[type=hidden]");}if(s===null||s===undefined){break;}p=k(s);if(!p){alert(f.translations.ACTIVITY_DATE_NOT_SELECTED_ALERT);return false;}o+=1;}if(o!==t.length){alert(f.translations.ACTIVITY_PER_GROUP_NOT_SELECTED_ALERT);return false;}return true;}function k(m){var o=m.up(".activity_card");var n=o.select(".date_events");return n.length<=0||e(n);}function e(o){for(var n=0;n<o.length;n++){var p=o[n];var m=p.up(".activity_choice_card");if(!!p&&p.value){return true;}}return false;}this.applyListeners=function(){var p=$$(".activity_continue_button"),r=$$("form.activity-availability-form .activity_recalculate_button").first(),q=$$('form[name^="activityAvailabilityForm"]').first()||$$('form[name^="arc_availability"]').first();if(p.length>0){for(var o=0;o<p.length;o++){var n=p[o];if(n&&c){n.addEventListener("click",function(){i(q,true);});}else{if(n&&b){n.attachEvent("onclick",function(){i(q,true);});}}}}function m(){q.show_alone_activity_choices.value=false;q.add_activity_and_continue_to_checkout.value=false;q.recalc_act_start_index.value=q.act_start_index.value;i(q,false);}if(r&&c){r.addEventListener("click",function(){m();});}else{if(r&&b){r.attachEvent("onclick",function(){m();});}}};this.validateAndSubmit=function(m){return i(m);};};return{initialize:function(e){return new d(e);},applyListeners:function(e){e.applyListeners();}};})());a.createUIComponent("activityMaxPaxValidator",(function(){var d=function(){this.applyListeners=function(){var i=$$(".activity_quantity");if(i.length!==0){i.each(function(k){k.observe("change",function(o){var q=k.up(".avail_details_item");q.select('input[name^="activityChoicesKeys"]').first().setAttribute("checked",true);var n=q.select(".date_events").first();var p=parseInt(n.options[n.selectedIndex].readAttribute("inventory"));if(p){var m=0;var r=k.up("tbody").select(".activity_quantity");for(var l=0;l<r.length;l++){m+=parseInt(r[l].options[r[l].selectedIndex].value);}if(m>p){confirm(maximum_activity_inventory_exceeded.replace(/#quantity#/i,p));r.each(h);}}});});}var e=$$(".date_events");if(e.length!==0){e.each(function(k){k.observe("change",function(l){k.up(".avail_details_item").select(".activity_quantity").each(function(n){g(k.selectedIndex>0,n);var p=parseInt(k.options[k.selectedIndex].readAttribute("inventory"));if(p){var m=Math.min(p,n[n.options.length-1].value);var o=Array.prototype.slice.call(n.options,0);o.each(Element.show);o.filter(function(q){return q.value>m;}).each(Element.hide);}});});});}var h=function(l,n){l.options[l.selectedIndex===-1?0:l.selectedIndex].selected=false;var m=parseInt(l.readAttribute("chosenqty"));if(m){m=Math.min(m,n);var k=Array.prototype.slice.call(l.options,0).find(function(o){return o.value===m;});if(k){k.selected=true;}else{l.options[0].selected=true;}}};function g(l,k){if(l){k.removeAttribute("disabled");}else{k.writeAttribute("disabled");k[0].selected=true;}}function j(l,k){g(l,k);}function f(k,l){l.select("select.date_events").each(function(m){j(k,m);});}$$("table input[type=checkbox]").each(function(l){var k=l.up("table");if(l.checked){k.select("select.activity_quantity").each(function(m){m.removeAttribute("disabled");});}f(l.checked,k);l.observe("change",function(n){var m=l.checked;f(m,k);if(!m){k.select("select.activity_quantity").each(function(o){o.writeAttribute("disabled");});}});});};};return{initialize:function(){return new d();},applyListeners:function(e){e.applyListeners();}};})());a.load("activityFiltersMap");})(EzRez.Application);(function(b){var a=b.createDOMController("activityAutoCompleteController",{after:function(c){if(!$("hotel_filter")||!$("activity_results")){return;}b.load("activityAutoComplete",{inputElement:"hotel_filter",resultsElement:"activity_results",filterNameElement:"activitySearchNameFilter"});b.use("activityAutoComplete").init();}});})(EzRez.Application);(function(c){var b=EzRez.Util.Event.pubsub;var d=function(f){var e=Object.extend({hotelDisplay:"",query:"",url:""},f);this.hotelDisplay=e.hotelDisplay;this.query=e.query;this.url=e.url;};var a=function(j){var l=Object.extend({inputElement:null,resultsElement:null,filterNameElement:null,url:"/service/autocomplete/",FORCE_SELECTION:true,USE_SHADOW:true,ANIM_HORIZ:true,ANIM_SPEED:0.3,MAX_RESULTS_DISPLAYED:15,QUERY_DELAY:0},j);var p;var n;var g;function m(){p=f(l.inputElement);n=f(l.resultsElement);g=f(l.filterNameElement).getValue();i();}function f(q){q=$(q);if(!Object.isElement(q)){q=$$(q).first();}return q;}function h(t,r){p.value="";var q=new d(r[2]);var s=c.use("searchFilterSettingsComponent");if(s){s.saveHotelSearchFilterSettings();}location.href=q.url;}function k(q){p.value="";}function o(r,s){var q=new d(r);return q.hotelDisplay;}function e(q){b.publish("HotelAutoComplete/requestGenerated");return"?"+Object.toQueryString({query:q,filter:g});}function i(){var r=new YAHOO.util.XHRDataSource(l.url);r.responseType=YAHOO.util.XHRDataSource.TYPE_JSON;r.maxCacheEntries=50;r.responseSchema={resultsList:"autoCompleteResults",fields:["hotelDisplay","query","url"]};var q=new YAHOO.widget.AutoComplete(p,n,r);q.queryDelay=l.QUERY_DELAY;q.maxResultsDisplayed=l.MAX_RESULTS_DISPLAYED;q.forceSelection=l.FORCE_SELECTION;q.useShadow=l.USE_SHADOW;q.animHoriz=l.ANIM_HORIZ;q.animSpeed=l.ANIM_SPEED;q.resultTypeList=false;q.formatResult=o;q.generateRequest=e;q.textboxFocusEvent.subscribe(k);q.itemSelectEvent.subscribe(h);}this.init=m;};c.createUIComponent("hotelAutoComplete",{initialize:function(e){return new a(e);}});})(EzRez.Application);(function(b){var c=function(e){var d=Object.extend({activityDisplay:"",query:"",url:""},e);this.activityDisplay=d.activityDisplay;this.query=d.query;this.url=d.url;};var a=function(i){var j=Object.extend({inputElement:null,resultsElement:null,filterNameElement:null,url:"/service/autocomplete/",FORCE_SELECTION:true,USE_SHADOW:true,ANIM_HORIZ:true,ANIM_SPEED:0.3,MAX_RESULTS_DISPLAYED:15,QUERY_DELAY:0},i);var o;var m;var f;function k(){o=e(j.inputElement);m=e(j.resultsElement);f=e(j.filterNameElement).getValue();h();}function e(p){p=$(p);if(!Object.isElement(p)){p=$$(p).first();}return p;}function l(p){o.value="";}function g(r,q){o.value="";var p=new c(q[2]);location.href=p.url;}function n(q,r){var p=new c(q);return p.activityDisplay;}function d(p){return"?"+Object.toQueryString({query:p,filter:f});}function h(){var q=new YAHOO.util.XHRDataSource(j.url);q.responseType=YAHOO.util.XHRDataSource.TYPE_JSON;q.maxCacheEntries=50;q.responseSchema={resultsList:"autoCompleteResults",fields:["activityDisplay","query","url"]};var p=new YAHOO.widget.AutoComplete(o,m,q);p.queryDelay=j.QUERY_DELAY;p.maxResultsDisplayed=j.MAX_RESULTS_DISPLAYED;p.forceSelection=j.FORCE_SELECTION;p.useShadow=j.USE_SHADOW;p.animHoriz=j.ANIM_HORIZ;p.animSpeed=j.ANIM_SPEED;p.resultTypeList=false;p.formatResult=n;p.generateRequest=d;p.textboxFocusEvent.subscribe(l);p.itemSelectEvent.subscribe(g);}this.init=k;};b.createUIComponent("activityAutoComplete",{initialize:function(d){return new a(d);}});})(EzRez.Application);(function(a){var b=function(h){var e=a.SysConf.systemTime.clone(),k=Object.extend({calendarButtonSelector:"a.calendar-image",minDaysAdvance:0,maxDaysAdvance:0},h),c=k.minDaysAdvance,f=k.maxDaysAdvance;var g=new EzRez.UI.CalendarFormInput(Object.extend({minDate:c>0?e.addDays(c):e,maxDate:f>0?e.clone().addDays(f):null},h));var l=new EzRez.App.DOMController({});l.addAction("document,click",function(o,n){var p=o.findElement(".datePickerInput");if(p){d(o,p);}});l.addAction(k.calendarButtonSelector+",click",function(p,o){Event.stop(p);var q=$(p.target);if(q.nodeName.strip().toLowerCase()!=="a"){q=q.up("a");}if(!q){return;}var r=q.href.split("#")[1];var n=$(r);if(!n){n=$$("."+r).first();}if(!n){return;}d(p,n);});var m=function(){window.gfPop={};window.popCal=function(n,o,p){g.addInput("date1");g.addInput("date2");g.show(n);};};function d(o,q){var p=q.up(".dateLabeledInput");if(p){var n=p.down(".dateFormat").getValue();if(EzRez.StringUtil.isSet(n)){g.setDateFormat(n);}}g.addInputElement(q);g.show(q);$$(".calheader").first().focus();$$("#searchCalendar").first().observe("keydown",i);}function j(){$$(".datePickerInput").each(function(n){return $(n).observe("keypress",function(p){if([8,9,27,13,110].indexOf(p.keyCode)>-1||(p.keyCode===65&&(p.ctrlKey===true||p.metaKey===true))||(p.keyCode===67&&(p.ctrlKey===true||p.metaKey===true))||(p.keyCode===88&&(p.ctrlKey===true||p.metaKey===true))||(p.keyCode>=35&&p.keyCode<=39)){return;}var o=/[\d\/]/.test(p.key);if(!o){Event.stop(p);}});});}function i(u){var s=$$("#searchCalendar .selected").first();var n=7;var p=$$("#searchCalendar .selectable");var r=p.size();var t=p.indexOf(s);var o;var q=window.getComputedStyle($$(".link-close").first())["display"];if(u.which===39&&s!==undefined){s.removeClassName("selected");t=t===r-1?t:t+1;o=p[t];o.addClassName("selected");o.down().focus();}else{if(u.which===37&&s!==undefined){s.removeClassName("selected");t=t===0?t:t-1;o=p[t];o.addClassName("selected");o.down().focus();}else{if(u.which===38&&s!==undefined){s.removeClassName("selected");t=(t-n)>=0?t-n:t;o=p[t];o.addClassName("selected");o.down().focus();}else{if(u.which===40){if(p.length>0){if(s===undefined){p[0].down().focus();p[0].addClassName("selected");}else{s.removeClassName("selected");t=(t+n<=r-1)?t+n:t;o=p[t];o.addClassName("selected");o.down().focus();}}}}}}if(u.which===9){if(u.target.hasClassName("calnavright")){$$(".calnavleft").first().focus();}else{if(u.target.up().hasClassName("selected")){$$(".calnavright").first().focus();}else{if(u.target.hasClassName("calnavleft")&&q==="block"){$$(".link-close").first().focus();}else{if(u.target.hasClassName("calnavleft")&&q==="none"){$$(".calnavright").first().focus();}else{if(u.target.hasClassName("link-close")&&s!==undefined){p[0].down().focus();}else{if(u.target.hasClassName("link-close")&&s===undefined){if(r===0){$$(".calnavright").first().focus();}else{p[0].down().focus();p[0].addClassName("selected");}}}}}}}}if(u.which!==13){Event.stop(u);}}this.setBlackoutDates=function(n){g.setBlackoutDates(n);};this.setDateFormat=function(n){g.setDateFormat(n);};this.applyListeners=function(){g.applyListeners();l.applyActions();};this.removeListeners=function(){g.removeListeners();l.removeActions();};this.addInput=function(n){g.addInput(n);};this.show=function(n){g.show(n);};this.setMinDate=function(n){g.setMinDate(n);};this.getMinDate=function(){return g.getMinDate();};this.setMaxDate=function(n){g.setMaxDate(n);};this.getMaxDate=function(){return g.getMaxDate();};this.setProperty=function(n,o){g.setProperty(n,o,false);};this.setPosition=function(n){g.setPosition(n);};this.clearInputs=g.clearInputs;m();j();};a.createUIComponent("searchCalendar",{initialize:function(c){return new b(c);},applyListeners:function(c){c.applyListeners();},removeListeners:function(c){c.removeListeners();},upload:function(c){c.removeListeners();}});})(EzRez.Application);(function(c,d){var a=function(h){var g=Object.extend({points:0,cash:0,index:-1,normalizedPoints:0,pointsDisplay:"",cashDisplay:"",cashWithPassThrough:0,cashWithPassThroughDisplay:""},h);this.points=g.points;this.cash=g.cash;this.pointsDisplay=g.pointsDisplay;this.cashDisplay=g.cashDisplay;this.normalizedPoints=g.normalizedPoints;this.index=g.index;this.cashWithPassThrough=g.cashWithPassThrough;this.cashWithPassThroughDisplay=g.cashWithPassThroughDisplay;};var e=function(h){var g=Object.extend({thousandsSeparator:",",decimalsSeparator:".",currencySymbol:"$",currencyCode:"USD",locale:"en_US"},h);this.thousandsSeparator=g.thousandsSeparator;this.decimalsSeparator=g.decimalsSeparator;this.currencySymbol=g.currencySymbol;this.currencyCode=g.currencyCode;this.locale=g.locale;};var f=function(h){var g=Object.extend({message:"",errorMessage:"",success:false,tick:{}},h);this.message=g.message;this.errorMessage=g.errorMessage;this.success=g.success;this.message=g.message;this.tickJson=g.tick;};var b=function(k){var V=Object.extend({initialCash:0,initialPoints:0,passThroughTotal:0,decimalPlaces:6,isCashAdjustmentSupported:false,isCollectCCWhenPointsOnly:false,isAlwaysAllowZeroPointsEnabled:false,rootElement:"sliderWrapper",ajaxUrl:"/authorize/points_slider/get_point_allocation_json.cfm",currencyFormat:{},ticks:{},areGeneralPaymentMethodsAllowed:false,translations:{PAYMENT_ERROR_POINTS_MIN:"",PAYMENT_ERROR_POINTS_MAX:"",PAYMENT_ERROR_POINTS_MUST_BE_INTEGER:"",PAYMENT_ERROR_MISSING_PROFILE:"",PAYMENT_ERROR_CASH_MUST_BE_NUMBER:"",PAYMENT_ERROR_CASH_MIN:"",PAYMENT_ERROR_CASH_MAX:"",PAYMENT_ERROR_ALLOCATION_ISSUE:""}},k);var p=0;var v=false;var A=false;var C=null;var w=new a();var n=new a();var M=new a();var W=null;var O=null;var J=false;var D=new e(V.currencyFormat);var h=false;var l=true;var m=new d.UI.DOMCache({rootNode:"#"+V.rootElement,nodes:{sliderWrapper:function(X){return X.down("div.sliderComponentWrapper");},slider:function(X){return X.down("div.slider");},sliderThumb:function(X){return X.down("div.slider div.sliderHandle");},sliderHighlight:function(X){return X.down("div.sliderComponentWrapper div.highlight");},cashInput:function(){return $("cc_amount");},cashInputDisplay:function(){return $("cc_amount_display");},cashText:function(X){return X.down(".cashText p");},errorMessage:function(X){return X.down("p.errorMessage");},pointsInput:function(){return $("redemption_points_total");},pointsInputDisplay:function(){return $("redemption_points_total_display");},pointsText:function(X){return X.down(".pointsText p");},payWithPointsOption:function(X){return $("pointsAllocationWrapper").down("input.payWithPoints");},payWithCashOption:function(X){return $("pointsAllocationWrapper").down("input.payWithCashOnly");},payWithPointsContent:function(X){return $("pointsAllocationWrapper").down(".pointsAllocationPayWithPointsOption .optionContent");},payWithCashContent:function(X){return $("pointsAllocationWrapper").down(".pointsAllocationPayWithCashOption .optionContent");}}});var z=function(X){var Y=V.translations[X];return Y?Y:X;};var B=function(X){return(X-n.points)/(M.points-n.points);};var i=function(){var X=parseFloat(m.cashInput.getValue());if(isNaN(X)||X<0){X=w.cash;}if(X>0||V.passThroughTotal>0||V.isCollectCCWhenPointsOnly){Element.fire(m.rootNode,"ezrez:pointsSlider:showCreditCard");return;}Element.fire(m.rootNode,"ezrez:pointsSlider:hideCreditCard");};var E=function(X){var Y=Object.extend({target:0,mode:""},X);N();new Ajax.Request(V.ajaxUrl,{method:"post",parameters:Y,onSuccess:function(ad){var aa=new f(ad.responseText.evalJSON());if(!aa.success){u(w);x(aa.errorMessage);return;}var ab=B(aa.tickJson.points);aa.tickJson.normalizedPoints=ab;var ac=R(ab);aa.tickJson.index=ac.normalizedPoints>ab?ac.index-1:ac.index+1;var Z=new a(aa.tickJson);u(Z);if(aa.errorMessage===null||aa.errorMessage.blank()){N();}else{x(aa.errorMessage);}l=true;},onException:function(aa,Z){u(w);x(z("PAYMENT_ERROR_ALLOCATION_ISSUE"));l=true;new d.Util.Exception({message:"Points Slider Ajax Exception",remoteLog:true},Z);},onFailure:function(){u(w);x(z("PAYMENT_ERROR_ALLOCATION_ISSUE"));l=true;new d.Util.Exception({message:"Points Slider HTTP Failure",remoteLog:true});}});};var x=function(X){m.errorMessage.update(X);if(J){return;}m.errorMessage.show();J=true;};var N=function(){if(!J){return;}m.errorMessage.hide();J=false;};var o=function(aa,X,Z,Y){if(Math.abs(Z-aa[Y])<Math.abs(X[Y]-Z)){return new a(aa);}return new a(X);};var y=function(ab,aa){if(!ab.length){return null;}var ad=ab.length-1;var X=0;var Y=0;var ac={};var Z={};while(X<=ad){Y=parseInt((X+ad)/2);ac=ab[Y];Z=ab[Y+1];if(Z&&ac.normalizedPoints<aa&&aa<=Z.normalizedPoints){return Z;}if(ac.normalizedPoints>aa){ad=Y-1;}else{if(ac.normalizedPoints<aa){X=Y+1;}else{return ac;}}}return null;};var R=function(Z){var Y=c.Profile.start("PointsSlider findNearestNormalizedTick "+new Date());var aa=W.get(Z.toFixed(V.decimalPlaces));if(aa){Y.stop();return new a(aa);}var X=y(O,Z);if(!X){Y.stop();return null;}var ab=O[X.index-1];if(!ab){Y.stop();return new a(X);}Y.stop();return o(ab,X,Z,"normalizedPoints");};var g=function(X){m.sliderHighlight.setStyle({width:(X+Math.floor(m.sliderThumb.getWidth()/2))+"px"});};var L=function(X){if(!X){return;}v=true;setTimeout(function(){var Y=X.normalizedPoints*p;C.setValue(Y);g(Y);},25);};var U=function(X){if(!X){return;}w=X;S(w);s(w);d.Util.Event.pubsub.publish("pointsSlider/updateTextControls",[m.cashInputDisplay.value,m.pointsInputDisplay.value]);d.Util.Event.pubsub.publish("pointsSlider/updateSelectOptionsForCashValue",[w.cash]);d.Util.Event.pubsub.publish("pointsPaymentOption/pointsAllocated");};var S=function(X){if(!X){return;}m.cashInput.value=w.cash;m.cashInputDisplay.value=w.cashWithPassThroughDisplay;m.cashText.update(w.cashWithPassThroughDisplay);if(!V.areGeneralPaymentMethodsAllowed){i();}};var s=function(X){if(!X){return;}m.pointsInput.value=w.points;m.pointsInputDisplay.value=w.pointsDisplay;m.pointsText.update(w.pointsDisplay);};var u=function(X){if(!X){return;}U(X);L(w);};var r=function(X){var Y=(1/2).toString().charAt(1);X=X.gsub(D.decimalsSeparator,Y);X=X.gsub(D.thousandsSeparator,"");X=X.gsub(D.currencyCode,"");X=X.gsub(D.currencySymbol,"");return X;};var F=function(){var Z=r(m.refresh("cashInputDisplay").getValue());var X=parseFloat(Z);if(isNaN(X)){S(w);x(z("PAYMENT_ERROR_CASH_MUST_BE_NUMBER"));l=true;return;}if(X>n.cash){S(w);x(z("PAYMENT_ERROR_CASH_MAX")+" "+n.cashDisplay);l=true;return;}if(X<M.cash){S(w);x(z("PAYMENT_ERROR_CASH_MIN")+" "+M.cashDisplay);l=true;return;}var Y=O.find(function(aa){return parseInt(aa.cash)===X;});if(Y){u(new a(Y));N();l=true;return;}E({target:X,mode:"cash"});};var Q=function(){var Z=r(m.refresh("pointsInputDisplay").getValue());var X=parseInt(Z);if(isNaN(X)){x(z("PAYMENT_ERROR_POINTS_MUST_BE_INTEGER"));l=true;return;}if(X<n.points){x(z("PAYMENT_ERROR_POINTS_MIN")+" "+n.pointsDisplay);l=true;return;}if(X>M.points){x(z("PAYMENT_ERROR_POINTS_MAX")+" "+M.pointsDisplay);l=true;m.pointsInputDisplay.value=M.points;return;}var Y=O.find(function(aa){return parseInt(aa.points)===X;});if(Y){u(new a(Y));N();l=true;return;}E({target:X,mode:"points"});};var K=function(Z){var Y;var X=-1;if(Z.keyCode===Event.KEY_UP){X=w.index+1;}if(Z.keyCode===Event.KEY_DOWN){X=w.index-1;}Y=O[X];if(Y){u(new a(Y));N();}};var t=function(X){l=false;if(X.keyCode===Event.KEY_RETURN){F();}K(X);};var T=function(X){l=false;if(X.keyCode===Event.KEY_RETURN){Q();return;}K(X);};var q=function(){if(v){v=false;return;}var Y=C.getValue();g(Y);var X=R(Y/p);if(!X){return;}N();w=X;U(w);};var I=function(){try{var ae=c.Profile.start("PointsSlider initialize");var Y=c.Profile.start("PointsSlider init elms.cache");m.cache();if(!m.isValidHtml()){throw new d.Util.Exception({message:"Invalid html for PointsSlider.",remoteLog:true});}O=[];W=$H();Y.stop();var ad=c.Profile.start("PointsSlider generate tick arrays & map");for(var af in V.ticks){var ab=V.ticks[af];O.push(ab);W.set(af,ab);}if(O.length===0){x(z("PAYMENT_ERROR_MISSING_PROFILE"));m.cashInput.readOnly=true;m.pointsInput.readOnly=true;A=true;h=true;return;}ad.stop();var Z=c.Profile.start("PointsSlider create yui slider");var ac=m.sliderThumb.getWidth();var aa=m.sliderWrapper.getDimensions();if(aa.width+aa.height+ac===0){h=false;return;}m.slider.setStyle({width:(aa.width-Math.floor(ac/2))+"px",height:aa.height+"px"});p=aa.width-ac;C=YAHOO.widget.Slider.getHorizSlider(m.slider,m.sliderThumb,0,p);n=new a(W.get("0.000000"));M=new a(O.last());Z.stop();if(!V.isCashAdjustmentSupported){m.cashInput.readOnly=true;}if(V.initialPoints>M.points){V.initialPoints=M.points;}w=R(B(V.initialPoints));if(w&&w.points===V.initialPoints){u(w);}else{E({target:V.initialPoints,mode:"points"});}h=true;ae.stop();}catch(X){new d.Util.Exception({message:"Points Slider Initialize exception",remoteLog:true},X);}};var H=function(){try{if(h){return;}G();I();j();}catch(X){new d.Util.Exception({message:"Points Slider Re-Initialize exception",remoteLog:true},X);}};var P=function(X){var Y=X.findElement("input.paymentOption");if(Y.getValue()==="points"){if(!m.payWithPointsContent.visible()){new Effect.Parallel([new Effect.BlindDown(m.payWithPointsContent,{sync:true}),new Effect.BlindUp(m.payWithCashContent,{sync:true})]);}m.pointsInput.value=w.points;if(!V.areGeneralPaymentMethodsAllowed){i();}if(!h){setTimeout(function(){H();},500);}else{d.Util.Event.pubsub.publish("pointsSlider/updateSelectOptionsForCashValue",[w.cash]);}}else{if(!m.payWithCashContent.visible()){new Effect.Parallel([new Effect.BlindUp(m.payWithPointsContent,{sync:true}),new Effect.BlindDown(m.payWithCashContent,{sync:true})]);}m.pointsInput.value=0;Element.fire(m.rootNode,"ezrez:pointsSlider:showCreditCard");d.Util.Event.pubsub.publish("pointsSlider/updateSelectOptionsForCashValue",[V.initialCash]);}d.Util.Event.pubsub.publish("pointsSlider/sliderPaymentClick",[Y.getValue()]);};var j=function(){if(A){return;}if(V.isCashAdjustmentSupported){m.cashInputDisplay.observe("blur",F);m.cashInputDisplay.observe("keypress",t);}m.pointsInputDisplay.observe("blur",Q);m.pointsInputDisplay.observe("keypress",T);m.payWithCashOption.observe("click",P);m.payWithPointsOption.observe("click",P);if(C){C.subscribe("change",q,this,true);}};var G=function(){if(V.isCashAdjustmentSupported){m.cashInputDisplay.stopObserving("blur",F);m.cashInputDisplay.stopObserving("keypress",t);}m.pointsInputDisplay.stopObserving("blur",Q);m.pointsInputDisplay.stopObserving("keypress",T);m.payWithCashOption.stopObserving("click",P);m.payWithPointsOption.stopObserving("click",P);if(C){C.unsubscribe("change",q);}};this.isErrorVisible=function(){return J;};this.areKeystrokesValidated=function(){return l;};this.reinitialize=function(){H();};this.applyListeners=function(){j();};this.removeListeners=function(){G();};I();};c.createUIComponent("pointsSlider",{initialize:function(g){return new b(g);},applyListeners:function(g){g.applyListeners();},removeListeners:function(g){g.removeListeners();},isErrorVisible:function(g){return g.isErrorVisible();},areKeystrokesValidated:function(g){return g.areKeystrokesValidated();}});}(EzRez.Application,EzRez));(function(a){var b=function(c){var h=Object.extend({parcelPaymentSelectOptions:{},parcelPaymentSelectionRequired:false,initialCashAmount:0,radioDisplay:false},c);var d=$$(".creditCardPaymentOption").first();var g=h.parcelPaymentSelectOptions;function e(r){var k=d.down(".parcelPaymentConditionsLabeledInput");if(h.radioDisplay){var o=k.down(".checkboxOptionsContainer");if(o){var l=o.down("input:checked").value;var p=o.firstDescendant().clone(true);var n=[];g.each(function(s){if(r>=s.minimumAmount){n.push(s);}});if(n.length>0){o.update();n.each(function(t){var s=p.clone(true);s.down("input").setAttribute("value",t.value);s.down("label .labelText").update(t.displayString);s.down("input").checked=l===t.value;o.insert(s);});}if(!h.parcelPaymentSelectionRequired&&n.length<=1){k.addClassName("hidden");}else{k.removeClassName("hidden");}}}else{var j=k.down('select[name="parcel_payment_conditions"]');if(j){var l=j.options[j.selectedIndex].value,q=0,m=0;j.options.length=0;g.each(function(s){if(r>=s.minimumAmount){j.options[j.options.length]=new Option(s.displayString,s.value);if(l==s.value){q=m;}m++;}});j.selectedIndex=q;}if(!h.parcelPaymentSelectionRequired&&j.options.length<=1){k.addClassName("hidden");}else{k.removeClassName("hidden");}}}function f(j,k){g=j;e(k);}function i(){EzRez.Util.Event.pubsub.subscribe("creditCardPaymentOptionComponent/cashChanged",e);EzRez.Util.Event.pubsub.subscribe("pointsSlider/updateSelectOptionsForCashValue",e);EzRez.Util.Event.pubsub.subscribe("pointsSlider/newParcelPaymentSelectOptions",f);e(h.initialCashAmount);}i();};a.createUIComponent("parcelPaymentConditionsInputComponent",{initialize:function(c){return new b(c);}});})(EzRez.Application);(function(b){var a=function(c){var d=$H();var f=false;var e=function(){d.each(function(h){h.value.applyListeners();});f=true;};var g=function(){d.each(function(h){h.value.removeListeners();});f=false;};this.add=function(h){if(d.get(h.id)&&!h.reload){return;}var i=new EzRez.UI.DualSliderFilter(h);d.set(h.id,i);if(f){i.applyListeners();}};this.get=function(h){return d.get(h);};this.applyListeners=e;this.removeListeners=g;this.unload=function(){g();d=null;};};b.createUIComponent("dualSliderFactory",{initialize:function(c){return new a(c);},applyListeners:function(c){c.applyListeners();},removeListeners:function(c){c.removeListeners();},unload:function(c){c.unload();}});})(EzRez.Application);(function(a){var b=function(i){var l=Object.extend({helpLinkClassname:"helpLink",helpLinkPopupClassname:"helpLinkPopup",helpPopupTextClassname:"helpPopupText",toolTipPanelId:"toolTipPanel",toolTipId:"toolTip"},i);var n=null;var e=null;var f=false;var d=function(){e.hide();f=false;};var k=function(r){var t=r.cumulativeOffset(),s=r.getDimensions(),q=r.next("."+l.helpPopupTextClassname),p=$$(".yui-panel-container")[0];if(q==undefined){q=r.up("div").next("."+l.helpPopupTextClassname);}e.setBody(q.innerHTML);e.cfg.setProperty("x",t.left+s.width);e.cfg.setProperty("y",t.top+s.height);e.render(document.body);p.show();e.show();f=true;};var m=function(p){var r=$(p.target);var q=null;if(r.nodeName.strip().toLowerCase()!=="a"){q=r.up("a");}if(Object.isElement(q)&&q.href.endsWith("#")){Event.stop(p);}if(n!==null){n.doShow(p);}};var o=function(p){Event.stop(p);if(e.cfg.getProperty("visible")){d();return;}var q=p.findElement("."+l.helpLinkPopupClassname);k(q);};var h=function(p){var q=$(p.target);if(Event.findElement(p,"a."+l.helpLinkPopupClassname)){o(p);}else{if(Event.findElement(p,"a."+l.helpLinkClassname)){m(p);}else{if(f&&!Event.findElement(p,"#"+l.toolTipPanelId)){d();}}}};var j=function(p){Event.stop(p);d();};var c=function(){if(!location.hash||!location.hash.startsWith("#policies_")){return;}var p=$$("."+location.hash.split("#")[1]+" a."+l.helpLinkPopupClassname).first();if(p){k(p);}};var g=function(){e=new YAHOO.widget.Panel(l.toolTipPanelId,{constraintoviewport:true,underlay:"shadow",visible:false,draggable:false,monitorresize:false,iframe:true,close:false,modal:true,fixedcenter:true});e.setHeader("<a class='container-close' href='#' alt='close' title='close'>X</a>");e.render(document.body);c();};this.applyListeners=function(){if(n){n.destroy();}document.observe("click",h);n=new YAHOO.widget.Tooltip(l.toolTipId,{context:$$("."+l.helpLinkClassname),zIndex:1000});$(l.toolTipPanelId).down("a.container-close").observe("click",j);};this.removeListeners=function(){document.stopObserving("click",h);$(l.toolTipPanelId).down("a.container-close").stopObserving("click",j);};g();};a.createUIComponent("helpToolTip",{initialize:function(c){return new b(c);},applyListeners:function(c){c.applyListeners();},removeListeners:function(c){c.removeListeners();},unload:function(c){c.removeListeners();}});})(EzRez.Application);(function(c){var a=function(){var d=$H();this.create=function(f,e){var g=new b(e);d.set(f,g);return g;};this.get=function(e){return d.get(e);};};var b=function(g){var j=Object.extend({textFieldId:"",resultsContainerId:g.textFieldId+"_results",hiddenFieldId:"",maxResults:15,minQueryLength:3,searchURL:"",additionalParams:{},selectHandler:null,blurHandler:null,errorHandler:function(o,n){}},g);var l=false;var e=new YAHOO.util.XHRDataSource(j.searchURL);e.responseType=YAHOO.util.XHRDataSource.TYPE_JSARRAY;e.responseSchema={fields:["displayValue","searchValue","locationToken","prefix"]};e.maxCacheEntries=50;var m=new YAHOO.widget.AutoComplete(j.textFieldId,j.resultsContainerId,e);m.animHoriz=true;m.animSpeed=0.15;m.queryDelay=0.2;m.maxResultsDisplayed=j.maxResults;m.minQueryLength=j.minQueryLength;m.useIFrame=true;m.useShadow=true;m.queryMatchContains=true;m.generateRequest=function(n){return"?query="+n+"&"+Object.toQueryString(j.additionalParams)+"&isRoom="+f()+"&searchTab="+d();};m.resultTypeList=false;m.formatResult=function(r,s,q){var o=r.searchValue.toUpperCase().search("AIRPORT")>0;var p=o?'<img src="/images/icons/air_sm.gif" width="15px" height="12px">':"";if(q.toUpperCase().startsWith(s.toUpperCase())){return p+"<span class='autoCompleteHighlight'>#{partToBold}</span><span class='autoCompleteRemainder'>#{remainder}</span>".interpolate({partToBold:q.substr(0,s.length),remainder:q.substr(s.length)});}var n=q.toUpperCase().search(s.toUpperCase());if(n>0){return p+"<span class='autoCompleteRemainder'>#{firstPart}</span><span class='autoCompleteHighlight'>#{partToBold}</span><span class='autoCompleteRemainder'>#{remainder}</span>".interpolate({firstPart:q.substr(0,n),partToBold:q.substr(n,s.length),remainder:q.substr(n+s.length)});}return p+q;};var f=function(){var o=$("room1");if(!o){return false;}var p=$("air1");var n=$("car1");return(o.checked&&(!p||!p.checked)&&(!n||!n.checked));};var d=function(){var n=$("searchTab");if(!n){return"";}else{return n.value;}};var h=function(s,r,p){l=true;if(p.selectHandler){p.selectHandler(s,r,p);return;}var n=r[2];var o=n.searchValue;var q="/travel/plugins/ajax_locations/record_location_prefix.cfm";new Ajax.Request(q,{parameters:{location:o,prefix:n.prefix}});$(g.hiddenFieldId).value=o;p.errorHandler(false,p.textFieldId);};var k=function(p,o,n){$(n.textFieldId).value="";$(n.hiddenFieldId).value="";};var i=function(r,q,p){if(l){var n=$(p.textFieldId);if(n.value===""){p.errorHandler(true,p.textFieldId);}l=false;return;}if(p.blurHandler){p.blurHandler(r,q,p);return;}var o="/travel/plugins/ajax_locations/get_valid_location.cfm";new Ajax.Request(o,{parameters:{query:$(p.textFieldId).getValue(),cobrand_name:c.WebContext.cobrandName},onComplete:function(u){var s=u.responseText.evalJSON();var t=Object.isArray(s)&&s.length>0;if(t){$(p.hiddenFieldId).value=s.first()["searchValue"];$(p.textFieldId).value=s.first()["displayValue"];}p.errorHandler(!t,p.textFieldId);},onException:function(t,s){throw s;}});};this.setAdditionalParams=function(n){j.additionalParams=Object.extend(j.additionalParams,n);};m.textboxFocusEvent.subscribe(k,j);m.itemSelectEvent.subscribe(h,j);m.textboxBlurEvent.subscribe(i,j);};c.createUIComponent("locationAutoCompleteFactory",{initialize:function(){return new a();}});})(EzRez.Application);(function(b){var c=function(){var d=$H();this.create=function(f,e){d.set(f,new a(e));};this.get=function(e){return d.get(e);};};var a=function(d){var f=Object.extend({errorElementId:d.textFieldId+"_error",errorMessage:""},d);var e=function(h,g){if(h){b.FormErrors.addError(g,"LocationAutoCompleteError");$(f.errorElementId).show();$(f.errorElementId).innerHTML=f.errorMessage;}else{b.FormErrors.removeError(g);$(f.errorElementId).hide();}};b.use("locationAutoCompleteFactory").create(f.textFieldId,Object.extend({errorHandler:e},f));};b.createUIComponent("searchFormAutoCompleteFactory",{initialize:function(){return new c();}});})(EzRez.Application);(function(a){var b=function(){function c(e){Event.stop(e);var d=new EzRez.UI.Toggle($(e.target));d.flip();}this.applyListeners=function(){document.on("click","a.toggle",c);};this.initialize=function(){$$("a.toggle").forEach(function(e){if(e.up(".toggleContainer")){var d=new EzRez.UI.Toggle(e);d.restoreStatusFromCookie();}});$$("tr.commissionToggle").forEach(function(e){var d=e.up(".toggleContainer").select(".toggleContent").last();d.insert({after:e});});};};a.createUIComponent("toggle",{initialize:function(){var c=new b();c.initialize();return c;},applyListeners:function(c){c.applyListeners();}});a.load("toggle");})(EzRez.Application);(function(b,e,d){var a;if(b.WebContext.fileName==="arc.cfm"){d.widget.AutoComplete.prototype.typeAhead=true;}function c(){a=d.widget.AutoComplete.prototype._isIgnoreKey;d.widget.AutoComplete.prototype._isIgnoreKey=function(f){return f===229?false:a(f);};}e.UI.SearchForm=function(aV){if(!aV.form){aV.form=$$(".search-form").first();}if(!aV.form){return;}var a1=this;this.$form=$(aV.form);this.$searchFormContainer=$$(".search-form-container").first();this.$title=a1.$form.down(".title");this.$nav=a1.$form.down("[name='nav']");this.$recentSearches=$$(".recentSearchesSelector").first();this.$autoCompleteSearchContextFields=$$(".labeledInput .autoCompleteSearchContext");this.$originUrl=a1.$form.down("[name='origin']");this.$roomInfo=a1.$form.down("[name='room_info']");this.$advancedAirSearch=a1.$form.down("[name='advanced_air_search']");this.$fieldsetContainer=a1.$form.down("fieldset.fields");this.$defaultSearchContextSelectionUI=a1.$form.down(".options");this.$airSearchContextOption=a1.$defaultSearchContextSelectionUI.down("[value='air']");this.$roomSearchContextOption=a1.$defaultSearchContextSelectionUI.down("[value='room']");this.$carSearchContextOption=a1.$defaultSearchContextSelectionUI.down("[value='car']");this.$roomCarSearchContextOption=a1.$defaultSearchContextSelectionUI.down("[value='room_car']");this.$airCarSearchContextOption=a1.$defaultSearchContextSelectionUI.down("[value='air_car']");this.$airRoomSearchContextOption=a1.$defaultSearchContextSelectionUI.down("[value='air_room']");this.$airRoomCarSearchContextOption=a1.$defaultSearchContextSelectionUI.down("[value='air_room_car']");this.$advancedAirSearchContextOption=a1.$defaultSearchContextSelectionUI.down("[value='advanced_air']");this.$activitySearchContextOption=a1.$defaultSearchContextSelectionUI.down("[name='activity1']");this.$displayArea1=a1.$form.down(".area1LabeledInput .autoCompleteDisplayInput");this.$displayArea2=a1.$form.down(".area2LabeledInput .autoCompleteDisplayInput");this.$displayArea3=a1.$form.down(".area3LabeledInput .autoCompleteDisplayInput");this.$displayArea4=a1.$form.down(".area4LabeledInput .autoCompleteDisplayInput");this.$displayArea5=a1.$form.down(".area5LabeledInput .autoCompleteDisplayInput");this.$displayArea6=a1.$form.down(".area6LabeledInput .autoCompleteDisplayInput");this.$displayArea7=a1.$form.down(".area7LabeledInput .autoCompleteDisplayInput");this.$displayArea8=a1.$form.down(".area8LabeledInput .autoCompleteDisplayInput");this.$displayArea9=a1.$form.down(".area9LabeledInput .autoCompleteDisplayInput");this.$displayArea10=a1.$form.down(".area10LabeledInput .autoCompleteDisplayInput");this.$allDisplayAreas=[a1.$displayArea1,a1.$displayArea2,a1.$displayArea3,a1.$displayArea4,a1.$displayArea5,a1.$displayArea6,a1.$displayArea7,a1.$displayArea8,a1.$displayArea9,a1.$displayArea10];this.$area1=a1.$form.down("[name='area1']");this.$area1Container=a1.$form.down(".area1LabeledInput");this.$area2=a1.$form.down("[name='area2']");this.$area2Container=a1.$form.down(".area2LabeledInput");this.$roundtripOptionsContainer=a1.$form.down(".roundtrip-options");this.$roundtrip=a1.$roundtripOptionsContainer?a1.$roundtripOptionsContainer.down("[name='roundtrip']"):null;this.$oneway=a1.$roundtripOptionsContainer?a1.$roundtripOptionsContainer.down("[name='roundtrip'][value='false']"):null;this.$date1=a1.$form.down("[name='date1']");this.$date2=a1.$form.down("[name='date2']");this.$date3=a1.$form.down("[name='date3']");this.$date4=a1.$form.down("[name='date4']");this.$date5=a1.$form.down("[name='date5']");this.$date1LabeledInput=a1.$form.down(".date1LabeledInput");this.$date2LabeledInput=a1.$form.down(".date2LabeledInput");this.$displayDate3=a1.$form.down(".partial-room-stay-range-container .date3LabeledInput");this.$displayDate4=a1.$form.down(".partial-room-stay-range-container .date4LabeledInput");this.$displayDate5=a1.$form.down(".date5LabeledInput");this.$date3LabeledInput=a1.$form.down(".partial-room-stay-range-container .date3LabeledInput .date3");this.$date4LabeledInput=a1.$form.down(".partial-room-stay-range-container .date4LabeledInput .date4");this.$date5LabeledInput=a1.$form.down(".date5LabeledInput .date5");this.$time1=a1.$form.down("[name='time1']");this.$time2=a1.$form.down("[name='time2']");this.$time3=a1.$form.down("[name='time3']");this.$time4=a1.$form.down("[name='time4']");this.$time5=a1.$form.down("[name='time5']");this.$time2LabeledInput=a1.$form.down(".time2LabeledInput");this.$adults=a1.$form.down("[name='adults']");this.$children=a1.$form.down("[name='children']");this.$dynamicChildrenLabeledInput=a1.$form.down(".dynamicChildrenLabeledInput");this.$dynamicChildren=a1.$form.down("[name='dynamic_children']");this.$childAges=$$(".child-age-container select");this.$seniors=a1.$form.down("[name='seniors']");this.$rooms=a1.$form.down("[name='num_rooms']");this.$partialRoomStay=a1.$form.down("[name='partial_room_stay']");this.$partialRoomStayLabeledInput=a1.$form.down(".partialRoomStayLabeledInput");this.$partialRoomStayRangeContainer=a1.$form.down(".partial-room-stay-range-container");this.$flexibleDates=a1.$form.down("[name='flexible_dates']");this.$carType=a1.$form.down("[name='car_type']");this.$oneWayCar=a1.$form.down(".car_return_different_location");this.$maxStops=a1.$form.down("[name='max_stops']");this.$flexibleDatesV2=a1.$form.down("[name='flexible_dates_v2']");this.$occupanciesContainer=a1.$form.down(".occupancies-container");this.$multiRoomContainer=a1.$form.down(".multiroom-container");this.DEFAULT_CHILD_AGE=5;this.$hotelInfo=$$("#show_hotel_details").first()?$$(".search-form-component-hotel-info").first():null;this.$area1AutoCompleteFilter=a1.$form.down(".area1LabeledInput .autoCompleteFilter");this.$area2AutoCompleteFilter=a1.$form.down(".area2LabeledInput .autoCompleteFilter");this.$area3AutoCompleteFilter=a1.$form.down(".area3LabeledInput .autoCompleteFilter");this.$area4AutoCompleteFilter=a1.$form.down(".area4LabeledInput .autoCompleteFilter");this.$area5AutoCompleteFilter=a1.$form.down(".area5LabeledInput .autoCompleteFilter");this.$area6AutoCompleteFilter=a1.$form.down(".area6LabeledInput .autoCompleteFilter");this.$area7AutoCompleteFilter=a1.$form.down(".area7LabeledInput .autoCompleteFilter");this.$area8AutoCompleteFilter=a1.$form.down(".area8LabeledInput .autoCompleteFilter");this.$area9AutoCompleteFilter=a1.$form.down(".area9LabeledInput .autoCompleteFilter");this.$area10AutoCompleteFilter=a1.$form.down(".area10LabeledInput .autoCompleteFilter");this.$allOriginAutoCompleteFilters=[a1.$area1AutoCompleteFilter,a1.$area3AutoCompleteFilter,a1.$area5AutoCompleteFilter,a1.$area7AutoCompleteFilter,a1.$area9AutoCompleteFilter];this.$allDestinationAutoCompleteFilters=[a1.$area2AutoCompleteFilter,a1.$area4AutoCompleteFilter,a1.$area6AutoCompleteFilter,a1.$area8AutoCompleteFilter,a1.$area10AutoCompleteFilter];this.$fastAdvancedAirInput=a1.$form.down(".multilegLabeledInput");var aI=Object.extend({submit:null,include:[],exclude:[],ranges:{maxAdults:8,maxChildren:8,minChildAge:0,maxChildAge:18,maxSeniors:4,maxRooms:4,maxStops:4},calendarOffsets:{startDateOffset:0,endDateOffset:3,format:b.SysConf.dateFormat.toLowerCase()},alternativeSearchContextSelectionUI:null,alternativeSearchContextUIType:null,defaultSearchContext:"air_room_car",alternativeSearchFormActionUrl:null,enableFastAdvancedAir:false,isOneCarBookingEnabled:true,inputsAcceptNumbersOnly:false,searchContextFields:{air:["roundtripLabeledInput","onewayLabeledInput","multilegLabeledInput","area1LabeledInput","area2LabeledInput","date1LabeledInput","date2LabeledInput","timeWindowLabeledInput","time1LabeledInput","time2LabeledInput","serviceclassLabeledInput","maxStopsLabeledInput","airMaxOptionsLabeledInput","adultsLabeledInput","seniorsLabeledInput","dynamicChildrenLabeledInput","dynamicInfantsLabeledInput","flexibleDatesLabeledInput"],room:["area2LabeledInput","date1LabeledInput","date2LabeledInput","numRoomsLabeledInput","adultsLabeledInput","dynamicChildrenLabeledInput"],car:["area2LabeledInput","countryOfResidencyLabeledInput","date1LabeledInput","date2LabeledInput","time1LabeledInput","time2LabeledInput","carTypeLabeledInput","carReturnDifferentLocationLabeledInput"],room_car:["area2LabeledInput","countryOfResidencyLabeledInput","date1LabeledInput","date2LabeledInput","time1LabeledInput","time2LabeledInput","partialRoomStayLabeledInput","date3LabeledInput","date4LabeledInput","time3LabeledInput","time4LabeledInput","numRoomsLabeledInput","carTypeLabeledInput","adultsLabeledInput","dynamicChildrenLabeledInput"],air_car:["area1LabeledInput","area2LabeledInput","countryOfResidencyLabeledInput","date1LabeledInput","date2LabeledInput","time1LabeledInput","time2LabeledInput","flexibleDatesLabeledInput","carTypeLabeledInput","adultsLabeledInput","dynamicChildrenLabeledInput"],air_room:["area1LabeledInput","area2LabeledInput","date1LabeledInput","date2LabeledInput","partialRoomStayLabeledInput","date3LabeledInput","date4LabeledInput","time3LabeledInput","time4LabeledInput","flexibleDatesLabeledInput","numRoomsLabeledInput","adultsLabeledInput","dynamicChildrenLabeledInput","serviceclassLabeledInput"],air_room_car:["area1LabeledInput","area2LabeledInput","countryOfResidencyLabeledInput","date1LabeledInput","date2LabeledInput","time1LabeledInput","time2LabeledInput","partialRoomStayLabeledInput","date3LabeledInput","date4LabeledInput","time3LabeledInput","time4LabeledInput","flexibleDatesLabeledInput","carTypeLabeledInput","numRoomsLabeledInput","adultsLabeledInput","dynamicChildrenLabeledInput"],advanced_air:["area1LabeledInput","area2LabeledInput","area3LabeledInput","area4LabeledInput","area5LabeledInput","area6LabeledInput","area7LabeledInput","area8LabeledInput","area9LabeledInput","area10LabeledInput","date1LabeledInput","date2LabeledInput","date3LabeledInput","date4LabeledInput","date5LabeledInput","date6LabeledInput","date7LabeledInput","date8LabeledInput","date9LabeledInput","date10LabeledInput","time1LabeledInput","time2LabeledInput","time3LabeledInput","time4LabeledInput","time5LabeledInput","time6LabeledInput","time7LabeledInput","time8LabeledInput","time9LabeledInput","time10LabeledInput","serviceclassLabeledInput","adultsLabeledInput","dynamicChildrenLabeledInput","dynamicInfantsLabeledInput","airlinesLabeledInput","maxStopsLabeledInput","maxStopsLabeledInput","timeWindowLabeledInput"],activity:["area2LabeledInput","date1LabeledInput","date2LabeledInput"]},defaultStartHour:null,defaultEndHour:null,isMultiRoomEnabled:true,isAllHotelsEnabled:true,isInfantsEnabled:true,shouldRenderSearchFormOnInitialLoad:true,shouldPopulateWithLastSearch:true,shouldShowLocationAutoCompleteHint:false,shouldValidateSearchForm:false,validationOptions:{fieldsToValidate:[a1.$area1,a1.$area2,a1.$date1,a1.$date2,a1.$date3,a1.$date4],nodesToValidate:"input",rules:Object.extend(e.Validator.Rules,{notSameValueAsOrigin:function(bm){if(a1.$area1&&a1.$area1.visible()){return a1.$area1.getValue()!==bm.getValue();}return true;}}),errorMessages:Object.extend(e.Validator.ErrorMessages,{notSameValueAsOrigin:"Please select a destination that differs from your originating airport"})},lastSearch:{},translations:{},filters:{air:{origin:"AirportsAndCitiesAutoCompleteWithExclusionsFilter",destination:"AirportsAndCitiesAutoCompleteWithExclusionsFilter"},room:{destination:"AirportsAndCitiesAutoCompleteWithExclusionsFilter"},car:{destination:"AirportsAndCitiesAutoCompleteWithExclusionsFilter"},activity:{destination:"AirportsAndCitiesAutoCompleteWithExclusionsFilter"},room_car:{destination:"AirportsAndCitiesAutoCompleteWithExclusionsFilter"},air_car:{origin:"AirportsAndCitiesAutoCompleteWithExclusionsFilter",destination:"AirportsAndCitiesAutoCompleteWithExclusionsFilter"},air_room:{origin:"AirportsAndCitiesAutoCompleteWithExclusionsFilter",destination:"AirportsAndCitiesAutoCompleteWithExclusionsFilter"},air_room_car:{origin:"AirportsAndCitiesAutoCompleteWithExclusionsFilter",destination:"AirportsAndCitiesAutoCompleteWithExclusionsFilter"},advanced_air:{origin:"AirportsAndCitiesAutoCompleteWithExclusionsFilter",destination:"AirportsAndCitiesAutoCompleteWithExclusionsFilter"}},minDaysInAdvance:{air:0,advanced_air:0,room:0,car:0,room_car:0,air_car:0,air_room:0,air_room_car:0,activity:0},maxDaysInAdvance:{air:0,advanced_air:0,room:0,car:0,room_car:0,air_car:0,air_room:0,air_room_car:0,activity:0},advancedAirUserTypes:[],agentType:"",isTrueFit:false,shouldShowPartialRoomStayLabeledInputForMultiRoomSelection:false,swapCarLocations:false},aV);var J=[];var aY=[];var aw=e.Util.Event;var a2=aw.pubsub;var I=aw.simulate;var z=window.location.href;var q=location.href.toQueryParams().tab;var K=location.href.toQueryParams().air_room_car_radio;var az={act:"activity",a:"air",c:"car",r:"room",p:"package",aa:"advanced_air",rc:"room_car"};var Q=["air","room","car","act"];this.$alternativeSearchContextSelectionUIOptions=null;this.validator=null;function E(){var bm=a1.$form.select(".labeledInput");J=[];for(var bn=0,bo=bm.length;bn<bo;bn++){if(!$(bm[bn]).hasClassName("option")){J.push($(bm[bn]));}}}function aX(){var bn=$$(".search-context-tabs > li a");for(var bm=0,bo=bn.length;bm<bo;bm++){aY.push($(bn[bm]));}}function ad(bm){if(!bm){return;}bm.show();var bo=bm.select("input"),bn=bm.select("select");if(bo){bo.invoke("enable");}if(bn){bn.invoke("enable");}}function G(bm){if(!bm){return;}bm.hide();var bo=bm.select("input"),bn=bm.select("select");if(bo){bo.invoke("disable");}if(bn){bn.invoke("disable");}}function aB(){var bm=a1.$area1Container;var bn=a1.$oneWayCar;bn.observe("click",function(bo){bo.target.checked?ad(bm):G(bm);});if(b.WebContext.referrer.search("car_return_different_location=true")!==-1){ad(bm);bn.checked=true;}else{if(bn.checked===true){ad(bm);}}}function V(bm){var bn=$(bm.target);if(bn&&e.StringUtil.isEmpty(bn.value)){bn.value=aI.translations.autoCompleteHint;bn.addClassName("autoCompleteHint");}else{if(bn.hasClassName("autoCompleteHint")){bn.removeClassName("autoCompleteHint");}}}function am(bm){var bn=$(bm.target);if(bn.hasClassName("autoCompleteHint")){bn.value="";bn.removeClassName("autoCompleteHint");bn.select();}}function F(){a1.$allDisplayAreas.each(function(bm){if(bm){bm.value=aI.translations.autoCompleteHint;bm.addClassName("autoCompleteHint");bm.observe("blur",V);bm.observe("focus",am);}});}function R(){var bn=$("static-page-search-form-container");if(bn){var bm=bn.select(".searchFormDefaultValue");bm.forEach(function(bq){var bp=bq.value;var br=bq.readAttribute("name");var bo=$("static-page-search-form").select('[name="'+br+'"]').first();if(bo){if(bo.tagName==="INPUT"&&(bo.type==="checkbox"||bo.type==="radio")){bo.checked=true;}else{bo.value=bp;}}});}}function aN(){if(a1.$multiRoomContainer){a1.$multiRoomContainer.select(".labeledInput").each(function(bm){ad(bm);});}}function i(){var bm=0,bn=J.length;for(bm;bm<bn;bm++){ad(J[bm]);}aN();}function ao(){E();var bm=0,bn=J.length;for(bm;bm<bn;bm++){G(J[bm]);}}function w(){ao();var bp=$$(".multiroom-container .occupancies-container")[0];var bo=0,br=aI.include.length;for(bo;bo<br;bo++){var bn=$$("."+aI.include[bo]);if(bp){for(var bm=0;bm<bn.length;bm++){var bq=bn[bm].hasClassName("numRoomsLabeledInput")||bn[bm].hasClassName("adultsLabeledInput")||bn[bm].hasClassName("dynamicChildrenLabeledInput");if(bq){ad(bn[bm]);}else{ad(bn[0]);}}}else{ad(bn[0]);}}if(a1.$oneWayCar&&!a1.$oneWayCar.disabled&&a1.$oneWayCar.checked){aB();}}function a7(){i();var bm=0;var bn=aI.exclude.length;for(bm;bm<bn;bm++){$$("."+aI.exclude[bm]).each(G);}}function bb(){if(aI.include.length>0){w();}else{if(aI.exclude.length>0){a7();}}}function aK(bm){if(!bm){return null;}return a1.$defaultSearchContextSelectionUI.down("[value='"+bm+"']");}function u(){return aK("air");}function ax(){return aK("room");}function at(){return aK("car");}function k(){return aK("room_car");}function g(){return aK("air_car");}function aU(){return aK("air_room");}function aQ(){return aK("air_room_car");}function au(){return aK("advanced_air");}function aq(bm){if(!bm){return null;}return a1.$defaultSearchContextSelectionUI.down("[name='"+bm+"']");}function aE(){return aq("activity1");}function bj(){return a1.$alternativeSearchContextSelectionUIOptions?a1.$alternativeSearchContextSelectionUIOptions.act:null;}function aP(){var bp=aQ(),bm=k(),bn=aU(),bq=ax(),bo;bo=bp&&bp.checked;bo=bo||bm&&bm.checked;bo=bo||bn&&bn.checked;bo=bo||bq&&bq.checked;bo=bo||b.Search.products.hasRoom;return bo;}function m(){if(aP()&&aI.isMultiRoomEnabled){var bn=$$(".child-infant-container").findAll(function(bp){return bp.down(".childAgeLabeledInput").visible();});var bo=1,bm;bn.each(function(bp){bm="infant"+bo;bp.select("input[type='radio']").each(function(bq){bq.removeClassName(bq.name);bq.addClassName(bm);bq.name=bm;bq.checked=bq.hasAttribute("checked");});bo++;});}}function ap(bn){var bm=$(bn.target);if(bm.name!==a1.$dynamicChildren.name){return;}a2.publish("searchFormComponent/dynamicChildren/change",[bm]);}function ai(){var br=aQ(),bp=g(),bm=aU(),bn=u(),bq=au(),bo;bo=br&&br.checked;bo=bo||bp&&bp.checked;bo=bo||bm&&bm.checked;bo=bo||bn&&bn.checked;bo=bo||bq&&bq.checked;bo=bo||b.Search.products.hasAir;return bo;}function bh(){return $$(".search-form .options input:checked").first();}function bi(bp){var bo=bp.value;var bn=bp.up(".child-infant-container");var bm=bn.down("[value='in_lap']").up(".radioLabeledInput");var br=bn.down("[value='in_seat']").up(".radioLabeledInput");var bs=bh();var bq=a1.getSearchContextValue(bs);if(bo==="1"&&ai()&&bq!=="room"){ad(bm);ad(br);}else{if(bo==="1"){bm.down("input").enable();br.down("input").enable();}else{G(bm);G(br);}}}function aS(bm){return bm.up(".labeledInput").next(".child-age-container").childElements();}function j(bo){var bp=0,bq=bo.value,bm=aS(bo);if(bq===0){bm=bo.up(".dynamic-children-container");bm.down("[value='in_lap']").disable();bm.down("[value='in_seat']").disable();}for(bp;bp<bq;bp++){var bn=bm[bp].down(".selectLabeledInput");ad(bm[bp]);ad(bn);if(aI.isInfantsEnabled){bi(bn.down("select"));}}}function aa(){if(!aI.isInfantsEnabled){$$(".child-age-container input[type='radio']").each(function(bm){bm.disabled=true;});}}function h(){var bn=$$(".child-infant-container .radioLabeledInput");var bo=bn.length;if(bo>0){for(var bm=0;bm<bo;bm++){if(!bn[bm].visible()){G(bn[bm]);}}}}function al(bm){a1.hideChildAges(bm);j(bm);if(aI.isMultiRoomEnabled&&aI.isInfantsEnabled){h(bm);}else{if(!aI.isInfantsEnabled){aa();}}}function N(){if(a1.$multiRoomContainer===undefined||a1.$dynamicChildren===undefined){return;}var bm=$$("."+a1.$multiRoomContainer.className+" ."+a1.$dynamicChildren.name);var bn=0;var bo=bm.length;for(bn;bn<bo;bn++){bm[bn].observe("change",ap);al(bm[bn]);}}function ar(bn){var bm=$(bn.target);if(bm.name.indexOf("child_age")===-1){return;}a2.publish("searchFormComponent/dynamicChildren/infantOption",[bm]);}function bc(){a1.$childAges=$$(".child-age-container select");if(a1.$childAges&&aI.isInfantsEnabled){var bm=0,bn=a1.$childAges.length;for(bm;bm<bn;bm++){a1.$childAges[bm].observe("change",ar);}}aa();}function a3(){m();N();bc();}function a5(bo,bn){var bq=bo.down("[value=in_lap]");var bp=bo.down("[value=in_seat]");var bm=bo.down("option");if(bn){bp.checked=false;bp.removeAttribute("checked");bq.checked=true;bq.writeAttribute("checked","");bm.selected=true;}else{bq.checked=false;bq.removeAttribute("checked");bp.checked=true;bp.writeAttribute("checked","");}}function an(){var bm=$$(".room-count-label").first();if(bm){bm.hide();}}function y(){an();[a1.$multiRoomContainer].invoke("hide");$$("."+a1.$multiRoomContainer.className+" select").invoke("disable");}function aj(){an();a1.$multiRoomContainer.innerHTML="";}function aR(){var bn=$$(".room-count-label"),bm=0,bo=bn.length;for(bm;bm<bo;bm++){var bp=bm+1;bn[bm].innerHTML=aI.translations.roomCount+" "+bp+":";bn[bm].show();}}function aD(bo){var bm=0,bn=bo.value-1;aj();for(bm;bm<bn;bm++){var bp=a1.$occupanciesContainer.clone(true);m();a1.$multiRoomContainer.insert(bp);a1.hideChildAges(a1.$multiRoomContainer.childElements()[bm].down(".dynamic_children"));}aR();N();}function ab(bm){return parseInt(bm,10)||0;}function O(bm){if(ab(bm.value)>1){aD(bm);}else{aj();}}function T(bu){if(aP()&&aI.isMultiRoomEnabled&&bu.room_info){var bo,bq=bu.room_info.evalJSON().rooms,bA,bn,bv,by,bs,bw,bm;if(bq===undefined){return;}O(a1.$rooms);for(var bt=0,bx=bq.length;bt<bx;bt++){bo=$$(".occupancies-container");bo[bt].down("[name=adults]").value=bq[bt].numAdults;bA=bq[bt].numInfantsInSeats+bq[bt].numInfantsInLaps;bw=bq[bt].childAges;bm=bw.length;bn=bo[bt].down(".children");if(bo[bt].down(".dynamicChildrenLabeledInput").visible()){bo[bt].down("[name=dynamic_children]").value=bw.length+(bA||0);bv=bo[bt].down(".child-age-container");for(var br=0;br<bm;br++){var bz=br+1;bv.down(".childAge"+bz+"LabeledInput").show();bv.down(".child_age"+bz).value=bw[br];}by=bv.select(".child-infant-container");for(var bp=0;bp<bA;bp++){bs=by[bm+bp];if(bp<bq[bt].numInfantsInLaps){a5(bs,true);}else{a5(bs,false);}}}else{if(bn){bn.value=bw.length+bA;}}}a3();}}function L(bo){var bm={};for(var bn in bo){bm[bn.toLowerCase()]=bo[bn];}return bm;}function bg(bn,bp){if(!bn){bp.value="";}else{var bm=bn.split(":").first();var bo=ab(bm);if(isFinite(bo)){bp.value=bo;}}}function ah(bm){var bo;var bn;for(bn in bm){bo=a1.$form.down("[name='"+bn+"']");if(bo){if(bo.type.toLowerCase()==="radio"||bo.type.toLowerCase()==="checkbox"){bo=a1.$form.down("[name='"+bn+"'][value='"+bm[bn]+"']");if(bo){a1.checkRadioInput(bo);}}else{bo.value=bm[bn];if(bn==="area1"&&a1.$displayArea1){if(!bm.area1){a1.$displayArea1.value="";}else{a1.$displayArea1.value=bm.displayarea1;}}else{if(bn==="area2"&&a1.$displayArea2){if(!bm.area2){a1.$displayArea2.value="";}else{a1.$displayArea2.value=bm.displayarea2;}}else{if(bn==="date3"&&a1.$displayDate3){if(!bm.date3){a1.$date3LabeledInput.value="";}else{a1.$date3LabeledInput.value=bm.date3;}}else{if(bn==="date4"&&a1.$displayDate4){if(!bm.date4){a1.$date4LabeledInput.value="";}else{a1.$date4LabeledInput.value=bm.date4;}}else{if(bn==="date5"&&a1.$displayDate5){if(!bm.date5){a1.$date5LabeledInput.value="";}else{a1.$date5LabeledInput.value=bm.date5;}}}}}}if(bn==="time1"||bn==="time2"){bg(bm[bn],bo);}}}}}function a4(){var bn=u();var br;if(bn&&bn.checked&&a1.$oneway&&a1.$oneway.checked){G(a1.$time2LabeledInput);G(a1.$date2LabeledInput);br=a1.$date2LabeledInput.next();if(br&&br.hasClassName("calendar-image")){G(br);}}else{var bq=bh();if(bq){bq=a1.getSearchContextValue(bq);var bm=aI.searchContextFields[bq],bp=bm.indexOf("time2LabeledInput")>-1,bo=bm.indexOf("date2LabeledInput")>-1;if(bp){ad(a1.$time2LabeledInput);}if(bo){ad(a1.$date2LabeledInput);br=a1.$date2LabeledInput.next();if(br&&br.hasClassName("calendar-image")){ad(br);}}}}}function l(){if(aI.shouldPopulateWithLastSearch){var bm=L(aI.lastSearch);ah(bm);T(bm);a4();}}function ba(){var bp=bh();if(!bp){return;}bp=a1.getSearchContextValue(bp);var bo=location.href.split("?");var bn=location.href.toQueryParams();var bm={air:"a",room:"r",car:"c",activity:"act",air_room:"p",air_car:"p",room_car:"p",air_room_car:"p",advanced_air:"aa"};var bq=bo[0];if(bq.indexOf("arc_process.cfm")!==-1){bq=bq.replace("arc_process.cfm","arc.cfm");}if(bo.length===1){bn={};}bn.tab=bm[bp];if(bn.tab==="p"){bn.air_room_car_radio=bp;}else{delete bn.air_room_car_radio;}a1.$originUrl.value="#{baseUrl}?#{params}".interpolate({baseUrl:bq,params:$H(bn).toQueryString()});}function aC(bn){var bm={air:aI.translations.airTitle,room:aI.translations.roomTitle,car:aI.translations.carTitle,air_room:aI.translations.airRoomTitle,air_car:aI.translations.airCarTitle,room_car:aI.translations.roomCarTitle,air_room_car:aI.translations.airRoomCarTitle,advanced_air:aI.translations.advancedAirTitle,act:aI.translations.activityTitle,activity:aI.translations.activityTitle};if(!bn){return"";}return bm[bn];}function D(){var bn=bh(),bm;if(bn){bm=bn.name==="activity1"||q==="act"?"activity":bn.value;a1.updateTitle(aC(bm));}}function C(){var bn="",bo="",bm=bh();if(!bm){return;}bm=a1.getSearchContextValue(bm);if(bm==="air"){bn=aI.translations.airStartDateLabel;bo=aI.translations.airEndDateLabel;}else{if(bm==="advanced_air"){bn=aI.translations.airStartDateLabel;bo=aI.translations.airStartDateLabel;}else{if(bm==="room"){bn=aI.translations.roomStartDateLabel;bo=aI.translations.roomEndDateLabel;}else{if(bm==="car"){bn=aI.translations.carStartDateLabel;bo=aI.translations.carEndDateLabel;}else{if(bm==="activity"){bn=aI.translations.activityStartDateLabel;bo=aI.translations.activityEndDateLabel;}else{if(bm==="room_car"){bn=aI.translations.nonAirPackageStartDateLabel;bo=aI.translations.nonAirPackageEndDateLabel;}else{if(bm==="air_room"||bm==="air_car"||bm==="air_room_car"){bn=aI.translations.airPackageStartDateLabel;bo=aI.translations.airPackageEndDateLabel;}}}}}}}a1.$date1LabeledInput.down(".labelText").innerHTML=bn;a1.$date2LabeledInput.down(".labelText").innerHTML=bo;}function Y(){var bo="",bm="",bn=bh();if(!bn){return;}bn=a1.getSearchContextValue(bn);if(bn==="air"||bn==="advanced_air"){bo=aI.translations.defaultOriginLabel;bm=aI.translations.defaultDestinationLabel;}else{if(bn==="room"){bo=aI.translations.defaultOriginLabel;bm=aI.translations.roomDestinationLabel;}else{if(bn==="car"){bo=aI.translations.carOriginLabel;bm=aI.translations.carDestinationLabel;}else{if(bn==="activity"){bo=aI.translations.defaultOriginLabel;bm=aI.translations.activityDestinationLabel;}else{if(bn==="air_room"||bn==="air_car"||bn==="air_room_car"||bn==="room_car"){bo=aI.translations.packageOriginLabel;bm=aI.translations.packageDestinationLabel;}}}}}a1.$area1Container.down(".labelText").innerHTML=bo;a1.$area2Container.down(".labelText").innerHTML=bm;}function ag(){var bo=bh();if(!bo){return;}bo=a1.getSearchContextValue(bo);var bn=aI.filters[bo].origin,bp=aI.filters[bo].destination,bm;if(bn){for(bm=0;bm<a1.$allOriginAutoCompleteFilters.length;bm++){if(a1.$allOriginAutoCompleteFilters[bm]){a1.$allOriginAutoCompleteFilters[bm].value=bn;}}}if(bp){for(bm=0;bm<a1.$allDestinationAutoCompleteFilters.length;bm++){if(a1.$allDestinationAutoCompleteFilters[bm]){a1.$allDestinationAutoCompleteFilters[bm].value=bp;}}}}function aZ(){var bm=bh();if(bm){bm=a1.getSearchContextValue(bm);if(a1.$autoCompleteSearchContextFields){a1.$autoCompleteSearchContextFields.each(function(bn){bn.value=bm;});}}}function be(){if(a1.$rooms.value>1){aR();}[a1.$multiRoomContainer].invoke("show");$$("."+a1.$multiRoomContainer.className+" select").invoke("enable");}function bl(){var bm=a1.getSearchContextValue(),bo=bm?aI.searchContextFields[bm]:undefined,bp=!bo||bo.indexOf("numRoomsLabeledInput")!==-1,bn=aP()&&bp;if(bn){be();}else{y();}}function a6(){a1.$form.select(".dynamicChildrenLabeledInput").each(function(bm){if(bm.visible()){j(bm.down("[name='dynamic_children']"));}});if(aI.isMultiRoomEnabled&&a1.$multiRoomContainer){bl();}}function v(){var bm=bh();if(bm){return bm.value.indexOf("_")!==-1;}return false;}function a9(){var bn=a1.$partialRoomStay&&a1.$partialRoomStayLabeledInput;var bm=ab(a1.$rooms.value);if(aI.isMultiRoomEnabled&&bn&&v()){if(bm===1||aI.shouldShowPartialRoomStayLabeledInputForMultiRoomSelection){ad(a1.$partialRoomStayLabeledInput);if(a1.$partialRoomStay.checked){ad(a1.$partialRoomStayRangeContainer);ad(a1.$displayDate3);ad(a1.$displayDate4);}else{G(a1.$partialRoomStayRangeContainer);}}else{if(bm>1){G(a1.$partialRoomStayLabeledInput);G(a1.$partialRoomStayRangeContainer);}}}bc();}function bd(){if(a1.$partialRoomStay&&a1.$partialRoomStay.checked&&a1.$partialRoomStayLabeledInput&&a1.$partialRoomStayLabeledInput.visible()){ad(a1.$partialRoomStayRangeContainer);a9();}else{var bm=ab(a1.$rooms.value);if(bm>1&&aI.isMultiRoomEnabled){G(a1.$partialRoomStayLabeledInput);}G(a1.$partialRoomStayRangeContainer);}}function p(){var bm=bh();if(bm){bm=a1.getSearchContextValue(bm);bm=bm.replace(/_/g,"-");a1.$form.className="search-form "+bm+"-search-form";}}function f(){p();C();a6();ag();aZ();ba();D();Y();if(a1.$rooms){bd();}a4();}function o(){var bn=z.toLowerCase().toQueryParams(),bm;if(bn.area2){bm=bn.area2.toUpperCase();a1.$area2.value=bm;if(a1.$displayArea2){a1.$displayArea2.value=bm;}}}function af(){if(a1.$hotelInfo){var bm=a1.$hotelInfo.down("[name='area2']"),bo=a1.$hotelInfo.down("[name='all_hotels']"),bn=a1.$hotelInfo.down("[name='hotel_id']");if(bm){a1.$area2.value=bm.value;a1.$displayArea2.value=bm.value;}if(bo){bo.value=aI.isAllHotelsEnabled;a1.$form.insert(bo);}if(bn){a1.$form.insert(bn);}}}function aA(){af();o();}function aL(){if(!aI.searchContextFields||!aI.alternativeSearchContextSelectionUI){return;}var bm=Object.keys(aI.searchContextFields);aI.alternativeSearchContextSelectionUI.select("option").each(function(bn){if(bm.indexOf(bn.value)===-1){bn.remove();}});}function M(bn){var bm=$(bn.target),br,bp;function bo(bs){return bs.className.split("-").first();}function bq(bs){return bs.tagName.toLowerCase()==="select";}if(!bm||!bq(bm)){return;}br=bm.select("option[selected]").first();if(!br){return;}bp=bo(br);a1.switchSearchContext(bp);}function x(bn){if(!bn){return;}var bo=bn.up("li"),bm=bn.title.split("-")[0];a1.updateTitle(aC(bm));a1.selectSearchContext(bo);a1.switchSearchContext(bm);a2.publish("searchFormComponent/tabChanged",[bm]);}function s(bo){var bn=$(bo.target);if(!bn){return;}var bm=bn.nodeName==="A"?bn:bn.up("a");x(bm);}function aG(bn){var bm=$(bn.target);if(!bm){return;}x(bm);}function aM(bt){var bn=$(bt.target);if(!bn||bn.type!=="checkbox"){return;}if(!a1.$alternativeSearchContextSelectionUIOptions){return;}var bq=a1.$alternativeSearchContextSelectionUIOptions.air;var bs=a1.$alternativeSearchContextSelectionUIOptions.room;var bu=a1.$alternativeSearchContextSelectionUIOptions.car;var bo=a1.$alternativeSearchContextSelectionUIOptions.act;if(!bq.checked&&!bs.checked&&!bu.checked&&!bo.checked){bn.checked=true;return;}if(bn.name!=="activity_checkbox"){bo.checked=false;}else{if(bo.checked){bq.checked=bs.checked=bu.checked=false;}}var br=[];for(var bp=0,bm=Q.length;bp<bm;bp++){if(a1.$alternativeSearchContextSelectionUIOptions[Q[bp]].checked){br.push(Q[bp]);}}a1.switchSearchContext(br.join("_"));}function B(){var bq,bm,bp;if(aI.alternativeSearchContextUIType){if(aI.alternativeSearchContextUIType==="tabs"){aI.alternativeSearchContextSelectionUI=$$(".search-context-tabs").first();bq=$$(".search-context-tabs a");bm=Object.keys(aI.searchContextFields);for(bp=0;bp<bq.length;++bp){if(bm.indexOf(bq[bp].title)===-1){bq[bp].up("li").hide();a2.publish("searchFormComponent/hideComponent",[bq[bp].title]);}}aI.alternativeSearchContextSelectionUI.style.display="block";aI.alternativeSearchContextSelectionUI.observe("click",s);aI.alternativeSearchContextSelectionUI.observe("keydown",function(br){if(br.keyCode===Event.KEY_RETURN){aG(br);}});}else{if(aI.alternativeSearchContextUIType==="checkboxes"){aI.alternativeSearchContextSelectionUI=$$(".search-context-checkboxes").first();if(aI.alternativeSearchContextSelectionUI&&!a1.$alternativeSearchContextSelectionUIOptions){a1.$alternativeSearchContextSelectionUIOptions={air:aI.alternativeSearchContextSelectionUI.down("input[name='air_checkbox']"),room:aI.alternativeSearchContextSelectionUI.down("input[name='room_checkbox']"),car:aI.alternativeSearchContextSelectionUI.down("input[name='car_checkbox']"),act:aI.alternativeSearchContextSelectionUI.down("input[name='activity_checkbox']")};}bq=$$(".search-context-checkboxes input");bm=Object.keys(aI.searchContextFields);var bo,bn;for(bp=0;bp<bq.length;++bp){bo=bq[bp].name||"";bo=bo.substring(0,bo.indexOf("_"));if(bm.indexOf(bo)===-1){bn=bq[bp].up("div");if(bn){bn.hide();a2.publish("searchFormComponent/hideComponent",[bo]);}}}aI.alternativeSearchContextSelectionUI.style.display="block";aI.alternativeSearchContextSelectionUI.observe("click",aM);}else{if(aI.alternativeSearchContextUIType==="dropdown"){aI.alternativeSearchContextSelectionUI=$$(".search-context-dropdown").first();bq=aI.alternativeSearchContextSelectionUI.select("option");bm=Object.keys(aI.searchContextFields);for(bp=0;bp<bq.length;++bp){if(bm.indexOf(bq[bp].title)===-1){bq[bp].hide();a2.publish("searchFormComponent/hideComponent",[bq[bp].title]);}}aL();aI.alternativeSearchContextSelectionUI.style.display="block";aI.alternativeSearchContextSelectionUI.observe("change",M);}}}}}function aT(){var br=az[q],bq=arguments[0]==="recentSearch";if(br==="package"){br=K;}if(bq||!br&&a1.$recentSearches){var bo=a1.$recentSearches.getValue();if(bo){br=L(bo.evalJSON()).air_room_car_radio;}}if(!br&&aI.lastSearch&&aI.lastSearch.air_room_car_radio){br=aI.lastSearch.air_room_car_radio;}if(!br){var bm=[];if(b.Search.products.hasAir){bm.push("air");}if(b.Search.products.hasRoom){bm.push("room");}if(aI.lastSearch&&(aI.lastSearch.car1===true||aI.lastSearch.air_room_car_radio==="air_room_car")){bm.push("car");}if(bm.length){br=bm.join("_");}}if(!br){br=aI.defaultSearchContext;}if(br&&aI.alternativeSearchContextSelectionUI){if(aI.alternativeSearchContextUIType==="tabs"){var bu=aI.alternativeSearchContextSelectionUI.down("."+br+"-tab");if(bu){a1.selectSearchContext(bu);a1.updateTitle(aC(br));}}else{if(aI.alternativeSearchContextUIType==="checkboxes"){var bt=br.split("_"),bv;if(a1.$alternativeSearchContextSelectionUIOptions){for(var bs=0,bn=bt.length;bs<bn;bs++){bv=a1.$alternativeSearchContextSelectionUIOptions[bt[bs]];if(bv){bv.checked=true;}}}}else{if(aI.alternativeSearchContextUIType==="dropdown"){var bp=aI.alternativeSearchContextSelectionUI.down("."+br+"-option");if(bp){bp.selected=true;}}}}}a1.switchSearchContext(br);}function aW(bm){if(bm){bm.checked=false;}}function a0(bm){if(bm.name==="activity1"){a1.includeOnly(aI.searchContextFields.activity);aW($$("[name='air_room_car_radio']:checked").first());}else{if(a1.$advancedAirSearch){if(bm.value==="advanced_air"){a1.$advancedAirSearch.value="true";a1.$fieldsetContainer.addClassName("advanced_air");}else{a1.$advancedAirSearch.value="false";a1.$fieldsetContainer.removeClassName("advanced_air");}}if(bm.getAttribute("role")==="tab"){a1.includeOnly(aI.searchContextFields[bm.title]);}else{if(bm.tagName.toLowerCase()==="input"){a1.includeOnly(aI.searchContextFields[bm.value]);}}aW($$("[name='activity1']:checked").first());}}function aJ(bm){var bn=bm.target;if(bn.tagName.toLowerCase()!=="input"){return;}a0(bn);bb();f();a2.publish("searchFormComponent/checkRadioInput",[a1.getSearchContextValue(bn),bn]);}function ae(){return bh()?true:false;}function ac(){var bm=u();if(bm){a1.checkRadioInput(bm);return;}bm=ax();if(bm){a1.checkRadioInput(bm);}bm=at();if(bm){a1.checkRadioInput(bm);}bm=k();if(bm){a1.checkRadioInput(bm);}bm=g();if(bm){a1.checkRadioInput(bm);}bm=aU();if(bm){a1.checkRadioInput(bm);}bm=aQ();if(bm){a1.checkRadioInput(bm);}bm=au();if(bm){a1.checkRadioInput(bm);}bm=aE();if(bm){a1.checkRadioInput(bm);}e.Util.Debug.info("No matching or default search context found.");}function r(){var bm=aI.validationOptions.fieldsToValidate;for(var bn=0,bo=bm.length;bn<bo;bn++){if(bm[bn]){if(bm[bn]===a1.$area2){bm[bn].setAttribute("data-validate","required notSameValueAsOrigin");}else{bm[bn].setAttribute("data-validate","required");}}}a1.validator=new e.Validator(a1.$form,{validateAllFieldsOnSubmit:false,nodesToValidate:aI.validationOptions.nodesToValidate,rules:aI.validationOptions.rules,errorMessages:aI.validationOptions.errorMessages,alwaysAllowEmptyFields:true});}function a8(){if(aV.form){a1.$searchFormContainer.setStyle({display:"block"});}}function U(bq){var bs=a1.$form.down(".area1LabeledInput .autoCompleteValueInput");var br=a1.$form.down(".area2LabeledInput .autoCompleteValueInput");if(bq){var bp=a1.$displayArea2.value||"";var bo=br.value||"";a1.$displayArea2.value="";br.value="";a1.$displayArea1.value=bp;bs.value=bo;}else{var bm=a1.$displayArea1.value||"";var bn=bs.value||"";a1.$displayArea1.value="";bs.value="";a1.$displayArea2.value=bm;br.value=bn;}}function aO(){a1.$defaultSearchContextSelectionUI.observe("click",aJ);if(aI.shouldShowLocationAutoCompleteHint){F();}aT();E();aX();bb();l();B();f();aA();a2.publish("url/params/tab",[z.toQueryParams().tab]);if(!ae()){ac();f();}if(aI.shouldValidateSearchForm){r();}if(aI.shouldRenderSearchFormOnInitialLoad){a8();}R();if(a1.$oneWayCar){a1.$oneWayCar.observe("click",function(bm){if(aI.swapCarLocations){U(bm.target.checked);}});}}function S(){if(a1.$recentSearches){var bn=a1.$recentSearches.getValue();if(bn){var bm=L(bn.evalJSON());ah(bm);T(bm);a4();}}}function bf(){if(!aI.lastSearch){return;}var bn=[["time1","$time1","defaultStartHour"],["time2","$time2","defaultEndHour"],["time3","$time3","defaultStartHour"],["time4","$time4","defaultEndHour"]];var bm,bo;bn.forEach(function(bp){if(!aI.lastSearch[bp[0]]&&a1[bp[1]]&&aI[bp[2]]){bm=$$("."+a1[bp[1]].className+" option[value='"+aI[bp[2]]+"']").first();if(bm){bm.selected=true;}}});}function t(){if(aI.alternativeSearchContextSelectionUI){a1.$defaultSearchContextSelectionUI.hide();}}function aH(){var bm="."+a1.$form.className.replace(/\s/g,"."),bo=aI.searchContextFields,bs,br=true,bt=$$(bm+" .option"),bn=0,bq=bt.length;for(var bp in bo){bs=bp==="activity"?$$("input[name='activity1']").first():$$("input[value='"+bp+"'][type='radio']").first();if(br&&bo[bp].length>0&&bs&&bh().value===bs.value){aI.include=bo[bp];br=false;}if(bs){bs.up(".option").addClassName("availableOption");}}for(bn;bn<bq;bn++){if(!bt[bn].hasClassName("availableOption")){bt[bn].remove();}}}function A(){function bs(){$$(".search-form .fields .date-time-fields .flight.leg-2").first().show();}if(!aI.searchContextFields.advanced_air){aI.enableFastAdvancedAir=false;}if(!aI.enableFastAdvancedAir&&a1.$fastAdvancedAirInput){a1.$fastAdvancedAirInput.remove();}var bp=1;var bm=2;var bn=$$(".search-form .location-fields .flight").last();if(typeof bn!=="undefined"){bm=Number(bn.className.match(/\d+/)[0]);}a1.$roundtripOptionsContainer.observe("click",function(bt){if(bt.findElement("input")){if(bt.findElement(".multilegLabeledInput")){a1.checkRadioInput(au());$$(".search-form .fields.advanced_air .flight").each(function(bu){if(parseInt(/leg-(\d+)/.exec(bu.className)[1],10)>bp){bu.hide();}});}else{a1.checkRadioInput(u());bs();}}});var bo;function br(bt){if(bt.length>0){bt.first().select(".autoCompleteLabeledInput").forEach(function(bu){bu.down(".autoCompleteValueInput").value="";bu.down(".autoCompleteDisplayInput").value="";});}}a2.subscribe("searchFormComponent/checkRadioInput",function(bu){function bt(){$$(".roundtripLabeledInput input")[0].checked=true;}if(bo!==undefined){if(bu==="air"&&bo!==bu){if(bo!=="advanced_air"){bt();}else{if(!aI.enableFastAdvancedAir){bt();}}}}if(aI.enableFastAdvancedAir){bs();}bo=bu;});function bq(){if(bp<bm){$$(".remove-flight")[0].show();if($$(".advanced-air-search-form").first()){bp=b.Search.destinationInfoList.length;}else{++bp;}}}if($$(".add-flight").length&&$$(".remove-flight").length){bq();$$(".add-flight")[0].observe("click",function(bt){bt.preventDefault();$$(".search-form .fields.advanced_air .flight.leg-"+(bp+1)).each(Element.show);$$(".remove-flight")[0].show();++bp;if(bp===bm){$$(".add-flight")[0].hide();}});$$(".remove-flight")[0].observe("click",function(bt){bt.preventDefault();if(bp>=2){$$(".search-form .fields.advanced_air .flight.leg-"+bp).each(Element.hide);br($$(".search-form .fields.advanced_air .location-fields > .flight.leg-"+bp));$$(".add-flight")[0].show();--bp;}if(bp===1){$$(".remove-flight")[0].hide();}});}}function bk(bm){var bn=bm.target;if(bn.getAttribute("role")!=="tab"){return;}a0(bn);$$(".search-form")[0].focus();bb();f();a2.publish("searchFormComponent/checkRadioInput",[a1.getSearchContextValue(bn),bn]);}function ay(bn){var bm=$(bn.target);if(bm.name!==a1.$roundtrip.name||bm.name!==a1.$oneway.name){return;}a2.publish("searchFormComponent/roundtrip/change",[bm]);}function H(bn){if(!a1.$rooms){return;}var bm=$(bn.target);if(bm.name!==a1.$rooms.name){return;}a2.publish("searchFormComponent/rooms/change",[bm]);}function X(bn){if(!a1.$partialRoomStay){return;}var bm=$(bn.target);if(bm.name!==a1.$partialRoomStay.name){return;}a2.publish("searchFormComponent/partialRoomStay/change",[bm]);}function W(){var bm=aE();var bn=bj();return bm&&bm.checked||bn&&bn.checked;}function ak(){if(aI.isMultiRoomEnabled&&aP()&&!W()){var by={rooms:[]},bx=$$(".occupancies-container"),br=0,bw=bx.length;for(br;br<bw;br++){var bm={childAges:[],numAdults:ab(bx[br].down(".adults").value),numSeniors:ab(bx[br].down(".seniors").value),numInfantsInSeats:0,numInfantsInLaps:0};if(bx[br].down(".dynamicChildrenLabeledInput").visible()){var bq=1,bu=ab(bx[br].down(".dynamic_children").value);for(bq;bq<=bu;bq++){var bv=bx[br].down(".child_age"+bq);var bo=ab(bv.value);if(bo>=2){bm.childAges.push(bo);}else{var bs=bv.up(".child-infant-container");var bt=bs.down("input[type='radio']:checked");if(bt){if(bt.value==="in_lap"){bm.numInfantsInLaps+=1;}else{bm.numInfantsInSeats+=1;}}}}}else{var bp=0,bn=ab(bx[br].down(".children").value);for(bp;bp<bn;bp++){bm.childAges.push(a1.DEFAULT_CHILD_AGE);}}by.rooms.push(bm);bx[br].select("select").invoke("disable");bx[br].select("input[type='radio']").invoke("disable");}a1.$roomInfo.value=JSON.stringify(by);}else{if(a1.$roomInfo){a1.$roomInfo.value="";}}}function av(){if(aI.alternativeSearchFormActionUrl){a1.$form.action=aI.alternativeSearchFormActionUrl;}}function n(bn){var bm=$(bn.target);if(!bm.hasClassName("autoCompleteDisplayInput")){return;}bm.value="";bm.up(".autoCompleteLabeledInput").down(".autoCompleteValueInput").value="";}function Z(bm){function bn(){return aI.submit&&!aI.submit.call(a1,bm);}function bo(){if(aI.shouldValidateSearchForm&&a1.validator){return a1.validator.validateAll();}return true;}if(bn()||!bo()){Event.stop(bm);return;}av();ak();}function P(bo){var bm=b.use("searchCalendar"),bq=aI.maxDaysInAdvance[bo],bn=aI.minDaysInAdvance[bo],bp=b.SysConf.systemTime.clone();if(bn>0){bm.setMinDate(bp.addDays(bn));}else{bm.setMinDate(bp);}if(bq>0){bm.setMaxDate(bm.getMinDate().clone().addDays(bq));}else{bm.setMaxDate(null);}if(a1.$partialRoomStay&&a1.$partialRoomStay.checked){bm.clearInputs();bm.addInput("date1");bm.addInput("date2");bm.addInput("date3");bm.addInput("date4");}}this.setContext=x;this.getSearchContextValue=function(bm){bm=bm||bh();if(!bm){return null;}return bm.name==="activity1"?"activity":bm.value;};this.addListener=function(bn,bm,bo){a1.$form.on(bm,bn,bo);};this.addClassToInput=function(bo,bn){var bm=bo.down("input");bm.addClassName(bn);};this.removeClassFromInput=function(bo,bn){var bm=bo.down("input");bm.removeClassName(bn);};this.includeOnly=function(bm){aI.include=bm;aI.exclude=[];};this.excludeOnly=function(bm){aI.exclude=bm;aI.include=[];};this.checkRadioInput=function(bm){if(bm){I(bm,"click",function(bn){bn.additionalData={eventSource:"simulated"};});$(bm).checked=true;a2.publish("searchFormComponent/checkRadioInput",[a1.getSearchContextValue(bm),bm]);}};this.selectSearchContext=function(bn){var bm=aI.alternativeSearchContextSelectionUI?aI.alternativeSearchContextSelectionUI.down(".selected"):a1.$defaultSearchContextSelectionUI.down(".selected");if(bm){bm.removeClassName("selected");}bn.addClassName("selected");};this.updateTitle=function(bm){a1.$title.innerHTML=bm;};this.updateDropdown=function(bn,bm){bn.value=bm;};this.updateLabel=function(bp,bq,bo){var bn="."+bp+"-search-form ."+bq+"LabeledInput .labelText",bm=$$(bn).first();if(bm){bm.update(bo);}};this.setOptions=function(bm){if(bm.submit&&typeof bm.submit==="function"){aI.submit=bm.submit;}if(bm.searchContextFields){aI.searchContextFields=bm.searchContextFields;}if(bm.alternativeSearchContextSelectionUI){aI.alternativeSearchContextSelectionUI=bm.alternativeSearchContextSelectionUI;}if(bm.alternativeSearchContextUIType){aI.alternativeSearchContextUIType=bm.alternativeSearchContextUIType;}if(bm.alternativeSearchFormActionUrl){aI.alternativeSearchFormActionUrl=bm.alternativeSearchFormActionUrl;}if(bm.validationOptions){aI.validationOptions=bm.validationOptions;}if(bm.enableFastAdvancedAir){aI.enableFastAdvancedAir=bm.enableFastAdvancedAir;}if(bm.isOneCarBookingEnabled&&a1.$oneWayCar){aI.isOneCarBookingEnabled=bm.isOneCarBookingEnabled;}if(bm.inputsAcceptNumbersOnly){aI.inputsAcceptNumbersOnly=bm.inputsAcceptNumbersOnly;}if(bm.shouldShowPartialRoomStayLabeledInputForMultiRoomSelection){aI.shouldShowPartialRoomStayLabeledInputForMultiRoomSelection=bm.shouldShowPartialRoomStayLabeledInputForMultiRoomSelection;}if(bm.swapCarLocations){aI.swapCarLocations=bm.swapCarLocations;}a1.render();};this.getOptions=function(){return aI;};this.updateDates=function(bm){var bn=Object.extend(aI.calendarOffsets,bm);if(!a1.$date1||!a1.$date2){return;}if(aI.shouldPopulateWithLastSearch&&aI.lastSearch.area2){if(a1.$date1.value===""||a1.$date1.value===bn.format){a1.$date1.value=new Date().add({days:bn.startDateOffset}).format(bn.format);}if((a1.$date2.value===""||a1.$date2.value===bn.format)&&e.StringUtil.parseBoolean(aI.lastSearch.roundtrip)){a1.$date2.value=new Date().add({days:bn.endDateOffset}).format(bn.format);}}else{a1.$date1.value=new Date().add({days:bn.startDateOffset}).format(bn.format);a1.$date2.value=new Date().add({days:bn.endDateOffset}).format(bn.format);}};this.hideChildAges=function(bm){aS(bm).each(function(bn){G(bn);});};this.switchSearchContextUsingTabParam=function(bm){if(!bm){return;}switch(bm){case"a":a1.checkRadioInput(u());break;case"r":a1.checkRadioInput(ax());break;case"c":a1.checkRadioInput(at());break;case"p":var bo=bh()?a1.getSearchContextValue(bh()):undefined;var bn=K?K:bo;switch(bn){case"air_room":a1.checkRadioInput(aU());break;case"air_car":a1.checkRadioInput(g());break;case"air_room_car":a1.checkRadioInput(aQ());break;case"room_car":a1.checkRadioInput(k());break;default:break;}break;case"act":a1.checkRadioInput(aE());break;case"h":ac();break;default:ac();break;}};this.getAgentOptions=function(){return aI.advancedAirUserTypes;};this.isTrueFit=function(){return aI.isTrueFit;};this.getAgentType=function(){return aI.agentType.toLowerCase();};this.switchSearchContext=function(bm){if(!bm){return;}switch(bm){case"air":a1.checkRadioInput(u());break;case"room":a1.checkRadioInput(ax());break;case"car":a1.checkRadioInput(at());break;case"room_car":a1.checkRadioInput(k());break;case"air_car":a1.checkRadioInput(g());break;case"air_room":a1.checkRadioInput(aU());break;case"air_room_car":a1.checkRadioInput(aQ());break;case"advanced_air":a1.checkRadioInput(au());break;case"act":case"activity":a1.checkRadioInput(aE());break;default:ac();break;}};function aF(){$$(".datePickerInput").each(function(bm){return $(bm).observe("keypress",function(bo){var bn=/[\d\/]/.test(bo.key);if(!bn){Event.stop(bo);}});});}this.render=function(){aH();B();if(!ae()){ac();f();}t();bb();if(arguments[0]==="recentSearch"){S();aT("recentSearch");}else{l();aT();}f();aA();P(a1.getSearchContextValue(bh()));bf();a3();a2.publish("searchFormComponent/checkRadioCarInput");if(aI.enableFastAdvancedAir){A();}if(aI.isOneCarBookingEnabled&&a1.$oneWayCar){aB();}if(aI.inputsAcceptNumbersOnly){aF();}if(!aI.shouldRenderSearchFormOnInitialLoad){a8();}};this.updateFieldsWithRecentSearch=function(){a1.render("recentSearch");};this.applyListeners=function(){if(a1.$dynamicChildren){a1.$dynamicChildren.observe("change",ap);}bc();if(a1.$roundtripOptionsContainer){a1.$roundtripOptionsContainer.observe("click",ay);}if(a1.$rooms){a1.$rooms.observe("change",H);}if(a1.$partialRoomStay){a1.$partialRoomStay.observe("click",X);}aY.each(function(bm){return bm.observe("keydown",function(bn){if(bn.keyCode===Event.KEY_RETURN){bk(bn);}});});a1.$form.observe("click",n);a1.$form.observe("submit",Z);a2.subscribe("searchFormComponent/roundtrip/change",function(){a4();});a2.subscribe("searchFormComponent/dynamicChildren/change",al);if(aI.isInfantsEnabled){a2.subscribe("searchFormComponent/dynamicChildren/infantOption",function(bm){bi(bm);});}a2.subscribe("searchFormComponent/rooms/change",function(bm){if(aI.isMultiRoomEnabled){O(bm);a9();}});a2.subscribe("searchFormComponent/dynamicChildren/change",function(){if(aI.isMultiRoomEnabled){m();}});a2.subscribe("searchFormComponent/partialRoomStay/change",function(bm){if(bm.checked){ad(a1.$partialRoomStayRangeContainer);}else{G(a1.$partialRoomStayRangeContainer);}});a2.subscribe("url/params/tab",function(bm){a1.switchSearchContextUsingTabParam(bm);});a2.subscribe("searchFormComponent/checkRadioInput",function(bm){P(bm);});};aO();};b.createUIComponent("searchFormComponent",{initialize:function(f){c();return new e.UI.SearchForm(f);},applyListeners:function(f){f.applyListeners();}});})(EzRez.Application,EzRez,YAHOO);(function(a){var b=function(l){var p=Object.extend({maxRecentSearches:0,shouldRememberSearchesByDefault:false},l);var h=new EzRez.UI.DOMCache({rootNode:".recentSearchesContainer",nodes:{recentSearchesSelector:function(s){return s.down(".recentSearchesSelector");},recentSearchEnabler:function(s){return s.down(".recentSearchesEnabler");}}});var q=function(s){var u=$(s.target);var t=u.getValue();if(!EzRez.StringUtil.isSet(t)||t!=="separator"){if(t==="stop_recent_searches"){f(h);}else{if(t==="clear_recent_searches"){c(h);}else{j(h,t);}}}};var k=function(){m();};function m(){n("TRUE");h.recentSearchEnabler.hide();}function i(){h.cache();if(EzRez.Util.Cookie.read("EZ_REMEMBER_RECENT_SEARCHES")===null&&p.shouldRememberSearchesByDefault){m();}}function e(t,u,s){EzRez.Util.Cookie.create(t,u,s);}function g(s){EzRez.Util.Cookie.erase(s);}function n(t){var s=365*10*24;e("EZ_REMEMBER_RECENT_SEARCHES",t,s);}function d(){for(var s=1;s<=p.maxRecentSearches;s++){g("EZ_RECENT_SEARCH"+s);}}function c(s){d();s.recentSearchesSelector.hide();}function f(s){n("FALSE");d();s.recentSearchesSelector.hide();s.recentSearchEnabler.show();}function r(s,t){EzRez.Util.Event.pubsub.publish("recentsearch/searchform/onchange",[{name:s,value:t}]);}function o(u,s){if(!s){return;}var t=new Hash(u.evalJSON());t.each(function(C){var w=C.key;var B=C.value;var z;var v;var x=w.toLowerCase();if(x==="area1"||x=="area2"){var A="."+x+"LabeledInput";z=s.down(A+" .autoCompleteDisplayInput");v=s.down(A+" .autoCompleteValueInput");}if(!z){z=s.down('[name="'+x+'"]');}if(z){if(z.type==="radio"){var y=s.down('[value="'+B+'"]');y.click();r(w,B);}else{if(z.type==="checkbox"){z.click();}else{if(z.type==="select"||z.type==="select-one"){z.value=B;r(w,B);}else{z.value=B;if(v){v.value=B;}}}}}});}function j(s,u){var v=a.use("searchFormComponent");var t=$$(".search-form").first();if(v&&t){v.updateFieldsWithRecentSearch();}else{o(u,s.rootNode.up("form"));}}this.applyListeners=function(){var t=h.recentSearchesSelector;if(t){t.on("change",q);}var s=h.recentSearchEnabler;if(s){s.on("click",k);}};i();};a.createUIComponent("recentSearchesComponent",{initialize:function(c){return new b(c);},applyListeners:function(c){c.applyListeners();}});})(EzRez.Application);(function(b){var a=function(c){var e=Object.extend({linkClass:"carCrossSellOptions",selectedCarOptionClass:"selectedCarOption",carKeyFieldId:"selectedCarKey",linkSelector:".carCrossSellOptions .card_link a",initiallySelectedCarKey:""},c);var g=$$(e.linkSelector),h=$$("."+e.linkClass+" ."+e.selectedCarOptionClass),d=$(e.carKeyFieldId),f=null;if(h.length>0){f=h[0];}d.value=e.initiallySelectedCarKey;this.applyListeners=function(){var m=$$(".roomShopping_v1").size()>0;var l=$$(".clear-selection-key").first();var k=$$(".choose-different-car-form").first();var j=$$(".avail_footer .choose-different-car").first();if(g.size()>0&&!m){g.each(function(n){Event.observe(n,"click",function(p){Event.stop(p);var r=Event.findElement(p,e.linkSelector);var o=r.up(".carOption"),q=r.previous(".car-key");if(q){d.value=q.value;}else{d.value="car_cross_sell_declined";}i(d.value);if(k){l.value=q.value;j.href="/travel/arc_process.cfm?"+k.serialize();}if(f){f.removeClassName(e.selectedCarOptionClass);}o.addClassName(e.selectedCarOptionClass);f=o;});});}function i(p){var n=$$('form[name="arc_availability"]').first();if(n!=null){var o=n.elements.carKey;if(o!=null){o.setAttribute("value",p);}}}};this.initialize=function(){if(e.initiallySelectedCarKey!==""){var i=$$(".car-key");i.each(function(k){if(k.value===e.initiallySelectedCarKey){var j=k.up(".carOption");j.addClassName(e.selectedCarOptionClass);f=j;}});d.value=e.initiallySelectedCarKey;}};};b.createUIComponent("carCrossSellSelectionHandler",{initialize:function(c){return new a(c);},applyListeners:function(c){c.applyListeners();}});})(EzRez.Application);(function(a){var b=function(g){var j=Object.extend({divClass:".carShopping",selectedCarOptionClass:"selectedCarOption",cardLinkClass:".card_link",selectButtonClass:"selectLink",unselectButtonClass:"selectedCarLink",carKeyFieldId:"carKey",submitButtonClass:"addCarSubmitButton",initiallySelectedCarKey:"",selectedCars:{},currentActiveFilters:null},g);var h=$(j.carKeyFieldId);var e=$$("."+j.submitButtonClass).first();this.reloadListeners=function(m){this.applyListeners();j.currentActiveFilters=m;i();};this.applyListeners=function(){var n=$$(j.cardLinkClass+" button");var m=this;if(n.size()>0){n.invoke("observe","click",function(o){Event.stop(o);var p=o.target;if(p.nodeName!=="BUTTON"){p=o.target.up("button");}l(p);});}};function i(){var m=j.selectedCars;Object.keys(m).forEach(function(n){var o=$$(".car-key-hidden-helper[value="+n+"]").first();var p=k(m[n]);if(o&&!o.up(".carOption").hasClassName("selectedCarOption")&&p){l(o.next(".selectedCarLink"),true);}else{if(!p){d({value:n},false);}}});}function k(q){var p=j.currentActiveFilters;if(p){var o=parseInt(p.priceMaxValue[0],10);var n=parseInt(p.priceMinValue[0],10);var m=parseInt(q.total.replace(/,/g,""),10);return(m<o||!o)&&(m>n||!n)&&p.carClasses.indexOf(q.type)!==-1&&p.companies.indexOf(q.company)!==-1;}return true;}function l(q,n){var m=q.up(".carOption");var p=q.previous(".car-key");var o=q.classList.contains(j.selectButtonClass)||n;if(!j.isMultiCarSelectionOn){var r=$$(j.divClass+" ."+j.selectedCarOptionClass);r.forEach(function(s){s.removeClassName(j.selectedCarOptionClass);});j.selectedCars={};}d(p,o);if(o){m.addClassName(j.selectedCarOptionClass);}else{m.removeClassName(j.selectedCarOptionClass);}}function d(p,q){var n=j.selectedCars;var m=p.value;if(q){if(!n[m]){var o=p.readAttribute("data-car-company");var r=p.readAttribute("data-car-type");var s=p.readAttribute("data-car-total-price");n[m]={company:o,type:r,total:s};}}else{delete n[m];}f();}function f(){h.value=Object.keys(j.selectedCars).map(function(m){return m;}).join(",");c();}function c(){if(e){if(Object.keys(j.selectedCars).length===0){e.hide();}else{e.show();}}}this.initialize=function(){if(j.initiallySelectedCarKey!==""){var m=$$(".car-key");m.each(function(o){if(o.value===j.initiallySelectedCarKey){var n=o.up(".carOption");n.addClassName(j.selectedCarOptionClass);_selectedItem=n;}});}};};a.createUIComponent("carSelectButtonHandler",{initialize:function(c){return new b(c);},applyListeners:function(c){c.applyListeners();}});})(EzRez.Application);(function(a){var b=function(d){var e=f(d);function f(g){return $H({followerElementAnimate:true,followersConfigs:[]}).merge(g).toObject();}function c(h,g){var i=$H({follower:{},topBoundaryElement:{},bottomBoundaryElement:{},boundaryOffsetThreshold:10}).merge(h).toObject();var s=i.follower.getDimensions().height+i.boundaryOffsetThreshold,k=document.viewport.getScrollOffsets().top,n=i.follower.cumulativeOffset().top+s,t=i.topBoundaryElement.cumulativeOffset().top-i.boundaryOffsetThreshold,o=i.bottomBoundaryElement.cumulativeOffset().top;var j=n<o;var r=k>t;var q=(k-t);if(q<0){q=0;}else{var p=q+t+s>=o;if(p){q=o-s-t;if(q<0){q=0;}}}var l=i.follower.getStyle("top")||"0px";var m=l.replace("px","")>q;if((r&&j)||(m)){i.follower.setStyle({top:q+"px",position:"absolute"});if(g){i.follower.addClassName("followerElementAnimate");}}}this.initFollowersConfigs=function(g){e=f(g);};this.adjust=function(){for(var g=0;g<e.followersConfigs.length;g++){c(e.followersConfigs[g],e.followerElementAnimate);}};this.applyListeners=function(){Event.observe(window,"scroll",this.adjust);};};a.createUIComponent("followMeComponent",{initialize:function(c){return new b(c);},applyListeners:function(c){c.applyListeners();}});})(EzRez.Application);(function(a){a.createUIComponent("showPrintableActivityDetailsComponent",(function(){var b=function(c){var f=$H({anchorSelector:"a.showPrintableActivityDetails"}).merge(c).toObject();var d=new EzRez.UI.LightBox({className:"printableActivityDetails",type:"iframe"});var e=function(g){Event.stop(g);var h=$(g.target);d.show(h);};this.applyListeners=function(){$$(f.anchorSelector).each(function(g){g.observe("click",e);});};this.removeListeners=function(){$$(f.anchorSelector).each(function(g){g.stopObserving("click",e);});};};return{initialize:function(c){return new b(c);},applyListeners:function(c){c.applyListeners();},removeListeners:function(c){c.removeListeners();},unload:function(c){c.unload();}};})());})(EzRez.Application);(function(a){a.createUIComponent("showBrandedFaresComponent",(function(){var b=function(c){var e=Object.extend({brandedFaresSelector:"div.branded-fares-container",brandedFaresButton:".branded-fares-button"},c);this.updateListeners=function(){this.removeListeners();this.applyListeners();};var d=function(f){Event.stop(f);var g=$(Event.element(f)).up(".optionBody").select(e.brandedFaresSelector);g.forEach(function(h){if(h.visible()){h.hide();}else{h.show();}});};this.applyListeners=function(){$$(e.brandedFaresButton).each(function(f){f.observe("click",d);});};this.removeListeners=function(){$$(e.brandedFaresButton).each(function(f){f.stopObserving("click",d);});};this.unload=function(){this.removeListeners();};};return{initialize:function(c){return new b(c);},applyListeners:function(c){c.applyListeners();},removeListeners:function(c){c.removeListeners();},unload:function(c){c.unload();}};})());})(EzRez.Application);(function(a){a.createUIComponent("showFareRulesComponent",(function(){var b=function(f){var g=$H({anchorSelector:"a.showFareRulesInfo",url:"/travel/fare_basis_for_leg.cfm"}).merge(f).toObject();var d=new EzRez.UI.Dialog({name:"showFareRulesDialog",position:"center"});var j=new EzRez.UI.DOMCache({rootNode:"#showFareRulesDialog",nodes:{container:function(l){return l.down(".container");},resultsContainer:function(l){return l.down(".body");},headerContainer:function(l){return l.down(".header");},waitingDialog:function(l){return $$("#waiting_dialog").first();}}});this.updateListeners=function(){this.removeListeners();this.applyListeners();};this.moveContainerToTop=function(){j.waitingDialog.getOffsetParent().insert(j.rootNode);};var h=function(l){Event.stop(l);var m=$(l.target).id,n={airPnrKey:m};a.use("waitingDialog").show();new Ajax.Request(g.url,{method:"post",parameters:n,evalJS:true,onSuccess:function(p){var o=p.responseText.evalJSON();if(o.success){k(o.html);}else{e(o.errorMessage);}},onFailure:function(o){e("HTTP failure");},onException:function(p,o){e("",o);}});};function e(m,l){a.use("waitingDialog").hide();new EzRez.Util.Exception({message:"showFareRulesComponent:"+m},l);}function k(m){var l=new Element("div",{"class":"showFareRulesComponentPopUp"});l.insert(m);a.use("waitingDialog").hide();j.resultsContainer.update(l);d.show();}function i(){j.resultsContainer.update("");d.hide();}var c=function(n){var m=$(n.target);function l(){return m.hasClassName("cancel-button")||m.hasClassName("close_button");}if(l()){i();Event.stop(n);}};this.applyListeners=function(){$$(g.anchorSelector).each(function(l){l.observe("click",h);});j.container.observe("click",c);};this.removeListeners=function(){$$(g.anchorSelector).each(function(l){l.stopObserving("click",h);});j.container.stopObserving("click",c);};this.unload=function(){_removeListeners();};if(!j.cache()){new EzRez.Util.Exception({message:"Missing elements in showFareRulesComponent: "+j.getInvalidNodes().join(", ")});return;}};return{initialize:function(c){var d=new b(c);d.moveContainerToTop();return d;},applyListeners:function(c){c.applyListeners();},removeListeners:function(c){c.removeListeners();},unload:function(c){c.unload();}};})());})(EzRez.Application);(function(a){var b=function(c){function d(){$$(".promotion-message-before-checkout-container").forEach(function(g){g.removeClassName("hidden-by-css");});}function e(){$$(".promotion-message-before-checkout-container").forEach(function(g){g.addClassName("hidden-by-css");});}function f(){var g=$("promotion_message").value;if(g){d();}else{e();}}this.applyListeners=function(){EzRez.Util.Event.pubsub.subscribe("updatingFlightSummaryDetailsComponentAfterChangeLeg",f);EzRez.Util.Event.pubsub.subscribe("updatingFlightSummaryDetailsComponentAfterSort",f);};if(c.message){d();}$(document.body).on("click",".promotion-message-before-checkout-close-button",function(h,g){$(g).up().addClassName("hidden-by-css");});};a.createUIComponent("airMixAndMatchFlightInformationComponent",{initialize:function(c){return new b(c);},applyListeners:function(c){c.applyListeners();}});})(EzRez.Application);(function(a){var b=function(){var e;function j(){return $$("input:checked[type=radio][name=loyalty_pricing]")[0].value;}function c(m){return a.WebContext.fileName===m;}function g(){return a.Availability.products.hasAir||a.Booking.numAirOptions>0;}function k(){return a.Availability.products.hasCar||a.Booking.numCars>0;}function f(){return a.Availability.numActivities||c("arc_process.cfm");}function l(){return g()||k()||f();}function d(n){var m="/apps/shopping/setLoyaltyRuleGroup?ruleGroupName="+n+"&CSRF_TOKEN="+a.WebContext.csrfToken;new Ajax.Request(m,{onCreate:function(){a.use("waitingDialog").show();},onComplete:function(){if(c("itinerary.cfm")){location.reload();}else{if(a.Availability.products.hasRoom||a.Booking.numRooms>0){if($$(".select-hotel-key").length>0){location.reload();}else{if(a.use("hotelUpdater")){a.use("hotelUpdater").update();}else{location.reload();}}}else{if(l()){location.reload();}}}},onFailure:function(){a.use("waitingDialog").hide();},method:"post"});}function i(){var m=$$("input:checked[type=radio][name=loyalty_pricing]")[0].value;if(m===e){return;}e=m;if(c("arc_process.cfm")||c("itinerary.cfm")||c("checkout_form.cfm")){d(m);}}function h(){if($$("#loyalty_pricing_options").size()!==0){e=j();j();}}this.applyListeners=function(){if($$("#loyalty_pricing_options").size()!==0){$$("#loyalty_pricing_options input").each(function(m){m.observe("click",i);});}};h();};a.createUIComponent("loyaltyPricingOptionSelectComponent",{initialize:function(){return new b();},applyListeners:function(c){c.applyListeners();}});})(EzRez.Application);(function(a){var b=function(k){var n=Object.extend({translations:{CO_WAITING_MESSAGE:""},},k);var h=a.WebContext.fileName,j=h==="bookings_view.cfm",l=h==="checkout_final.cfm",i=$$(".confirmationPageBaggageInfo"),e=$$(".bookingViewBaggageInfo");function d(q,s){for(var r=0;r<q.length;r++){if(q[r]&&s){q[r].show();}}}d(i,l);d(e,j);var o=function(q){var r=n.translations[q];if(!r){return q;}return r;};var m=new EzRez.UI.Dialog({name:"waiting_dialog",headerContent:o("CO_WAITING_MESSAGE"),bodyContent:"",position:"center"});function p(){var q=$$("#contentContainer").first();if(q!==undefined&&q.select(".flyoutOpenPopUpLink")){return $$("#contentContainer")[0];}}var g=function(q){var u=p()||$$("#select")[0]||$$("#confirm")[0]||$$("#checkout")[0]||$$("#payment")[0]||$$("#itinerary")[0],v=q.target,x=v.up(".segmentRight")||v.up(".airLeg")||v.up(".baggage")||v.up(".baggageFeeInfo")||v.up(".segment")||v.up(".submodule"),w=v.hasClassName("flyoutOpenPopUpLink")||v.up(".flyoutOpenPopUpLink"),t=u.getElementsByClassName("flyoutShow"),r;if(x){r=x.down(".flyoutHide");}if(t&&t.length>0){t[0].removeClassName("flyoutShow");}if(r&&r.hasClassName("ajaxBaggageFlyOut")&&v&&v.hasClassName("baggageLinkText")){f();var s=r.down(".current_leg").value;var y=r.down(".airPnrKey").value;c(s,y,r);}if(w&&r){r.addClassName("flyoutShow");}else{if(v.hasClassName("flyoutClose")){v.up(".flyoutText").removeClassName("flyoutShow");}else{if(r&&r.hasClassName("travelFusionSpecial")&&v&&v.hasClassName("baggageLinkText")){r.addClassName("flyoutShow");}}}};function f(){m.show();}function c(t,s,q){var r;new Ajax.Request("/travel/baggage_info_ajax.cfm?leg_index="+t+"&airPnrKey="+s,{method:"get",onSuccess:function(u){r=u.responseText.evalJSON();},onFailure:function(){r=null;},onException:function(v,u){throw u;},onComplete:function(){m.hide();q.removeClassName("ajaxBaggageFlyOut");q.down(".flyoutBaggageText").insert(r.baggageInfo);q.addClassName("flyoutShow");q.addClassName("travelFusionSpecial");}});}this.applyListeners=function(){var q=p()||$$("#select")[0]||$$("#confirm")[0]||$$("#checkout")[0]||$$("#payment")[0]||$$("#itinerary")[0];if(q){q.observe("click",g);}};};a.createUIComponent("baggageInformationPopup",{initialize:function(c){return new b(c);},applyListeners:function(c){c.applyListeners();}});})(EzRez.Application);