(function(b){var a=function(){var c=EzRez.UI.MapFactory.isCompatible();var f=null;var k=$("hotelLandingReviews");var h=$("hotelVirtualTour");var l=$("aboutHotel");var u=$("hotelPromotion");var q=$("hotelAmenities");var g=$("roomAmenities");var w=new YAHOO.widget.TabView("hotelLandingTabbedView");w.addListener("activeTabChange",r);var t=location.href.toQueryParams();var o=$("hotelLandingMapCanvas");var i=t.map_only;if(i){o=$("hotelMapOnlyCanvas");}function r(x){var z=x.newValue;var y=z.get("contentEl");n(Element.identify(y));}function n(x){if(x==="hotelReviews"){if(o){Element.hide(o);}if(u){Element.hide(u);}if(g){Element.hide(g);}if(q){Element.hide(q);}if($("userReviews")===null){s();}else{k.show();}}else{if(x==="hotelMap"){e();if(!c){d();j();return;}Element.show(o);if(k){Element.hide(k);}if(u){Element.hide(u);}if(g){Element.hide(g);}if(q){Element.hide(q);}if(f){f.fixCenter(true);}}else{if(x==="hotelVirtualTour"){if(o){Element.hide(o);}if(k){Element.hide(k);}if(u){Element.hide(u);}if(g){Element.hide(g);}if(q){Element.hide(q);}Element.show(h);}else{if(x==="hotelPromotion"){if(q){Element.hide(q);}if(g){Element.hide(g);}if(o){Element.hide(o);}Element.show(u);}else{if(x==="hotelAmenities"){if(u){Element.hide(u);}if(g){Element.hide(g);}if(o){Element.hide(o);}if(q){Element.show(q);}}else{if(x==="roomAmenities"){if(u){Element.hide(u);}if(q){Element.hide(q);}if(o){Element.hide(o);}Element.show(g);}else{if(o){Element.hide(o);}if(k){Element.hide(k);}Element.show(l);}}}}}}}function d(){if(o){Element.hide(o);}$$("#hotelLandingTabbedView .yui-nav li.hotelMapTab").invoke("hide");}function e(){if(o){f=EzRez.UI.MapFactory.createMap({canvas_id:o.identify(),info_id:"hotelMap",default_zoom:15,setup:function(z){var y=z.getDefaultUI();y.zoom.scrollwheel=false;z.setUI(y);z.enableContinuousZoom();},geocodeComplete:function x(y,z){if(y.length===0){d();n("aboutHotel");w.selectTab(0);}}});Event.observe(document,"unload",EzRez.UI.MapFactory.unload);Event.observe(window,"unload",EzRez.UI.MapFactory.unload);}if(!c){d();}}function p(){if(top!==self){return;}var x=window.location.href.toQueryParams();if(x.show_terms_and_search==="false"){return;}$$(".hotelSearchBox, .termsAndConditions").invoke("setStyle",{display:"block"});}function j(){if(l){n("aboutHotel");}else{if(u){n("hotelPromotion");}else{n("hotelAmenities");}}}function m(){var y={hotelVirtualTour:function(){n("hotelVirtualTour");},hotelMap:function(){if(c){n("hotelMap");}else{n("aboutHotel");}},hotelReviews:function(){n("hotelReviews");},defaultTab:j};var x=y[t.view];if(x){x();}else{y.defaultTab();}}var s=function(x){var z=b.use("waitingDialog");z.show();var y=location.href.toQueryParams();y.show_partial=true;new Ajax.Updater(k,"/service/show_hotel_reviews.cfm",{parameters:y,onComplete:function(){b.load("hotelReviews");k.show();}});z.hide();};function v(){var x=t.map_only;if(x){e();Element.show(o);}else{p();m();}}v();};b.createUIComponent("hotelDetails",{initialize:function(){return new a();}});})(EzRez.Application);(function(a){EzRez.UI.HotelCardComponent=function(b){this.applyListeners=function(){if(b.shouldScrollToReviews){var c=$$(".tripAdvisorSummaryLink").first();if(c){c.observe("click",function(d){Event.stop(d);Effect.ScrollTo("userReviews");$("userReviews").focus();});}}};};a.createUIComponent("hotelCardComponent",{initialize:function(b){return new EzRez.UI.HotelCardComponent(b);},applyListeners:function(b){b.applyListeners();}});})(EzRez.Application);(function(b){var a=function(){var f=$$(".toggle a");var k=$$(".expand-reviews-section a");var h=function(o){var q={};var p=Element.up(o,".reviewOption");var r=Element.select(p,".summary");var n=Element.select(p,".full");if(r.length>0){q.summary=r[0];}if(n.length>0){q.full=n[0];}return q;};var j=function(n){var o=h(n);if(o.summary&&o.full){o.summary.hide();o.full.show();l(n,"expandTranslation","contractTranslation");d(n,"expandReview","contractReview");}};var i=function(n){var o=h(n);if(o.summary&&o.full){o.summary.show();o.full.hide();l(n,"contractTranslation","expandTranslation");d(n,"contractReview","expandReview");}};var l=function(o,q,p){var n=o.down("span."+q);var r=o.down("span."+p);n.hide();r.show();};var d=function(n,p,o){n.removeClassName(p);n.addClassName(o);};var c=function(n){if(n!=null&&n.hasClassName("expandReview")){j(n);}else{if(n!=null&&n.hasClassName("contractReview")){i(n);}}};var e=function(n){var o=Event.element(n);if(o.hasClassName("expandReview")){j(o);}else{if(o.hasClassName("contractReview")){i(o);}}};var m=function(o){Event.stop(o);var n=Event.element(o).up("a");c(n);};var g=function(q){Event.stop(q);var r=Event.element(q);var p=r.up("a");var n=r.select(".contract-translation")[0];var o=r.select(".expand-translation")[0];if(p!=null&&p.hasClassName("expandReviews")){f.each(function(s){j(s);});r.next(".contract-translation").show();p.removeClassName("expandReviews");p.addClassName("collapseReviews");r.hide();}else{if(r.hasClassName("expandReviews")){f.each(function(s){j(s);});n.show();r.removeClassName("expandReviews");r.addClassName("collapseReviews");o.hide();}else{if(p!=null&&p.hasClassName("collapseReviews")){f.each(function(s){i(s);});r.previous(".expand-translation").show();p.removeClassName("collapseReviews");p.addClassName("expandReviews");r.hide();}else{if(r.hasClassName("collapseReviews")){f.each(function(s){i(s);});o.show();r.removeClassName("collapseReviews");r.addClassName("expandReviews");n.hide();}}}}};this.applyListeners=function(){if(f.length>0){f.each(function(n){Event.observe(n,"click",m);Event.observe(n,"click",e);});}if(k.length>0){k.each(function(n){Event.observe(n,"click",g);});}};};b.createUIComponent("hotelReviews",{initialize:function(){return new a();},applyListeners:function(c){c.applyListeners();}});})(EzRez.Application);(function(b){var a=function(g){var j=Object.extend({searchLocation:new EzRez.WebApi.GeoLocation(),isRoomSelection:false,isLandingPage:false},g);var l;var h;var k;function f(){var n=$$(".hotelMiniMap").first();var m={hotelMiniMapImages:function(){return n.down(".hotelMiniMapImages");},hotelMiniMapImageLink:function(){return n.down(".hotelMiniMapImageLink");}};if(!j.isRoomSelection&&!j.isLandingPage){m.searchLocationName=function(){return n.down(".hotelMiniMapLocation .searchLocationName");};m.hotelMiniMapLink=function(){return n.down(".hotelMiniMapLink");};}l={rootNode:n,nodes:m};}function d(m){Event.stop(m);if(j.isRoomSelection||j.isLandingPage){var n=$(m.target);if(n.nodeName.strip().toLowerCase()!=="a"){n=n.up("a");}n.onclick=null;b.use("lightBoxForRoomSelectionHotelDetailsMap").show(n);}else{var o=b.use("hotelResultsTabs");k=b.use("hotelsMapWaiting");k.show();o.showTab("hotels_map_view");e();}}function e(){h=setInterval(function(){var m=b.use("hotelsMap").getMap();if(!m){return;}clearInterval(h);m.fixCenter(true,function(){k.hide();});},200);}function c(n){if(!n){return;}var m=l.nodes.hotelMiniMapImageLink().getDimensions();if(m.width>0&&m.height>0){var o=EzRez.UI.MapFactory.createStaticMap({width:m.width,height:m.height,center:n,zoom:11});l.nodes.hotelMiniMapImageLink().update(o.createImage());}if(!j.isRoomSelection&&!j.isLandingPage&&l.nodes.searchLocationName()){l.nodes.searchLocationName().update(n.formattedAddress);}}function i(){f();c(j.searchLocation);}this.createStaticMap=c;this.applyListeners=function(){l.rootNode.on("click",".hotelMiniMapImages,.hotelMiniMapLink",d);};i();};b.createUIComponent("hotelMiniMap",{initialize:function(c){return new a(c);},applyListeners:function(c){c.applyListeners();}});})(EzRez.Application);(function(a){var b=function(d){var f=Object.extend({changeRoomSelectionNodes:""},d);var c=$$(".hotel-change-room-component.summary-header").first();function e(g){var h=g.target.href.split("#")[1];var i=$(h).down(".change-room-selection.open");EzRez.Util.Event.simulate(i,"click");}this.applyListeners=function(){if(c){c.on("click",".change-room-segment",function(g){e(g);});}};};a.createUIComponent("roomSelectionHotelDetailsChangeRoomComponent",{initialize:function(c){return new b(c);},applyListeners:function(c){c.applyListeners();}});})(EzRez.Application);var EzRez=EzRez||{};EzRez.UI=EzRez.UI||{};EzRez.Application=EzRez.Application||{};(function(b){var a=function(d){var c=Object.extend({componentId:{keyString:""}},d);this.componentId=c.componentId;this.specialRequests=c.specialRequests;this.restore=c.isRestore;};EzRez.UI.RoomSelectionHotelDetailsBaseComponent=function(p,t,l){if(!t||!l){return;}var q=Object.extend({hotelKey:"",roomKey:"",choiceListKey:"",changeRoomNodes:"",custId:"",password:"",hasSelectedCar:false,updateRoomTypeRedirectUrl:"/adm/modify/modify_booking.cfm",updateRoomTypeSubmitUrl:"/adm/modify/modification_workspace_ajax.cfm",translations:{air:"Air",room:"Room",car:"Car",availabilityTotal:" Total package price"}},p);var j=this,r,g=t(".total-with-points-allocation-detail-container")[0],e=false;var n=null,k=null,I=null,H=null,A;var h=EzRez.Application.use("waitingDialog");function E(K){if(g){g.update(K);}}function i(L){var K=[];if(L.hasAir){K.push(q.translations.air);}K.push(q.translations.room);if(L.hasCar||q.hasSelectedCar){K.push(q.translations.car);}return K.join(", ")+" "+q.translations.availabilityTotal;}function m(L){var M=t(".table_itinerary_total").first();if(M){var K=M.down(".label");if(K){K.update(L);}}}function C(Q){var P=t(".packagePriceTotal").first(),O=Q.priceUpdateResponse,L="Update Failure.";if(P){P.update(O.totalPrice);m(Q.responseStatus?i(O):L);}else{var K=t(q.changeRoomNodes);for(var M=0,N=K.length;M<N;M++){if(K[M].down(".avg-multi-room-price")){K[M].down(".avg-multi-room-price").update(Q?O.avgPrice:L);}if(K[M].down(".total-multi-room-price")){K[M].down(".total-multi-room-price").update(Q?O.totalPrice:L);}}}document.fire("switchfly:priceUpdate");}function z(){var M=l("back-top");var K=t(".back-to-top-text a").first();var N=t(".tripAdvisor a").first();var L=t(".hotel-change-room-component a").first();if(M){M.hide();M.observe("click",function(){Effect.ScrollTo("select");});Event.observe(window,"scroll",function(){if(window.scrollY>400){Effect.Appear("back-top");}else{Effect.Fade("back-top");}});window.setInterval(function(){if(window.scrollY>400&&M.getStyle("display")==="none"){Effect.Appear("back-top");}},100);}if(K){K.observe("click",function(){Effect.ScrollTo("select");});}if(N){N.observe("click",function(){Effect.ScrollTo("userReviews");});}if(L){L.observe("click",function(){Effect.ScrollTo("room-details-tab");});}}function d(K){var L=l(K.target);if(L.hasClassName("update-room-type")||L.hasClassName("add-a-car.automation-continueToCarsPage")){return L;}if(!L.hasClassName("checkoutButton")&&!L.hasClassName("choose-different-car")){var N=L.up(".checkoutButton");var M=L.up(".choose-different-car");L=N?N:M;}return L;}function x(){clearTimeout(H);clearTimeout(k);}function B(){var K=t(".no-room-selected-warning-clone").first();if(K){x();Effect.Fade(K,{duration:0.25});}}function u(){k=setTimeout(function(){B();},5000);}function o(){A=l(document.body).getHeight();H=setInterval(function(){var K=l(document.body).getHeight();if(A!==K){n.setStyle({display:"none"});B();}},100);}function F(S){var M=t(".no-room-selected-warning").first();n=t(".no-room-selected-warning-clone").first();if(M&&!n){n=Element.clone(M,true).addClassName("no-room-selected-warning-clone");l(document.body).insert({bottom:n});}if(n){var R=d(S);if(R){var N=R.cumulativeOffset();var K=R.getWidth();var Q=R.getHeight();var P=n.getWidth();var O=N.top+Q+15;var L=N.left-(P-K);n.setStyle({top:O+"px",left:L+"px"});if(n.visible()){x();n.setStyle({display:"none"});}Effect.Appear(n,{duration:0.5});u();o();}}}function v(){var K=t(".hotel-was-last-booked-box").first();if(K){Effect.Fade(K,{duration:0.25});}}function D(){I=setTimeout(function(){v();},9000);}function c(){var K=t(".hotel-was-last-booked-box").first();if(K){if(K.visible()){K.setStyle({display:"none"});}Effect.Appear(K,{duration:0.5});D();o();}}function y(){I=setTimeout(function(){c();},4000);}function f(){var K=t(".room-drawer");if(K!==undefined&&K.length>0){return K[0].select(".room-types-fieldset").length===t(".room-types-fieldset .tab-room-selected").length;}return t(".room-types-fieldset").length===t(".room-types-fieldset .tab-room-selected").length;}function s(){var K=b.use("searchFilterSettingsComponent");if(K){K.removeHotelSearchFilterSettings();}}this.updateHotelChangeRoomComponent=function(L){var K=t(q.changeRoomNodes);for(var M=0,N=K.length;M<N;M++){if(K[M].down(".room-name"+L.roomIndex)){K[M].down(".room-name"+L.roomIndex).update(L.roomName);}if(K[M].down(".avg-room-price"+L.roomIndex)){K[M].down(".avg-room-price"+L.roomIndex).update(L.avgRoomPrice);}if(K[M].down(".total-room-price"+L.roomIndex)){K[M].down(".total-room-price"+L.roomIndex).update(L.totalRoomPrice);}}};this.applyListeners=function(){EzRez.Util.Event.pubsub.subscribe("hotelDetail/updateRoomComponent",function(K){j.updateHotelChangeRoomComponent(K);});EzRez.Util.Event.pubsub.subscribe("hotelChangeRoom/updateRoomTotalWithPointsAllocationTier",function(K){var L=K.responseStatus?K.priceHtml:"Update failed";E(L);});EzRez.Util.Event.pubsub.subscribe("hotelChangeRoom/updatePrices",function(K){C(K);});EzRez.Util.Event.pubsub.subscribe("hotelChangeRoom/hideNoRoomSelectedWarning",function(){B();});l(document.body).on("click",function(K){if(!d(K)){B();}});l(document.body).on("click",".choose-different-car",function(K){if(!f()){F(K);Event.stop(K);}});t(".checkoutButton").invoke("observe","click",function(K){j.submitFormToSetRoomSelection(K,true);Event.stop(K);});t(".add-a-car").invoke("observe","click",function(K){j.submitFormToSetRoomSelection(K,false);Event.stop(K);});t(".continueButton").invoke("observe","click",function(K){j.submitRoomTypeFormToSetRoomSelection(K);Event.stop(K);});z();};function G(){return t(".select-hotel-key")[0].value;}this.submitFormToSetRoomSelection=function(R,K){if(f()){if(!e){e=true;var M=t(".checkoutButton").first();if(M){M.addClassName("no-room-selected");}var O=l("hotel-selection-form");var Q=t('form[name="arc_availability"]').first();var L=t(".room-drawer").length>0;if(Q&&!K){s();if(L){Q.hotelKey.value=G();}Q.submit();}else{if(O||(Q&&K)){var P=t(".select-room-segment-key")[0].value,S=t(".select-hotel-key")[0].value===""?q.hotelKey:t(".select-hotel-key")[0].value;var N=t('form[name="room_checkout_form"]').first();s();if(K&&N){if(L){N.hotelKey.value=G();}N.submit();}else{O.action="/travel/arc_process.cfm?hotelKey="+S+"&roomKey="+P+"&choiceListKey="+q.choiceListKey+"&recalc_upsell_room_package=false";O.submit();}}}}}else{F(R);}};function w(K){window.alert(K);}var J=function(){EzRez.UI.redirect({url:q.updateRoomTypeRedirectUrl,method:"get",parameters:{custId:q.custId,password:q.password}});};this.submitRoomTypeFormToSetRoomSelection=function(K){if(f()){h.show();var M=l("hotel-selection-update-room-type-form");var L=new a({specialRequests:M.specialRequests,componentId:{keyString:M.component_key.value},isRestore:false});var N={component_key:M.component_key.value,action:M.action.value,hotel_key:M.hotelKey.value,room_key:M.roomKey.value,modificationElementsJson:Object.toJSON(L)};EzRez.Application.SysConf.resetSessionExpiration();new Ajax.Request(q.updateRoomTypeSubmitUrl,{method:"post",parameters:N,evalJS:true,onSuccess:function(P){var O=new EzRez.WebApi.FormProcessorResponse(P.responseText.evalJSON());if(O.success){J();h.hide();}else{w(O.errorMessage);h.hide();}},onFailure:function(P,O){w(O);h.hide();}});}else{F(K);}};this.initialize=function(){r=t(q.changeRoomNodes);y();};};b.createUIComponent("roomSelectionHotelDetailsBaseComponent",{initialize:function(c){var d=new EzRez.UI.RoomSelectionHotelDetailsBaseComponent(c,$$,$);d.initialize();return d;},applyListeners:function(c){c.applyListeners();}});})(EzRez.Application);(function(b){var a=function(j){var m=Object.extend({rootNode:"",changeRoomNodes:"",isMultiRoomHotel:false},j);var i,q,n,d,e,p,r=$$(".tabbedFooter .hotel-change-room-component")[0];function k(t,u){new Ajax.Request(t,{onSuccess:function(w){var v=new EzRez.WebApi.FormProcessorHtmlResponse(w.responseText.evalJSON());if(v.success){o(u,v.html);}else{o(u,"Update failure. Please retry.");}}});}function f(v){for(var u=0,w=n.length;u<w;u++){var t=n[u];if(v===n[u].className){t.addClassName("activeTab");}else{t.removeClassName("activeTab");}}}function s(t){if(!m.isMultiRoomHotel){if(r){if(t==="room-details-tab"){r.addClassName("hidden");}else{r.removeClassName("hidden");}}}}function g(){if($$(".tab-room-info").size()==1){$$(".change-room").each(function(t){t.addClassName("hidden");});}else{$$(".change-room").each(function(t){t.removeClassName("hidden");});}}function o(v,u){var t=new Element("div",{"class":v});i.appendChild(t);t.update(u);}function h(){i.childElements().each(function(t){t.hide();});}function c(t){var u=t.id+"-content";if(!t.hasClassName("activeTab")){h();if(i.down("."+u)!==undefined){i.down("."+u).show();}else{k(t.href,u);}f(t.className);}s(t.id);}function l(){var t=$$(".tabButtonRooms_Details").first();EzRez.Util.Event.simulate(t,"click");}this.applyListeners=function(){q.on("click","a",function(t){c(t.target);Event.stop(t);});e.each(function(t){t.on("click","a.change-room",function(){l();});t.on("click","a.change-room-segment",function(){l();});});};this.initialize=function(){i=$$(".tabbedSection .body").first();q=$$(m.rootNode).first();n=q.childElements();d=$$(".activeTab").first();e=$$(m.changeRoomNodes);p=$$(".hotelRoomSelection").first();s(d.id);g();};};b.createUIComponent("roomSelectionHotelDetailsTabComponent",{initialize:function(c){var d=new a(c);d.initialize();return d;},applyListeners:function(c){c.applyListeners();}});})(EzRez.Application);(function(b){var a=function(k){var aa=Object.extend({choiceListKey:"",selectedRoomIndexes:[],isForModify:false,isMultiRoomHotel:false,hasRoomTypeFilter:false,roomDescriptionCharLimit:1000,numberOfInitialRoomTypes:5,translations:{openRoomDescription:"Learn more",closeRoomDescription:"Close details",openRoomDetails:"See more",closeRoomDetails:"See less"}},k);var m=this;var q=$$(".hotel-details-container").first();if(!q){q=$$(".room-selection-hotel-details-room-component").first();}var F=$$(".hotel-change-room-component");var c=$$(".total-with-points-allocation-detail-container");var H=$$(".hotel-details-container").length>0;var z=$$(".packagePriceTotal").first();var T=new YAHOO.widget.Tooltip("request-only-tooltip");var D=$$(".room-drawer").length>0;function W(ac){return ac.offsetWidth>0&&ac.offsetHeight>0;}function d(){if(H&&q){var ag=$$(".info-column-1");if(ag.first()){var ad=785;var ae=q.getWidth();var af=ag.first().getWidth();var ac=af-(ad-ae);ag.invoke("setStyle",{width:ac+"px"});}}}function L(){var ac=$$(".select-room-segment-key");ac.each(function(ad){ad.value=I();});}function P(ad){Event.stop(ad);var ac=$(ad.target),ae=ac.up(".room-types-fieldset"),af=ae.select(".show-room");ae.removeClassName("show-all-room-types");af.invoke("addClassName","hide-room");af.invoke("removeClassName","show-room");}function K(ae){var aj=ae.down(".room-name");var ag=ae.down(".room-price .avg-room-price");var ac=ae.down(".room-price .total-room-price");var ad=aj?aj.innerHTML:"";var ai=ag?ag.innerHTML:"";var af=ac?ac.innerHTML:"";var ah=aa.isMultiRoomHotel?ae.up("form").previousSiblings().size():0;EzRez.Util.Event.pubsub.publish("hotelDetail/updateRoomComponent",[{roomName:ad,avgRoomPrice:ai,roomIndex:ah,totalRoomPrice:af}]);}function I(){return $$(".room-segment-object-key:checked").map(function(ac){return ac.value;});}function p(ad){var ac=$(ad.target);ac=ac.up(".tab-room-info").down(".room-segment-object-key");return ac.value;}function j(){var ac=null;var ae=$$(".select-hotel-key");var ad=$$("form[name='arc_availability']");if(ae.length){ac=$$(".select-hotel-key").first().value;}else{if(ad.length){ac=ad.first().down("input[name='hotelKey']").value;}}return ac;}function O(ad){var ac="";if(ad.up("#carCrossSell")){var ae;if(ad.hasClassName("selectLink")){ae=ad;}else{ae=ad.up("a");}if(ae&&ae.previous(".car-key")){ac=ae.previous(".car-key").value;}}return ac;}function X(){var ac=j();if(ac){var ad={hotelKey:ac||"",roomKeyList:I()};new Ajax.Request("/travel/total_room_price_with_points_allocation_tier.cfm",{parameters:ad,onSuccess:function(af){var ae=new EzRez.WebApi.FormProcessorHtmlResponse(af.responseText.evalJSON());EzRez.Util.Event.pubsub.publish("hotelChangeRoom/updateRoomTotalWithPointsAllocationTier",[{responseStatus:ae.success,priceHtml:ae.html}]);},onFailure:function(){EzRez.Util.Event.pubsub.publish("hotelChangeRoom/updateRoomTotalWithPointsAllocationTier",[{responseStatus:false,priceHtml:""}]);}});}}function u(ad){var ae=j();var ac=O(ad.target);if(ae){var af={hotelKey:ae||"",carKey:ac||"",roomKeyList:I()};new Ajax.Request("/travel/total_room_car_price_with_points_allocation_tier.cfm",{parameters:af,onSuccess:function(ah){var ag=new EzRez.WebApi.FormProcessorHtmlResponse(ah.responseText.evalJSON());EzRez.Util.Event.pubsub.publish("hotelChangeRoom/updateRoomTotalWithPointsAllocationTier",[{responseStatus:ag.success,priceHtml:ag.html}]);},onFailure:function(){EzRez.Util.Event.pubsub.publish("hotelChangeRoom/updateRoomTotalWithPointsAllocationTier",[{responseStatus:false,priceHtml:""}]);}});}}function E(ad){var ae=j();var ac=O(ad.target);var af=I();if(ae&&af){var ag={hotelKey:ae||"",carKey:ac||"",roomKeyList:af};new Ajax.Request("/travel/ajax_price_update.cfm",{requestHeaders:{Accept:"application/json"},parameters:ag,onSuccess:function(ai){var ah=ai.responseJSON;if(ah.success){EzRez.Util.Event.pubsub.publish("hotelChangeRoom/updatePrices",[{responseStatus:ah.success,priceUpdateResponse:ah}]);}else{EzRez.Util.Event.pubsub.publish("hotelChangeRoom/updatePrices",[{responseStatus:ah.success,priceUpdateResponse:ah}]);}}});}}function w(ac){if($(ac.target).hasClassName("show-more")){g(ac);}else{v(ac);}}function g(ac){var ad=$(ac.target);ad.previous().down(".truncation-mark").addClassName("hidden");ad.previous().down(".truncated-text").removeClassName("hidden");ad.addClassName("show-less");ad.innerHTML=aa.translations.closeRoomDescription;ad.removeClassName("show-more");Event.stop(ac);}function v(ac){var ad=$(ac.target);ad.previous().down(".truncation-mark").removeClassName("hidden");ad.previous().down(".truncated-text").addClassName("hidden");ad.removeClassName("show-less");ad.innerHTML=aa.translations.openRoomDescription;ad.addClassName("show-more");Event.stop(ac);}function B(){N($$(".to-truncate-room-description"),aa.roomDescriptionCharLimit);}function N(ad,ac){if(ad){ad.each(function(ae){ae.innerHTML=EzRez.StringUtil.truncate(ae.innerHTML,ac);});}}function Z(ac,ad){var ae=[parseInt(ac.pageX,10)+10,parseInt(ac.pageY,10)+10];T.setBody(ac.target.up("."+ad).down(".tooltip-details").innerHTML);T.cfg.setProperty("xy",ae);T.show();}function n(){T.hide();}function e(ac){Z(ac,"on-request-tooltip");}function S(){if("&lt;\n&gt;".unescapeHTML()!=="<\n>"){String.prototype.unescapeHTML=function(){return this.stripTags().replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&amp;/g,"&");};}var ar=$$(".room-types-fieldset");for(var ao=0;ao<ar.length;ao++){var au=ar[ao].getElementsByClassName("tab-room-info");for(var an=0;an<au.length;an++){var ad=au[an];var ah=ad.down(".room-name");var at=ad.down(".room-type-details-container");var aq=ad.down(".promotions");var aj=false;var ag=false;var ae=false;if(ah){var av=ah.getHeight();A(ah);var ai=ah.getHeight();aj=av>ai;}if(at&&EzRez.StringUtil.trim(at.innerHTML.unescapeHTML()).length>0){at.addClassName("isCollapsable");var ac=at.getHeight();o(at);var af=at.getHeight();ag=ac>af;}if(at){var al=at.next(".show-details-link");if(al&&(aj||ag)){al.setStyle({display:"block"});}}if(aq){var ap=aq.down(".value").getHeight();i(aq);var am=aq.down(".value").getHeight();ae=ap!==am;var ak=aq.down(".show-details-link");if(ak&&ae){ak.setStyle({display:"block"});}}if(!D){if(an>=aa.numberOfInitialRoomTypes){ad.addClassName("hide-room");}}}}}function A(ac){ac.addClassName("include-truncation");}function U(ac){ac.removeClassName("include-truncation");}function o(ac){ac.addClassName("include-truncation");var ad=ac.down(".full-description");if(ad){ad.addClassName("include-truncation");}}function C(ac){ac.removeClassName("include-truncation");var ad=ac.down(".full-description");if(ad){ad.removeClassName("include-truncation");}}function i(ac){ac.down(".value").addClassName("include-truncation");ac.down("li").addClassName("include-truncation");}function x(ac){ac.down(".value").removeClassName("include-truncation");ac.down("li").removeClassName("include-truncation");}function l(ad){var af=$(ad.target);var ac=af.up(".tab-room-info");var ah=ac.select(".show-details-link a");var ag=ac.down(".room-name");var ae=ac.down(".room-type-details-container");var ai=ac.down(".promotions");if(ac.hasClassName("details-expanded")){ac.removeClassName("details-expanded");if(ag){A(ag);}if(ae&&ae.hasClassName("isCollapsable")){o(ae);}if(ai){i(ai);}ah.each(function(aj){Q(aj,aa.translations.openRoomDetails);});}else{if(ag){U(ag);}if(ae&&ae.hasClassName("isCollapsable")){C(ae);}if(ai){x(ai);}ac.addClassName("details-expanded");ah.each(function(aj){Q(aj,aa.translations.closeRoomDetails);});}Event.stop(ad);}function Q(ac,ad){ac.innerHTML=ad;}function y(){var ah=$$(".room-types-fieldset");for(var ad=0;ad<ah.length;ad++){var ai=0;var ag=parseInt(ah[ad].down(".room-count-hidden").value,10);var af=ah[ad].getElementsByClassName("tab-room-info");for(var ac=0;ac<af.length;ac++){if(af[ac].getStyle("display")==="block"){ai++;}}if(ag===ai){var ae=ah[ad].down(".change-room-selection");if(ae){ae.hide();}}}}function h(){var ag=".add-to-booking",af="room-drawer-btn",ae="no-room-selected",ad=$$(ag)[0];$$(".hotelOption .priceContainer")[0].addClassName("hide");Y();if(ad!==undefined){ad.addClassName(af);ad.addClassName(ae);}if(!aa.isMultiRoomHotel){$$("div.hotel-details-section-room-type").each(function(ah){ah.addClassName("expanded");});$$(".room-type-summary div.info-header").each(function(ah){ah.addClassName("hide");});$$(".room-type-summary div.price-info-header").each(function(ah){ah.addClassName("hide");});}V();var ac=$$(".room-drawer").length;if(ac===1){R();}}function Y(){$$(".room-drawer").each(function(ac){J(ac);});}function V(){var ac=$$(".room-drawer");ac.each(function(af){var ae=af.select("div.hotel-details-section-room-type").first();var ad=af.select(".room-type-summary .drawer-toggle").first();if(ae!==undefined){ae.addClassName("expanded");}if(ad!==undefined){ad.addClassName("expanded");}});}function R(){var ac=$$(".room-drawer").first();ac.down(".drawer-toggle").toggleClassName("expanded");ac.down(".room-selection-hotel-details-room-component").toggleClassName("expanded");}function s(ac){var ad=ac.up(".room-selection-hotel-details-room-component").down(".room-types-fieldset"),ag=ac.up(".room-selection-hotel-details-room-component").down(".js-show-additional-rooms"),ah=ad&&ad.select(".tab-room-info").findAll(function(ai){return !W(ai);}),af=ag?10:5,ae;if(ah.size()>0){ae=ah.splice(0,af);ae.invoke("addClassName","show-room");ae.invoke("removeClassName","hide-room");if(!ag||ah.size()<1){ad.addClassName("show-all-room-types");}}}function ab(){var ae=".add-to-booking";var ad="no-room-selected";var ac=$$(ae)[0];if(ac!==undefined){if(ac.hasClassName(ad)){ac.removeClassName(ad);}}}function t(ak){var ac=$(ak.target),af="expanded",ag=".room-selection-hotel-details-room-component",aj=".drawer-toggle",ae=ac.up(aj);if(ae!==undefined){ae=$(ak.target).up(aj);if(ae.down(".drawer-type-toggle")){var ai=ae.up(".room-drawer");if(ai!==undefined){if(EzRez.Application.shouldAllowMultipleOpenDrawers){ai.down(aj).toggleClassName(af);ai.down(ag).toggleClassName(af);}else{var ad=ai.readAttribute("data-provider");$$(".room-drawer").each(function(an){var am=an.readAttribute("data-provider");if(am===ad){an.down(aj).toggleClassName(af);an.down(ag).toggleClassName(af);}else{an.down(aj).removeClassName(af);an.down(ag).removeClassName(af);}});}}}if(ae.down(".room-type-toggle")){var ah=ae.up(".room-type-summary").readAttribute("data-room");ai=ae.up(ag);if(ai!==undefined){var al='div.hotel-details-section-room-type[data-room="'+ah+'"]';ae.toggleClassName(af);ai.down(al).toggleClassName(af);s(ac);}}Event.stop(ak);}}function f(af){var ac=$$(".room-drawer"),ae=".room-type-summary",ad=".room-selected-confirmation";ac.each(function(ah){var ag=ah.readAttribute("data-provider");if(ag!==af){J(ah);ah.select(ae).each(function(ai){ai.select(ad).each(function(aj){aj.addClassName("hide");});});}});}var J=function(ac){var ad=ac.select(".room-types-fieldset");ad.each(function(ae){ae.select(".tab-room-info").each(function(af){G(af);});});};var G=function(ac){ac.removeClassName("tab-room-selected");ac.down("input").checked=false;};function r(ae){var ad="hide",ag=".room-type-summary",ac=".room-selected-confirmation";if(ae!==undefined){var ah=ae.up(ag);if(ah!==undefined){var af=ah.down(ac);if(af!==undefined){af.removeClassName(ad);}}}}this.selectCarListener=function(ad){var ac=$(ad.target);var ae=$$(".roomShopping_v1").size()>0;if(ac.nodeName.toLowerCase()!=="a"){ac=ac.up("a");}if(ac.nodeName.toLowerCase()==="a"&&!ac.hasClassName("selectLink")){return;}if(ac.href&&!ae){Event.stop(ad);}if(F.length>0){E(ad);}};this.selectCarPointsAllocationListener=function(ad){var ac=$(ad.target);if(ac.nodeName.toLowerCase()!=="a"){ac=ac.up("a");}if(ac.href){Event.stop(ad);}if(F.length>0){u(ad);}};this.selectRoomListener=function(ak){var ad=$(ak.target);if(ad.nodeName.toLowerCase()!=="a"){ad=ad.up("a");}if(ad.nodeName.toLowerCase()==="a"&&!ad.hasClassName("selectLink")){return;}var ae=ad.up(".room-types-fieldset"),af=$$(".roomShopping_v2").first();if(ad.href){Event.stop(ak);}if(ae){ae.select(".tab-room-info").each(function(al){G(al);});var ag=!ad.hasClassName("tab-room-info")?ad.up(".tab-room-info"):ad;ag.addClassName("tab-room-selected");ag.down("input").checked=true;if(D){var ai=ad.up(".room-drawer"),ac=ai.down(".drawer-select-hotel-key").value,aj=ae.up(".room-drawer").readAttribute("data-provider"),ah=ai.select(".room-type-summary").size();$$(".select-hotel-key").first().writeAttribute("value",ac);$$(".drawer-select-hotel-key").each(function(am){var an=$(am);if(an.value!==ac){var al=an.up(".room-drawer");al.select(".tab-room-info").each(function(ap){G(ap);});al.select(".room-selected-confirmation").each(function(ap){ap.addClassName("hide");});var ao=$$(".add-to-booking").first();ao.addClassName("no-room-selected");}});f(aj);if(ai.select("input:checked").size()===ah){ab();}}L();if(F.length>0){K(ag);if(c.length>0){X();}if(((af&&aa.isMultiRoomHotel)||z)&&!aa.isForModify){E(ak);}}}if(D&&aa.isMultiRoomHotel){r(ae);}EzRez.Util.Event.pubsub.publish("hotelChangeRoom/hideNoRoomSelectedWarning");};this.applyListeners=function(){$$("#carCrossSell .selectLink").each(function(ad){ad.observe("click",m.selectCarListener);});$$("#carCrossSell .selectRoomCarLink").each(function(ad){ad.observe("click",m.selectCarPointsAllocationListener);});var ac=$$(".room-types-form");if(ac.length){ac.first().on("click",".room-types-form .selectLink",m.selectRoomListener);}q.on("click",".selectLink",m.selectRoomListener);q.on("click",".show-radio-buttons .tab-room-info",m.selectRoomListener);q.on("click",".toggle-truncated-text-link",w);q.on("click",".change-room-selection-open",m.showAllRoomSegmentsForThisRoomOccupancy);q.on("click",".change-room-selection-close",P);q.on("click",".show-details-link a",l);q.on("click",".drawer-toggle a",t);q.on("mouseover",".tooltip",e);q.on("mouseout",".tooltip",n);};this.showAllRoomSegmentsForThisRoomOccupancy=function(ad){var ac=$(ad.target),ae=ac.up(".room-types-fieldset"),ah=ac.up(".js-show-additional-rooms"),ai=ae&&ae.select(".tab-room-info").findAll(function(aj){return !W(aj);}),ag=ah?10:5,af;if(ai.size()>0){af=ai.splice(0,ag);af.invoke("addClassName","show-room");af.invoke("removeClassName","hide-room");if(!ah||ai.size()<1){ae.addClassName("show-all-room-types");}}};function M(){$$(".select-room-segment-key").map(function(ac){ac.value=I();});}this.initialize=function(){d();M();if(H){S();}else{B();}if(aa.hasRoomTypeFilter){y();}if(D){h();}};};b.createUIComponent("roomSelectionHotelDetailsRoomsComponent",{initialize:function(c){var d=new a(c);d.initialize();return d;},applyListeners:function(c){c.applyListeners();}});}(EzRez.Application));(function(b){var a=function(j){var k=Object.extend({isRoomSelectionHotelDetailsVersion3:false,translations:{seeMore:"See more",seeLess:"See less"}},j);var m=$$(".hotel-details-description-component").first();var g=[new i(m.down(".description-container")),new i(m.down(".extras-container"))];function i(n){this.$container=n;this.$showMoreLinkContainer=n.next(".show-more-link");this.$showMoreLink=this.$showMoreLinkContainer?this.$showMoreLinkContainer.down("a"):null;this.$containerOverflow=null;this.containerCssMaxHeight=0;}function l(){d();}function d(){if(k.isRoomSelectionHotelDetailsVersion3){for(var o=0;o<g.length;o++){var n=g[o];if(n.$showMoreLinkContainer){n.$showMoreLinkContainer.hide();}if(n.$container&&n.$showMoreLink){n.containerCssMaxHeight=h(n.$container);if(n.$container.getHeight()>=n.containerCssMaxHeight){n.$containerOverflow=new Element("div",{"class":"container-overflow"});n.$container.insert({bottom:n.$containerOverflow});n.$showMoreLinkContainer.show();n.$showMoreLink.observe("click",(function(p){e(this);Event.stop(p);}).bindAsEventListener(n));}}}}}function e(n){if(n.$container.hasClassName("extras-expanded")){c(n);}else{f(n);}}function f(o){var q=h(o.$container);var p=o.$container.getHeight();var n=0;var r=setInterval(function(){n=p;q+=10;o.$container.setStyle({maxHeight:q+"px"});p=o.$container.getHeight();if(p<=n){clearInterval(r);o.$containerOverflow.hide();o.$showMoreLink.update(k.translations.seeLess);o.$container.addClassName("extras-expanded");}},10);}function c(n){var p=h(n.$container);var o=n.$container.getHeight();var q=setInterval(function(){p-=10;if(p<n.containerCssMaxHeight){p=n.containerCssMaxHeight;}n.$container.setStyle({maxHeight:p+"px"});o=n.$container.getHeight();if(o===n.containerCssMaxHeight){clearInterval(q);n.$containerOverflow.show();n.$showMoreLink.update(k.translations.seeMore);n.$container.removeClassName("extras-expanded");}},10);}function h(n){return parseInt(n.getStyle("maxHeight").replace("px",""),10);}this.applyListeners=function(){};l();};b.createUIComponent("hotelDetailsDescriptionComponent",{initialize:function(c){return new a(c);},applyListeners:function(c){c.applyListeners();}});})(EzRez.Application);(function(b){var a;a=function(d){var f=Object.extend({thumbnailContainerId:"",imagesPerPage:""},d);var c,g,v,s,t,j,u;c=$$(".image-gallery").first();g="lrg0";v=f.thumbnailContainerId;s=f.imagesPerPage;t=1;j=0;u=false;this.applyListeners=function(){$$(".tabbedBody").first().on("click","img.thumbnail-image",function(z){e(Element.identify(z.target));Event.stop(z);});$$(".tabbedBody").first().on("click",".pg-prev a",function(z){w();Event.stop(z);});$$(".tabbedBody").first().on("click",".pg-next a",function(z){i();Event.stop(z);});$$(".tabbedBody").first().on("click",".pg-list a",function(A){var z=q(Element.identify(A.target));x(z);});};function q(z){return parseInt(z.replace(/pg/g,""));}function e(A){var B=parseInt(A.replace(/thmb/g,""));var z="lrg"+B;k(g,z);g=z;}function k(A,z){l(A);h(z);}function l(z){$(z).style.display="none";}function h(z){$(z).style.display="";}function r(){var z=$(v).childElements().size();j=Math.ceil(z/s);u=true;o(".pg-list");x(1);}function m(C,B){var A=$(v).childElements();for(var z=0;z<A.size();z++){if(z<C||z>B){A[z].style.display="none";}else{A[z].style.display="";}}}function x(z){if(!u){alert("not inited");return;}var D=$("pg"+t);D.className="pg-normal";t=z;var A=$("pg"+t);A.className="pg-selected";var C=(z-1)*s;var B=C+s-1;m(C,B);p(z);}function p(z){if(z==1){n(".pg-prev");}else{y(".pg-prev");}if(z==j){n(".pg-next");}else{y(".pg-next");}}function n(z){$$(z).first().style.display="none";}function y(z){$$(z).first().style.display="";}function w(){if(t>1){x(t-1);}}function i(){if(t<j){x(t+1);}}function o(z){if(!u){alert("not inited");return;}var A=$$(z).first();var B=" ";for(var C=1;C<=j;C++){B+='<a id="pg'+C+'" class="pg-normal">'+C+"</a>";}A.innerHTML=B;}this.initialize=function(){h(g);r();};};b.createUIComponent("roomSelectionHotelDetailsPhotosComponent",{initialize:function(c){return new a(c);},applyListeners:function(c){c.applyListeners();}});})(EzRez.Application);(function(b){var a=function(k){var m=Object.extend({paginationLabel:""},k);var D=$$(".selected-image").first();var e=$("thumbnail-image-list");var o=12;var z=4;var w=3;var f=1;var r=0;var h=0;var d=0;var t;var c=D.getHeight();var x=D.getWidth();this.applyListeners=function(){$$(".thumbnail a").invoke("observe","click",function(H){r=parseInt(H.target.id.split("thmb")[1],10);j(this.down(".image-full-url"));Event.stop(H);});$$(".image-pagination .pg-next").invoke("observe","click",function(H){s();Event.stop(H);});$$(".image-pagination .pg-prev").invoke("observe","click",function(H){E();Event.stop(H);});$$(".selected-image-container .img-next").invoke("observe","click",function(H){g();Event.stop(H);});$$(".selected-image-container .img-prev").invoke("observe","click",function(H){C();Event.stop(H);});$$(".image-pagination .pg-first").invoke("observe","click",function(H){q();Event.stop(H);});$$(".image-pagination .pg-last").invoke("observe","click",function(H){i();Event.stop(H);});};function v(I){var H=new Element("img",{src:I});if(H.complete){y.apply(H);}else{H.observe("load",y);}}function y(){var L=this,Q=false,M=false,J=false,N=false,I=false,H=L.width,K=L.height;if(K<=c&&H<=x){M=true;}else{if(K>c&&H>x){J=true;}else{if(K>c&&H<=x){N=true;}else{if(K<=c&&H>x){I=true;}}}}if((J&&K>=H)||N){L.setStyle({height:c+"px"});}else{if((J&&H>=K)||I){L.setStyle({width:x+"px"});Q=true;}}D.update(L);D.down("img").writeAttribute("alt","Hotel image");if(Q||M){var R=$$(".selected-image img")[0];var P=M?1:(H/x);var O=Math.round((c-(K/P))/2);R.setStyle({paddingTop:O+"px"});}}function p(H){t.removeClassName("selected-thumbnail");H.addClassName("selected-thumbnail");t=H;}function B(){n();o=l();F();h=$("thumbnail-image-list").childElements().size();d=Math.ceil(h/o);G(1);var H=$$("#thumbnail-image-list .image-full-url").first();if(!H){return;}t=H.up(".thumbnail");j(H);}function l(){var H=$$(".selected-image-container").first();var O=$("thumbnail-image-list");var N=$$(".thumbnail").first();if(H&&O&&N){var K=O.getWidth();var J=H.getHeight();var I=new Element.Layout($$(".thumbnail").first());var M=I.get("margin-box-width");var L=I.get("margin-box-height");z=Math.floor(K/M);w=Math.floor(J/L);return z*w;}return o;}function n(){var H=$$(".selected-image-container").first();if(H){var K=H.down(".img-prev");var N=H.down(".img-next");var M=H.getHeight();if(K){var J=K.getHeight();var I=(M-J)/2;K.setStyle({top:I+"px"});}if(N){var O=N.getHeight();var L=(M-O)/2;N.setStyle({top:L+"px"});}}}function F(){var I=$$(".image-list").first();var K=$("thumbnail-image-list").getWidth();var O=$$(".thumbnail").first();if(!O){return;}var H=new Element.Layout($$(".thumbnail").first());var N=H.get("margin-box-width");var J=H.get("margin-right");var M=N*z;var L=K-M+J;I.setStyle({left:L+"px"});}function G(H){f=H;var J=(H-1)*o;var I=J+o-1;if(I>h-1){I=h-1;}u(J,I);A(H);}function u(L,K){var J=e.childElements();for(var H=0;H<J.size();H++){if(H<L||H>K){J[H].style.display="none";}else{J[H].style.display="inline";}}var I=m.paginationLabel.replace("#set#",(L+1)+"-"+(K+1));I=I.replace("#total#",h);$$(".current-page").first().update(I);}function A(H){if(H===1){$$(".pg-prev").first().addClassName("pagination-disabled");$$(".pg-first").first().addClassName("pagination-disabled");}else{$$(".pg-prev").first().removeClassName("pagination-disabled");$$(".pg-first").first().removeClassName("pagination-disabled");}if(H===d){$$(".pg-last").first().addClassName("pagination-disabled");$$(".pg-next").first().addClassName("pagination-disabled");}else{$$(".pg-next").first().removeClassName("pagination-disabled");$$(".pg-last").first().removeClassName("pagination-disabled");}if(h<=o){$$(".pg-first").first().addClassName("pagination-disabled");$$(".pg-last").first().addClassName("pagination-disabled");}}function j(H){if(H){p(H.up(".thumbnail"));v(H.value);}}function E(){if(f>1){G(f-1);}}function s(){if(f<d){G(f+1);}}function C(){var H=false;if(r==0){r=h-1;f=Math.ceil(h/o);H=true;}else{r--;}j(e.childElements()[r].down(".image-full-url"));if(H){G(f);}else{if(r<(f-1)*o){E();}}}function g(){if(r>=h-1){r=0;f=0;}else{r++;}j(e.childElements()[r].down(".image-full-url"));if(r>(f*o)-1){s();}}function q(){G(1);}function i(){G(d);}this.initialize=function(){B();};(function(I){var J=I(".hotelLandingImageContainer").first();if(J){var H=J.down(".hotelLandingImage");if(H.getHeight()<H.getWidth()){H.id="imageWidth";}else{H.id="imageHeight";}}})($$);};b.createUIComponent("hotelDetailsPhotosComponent",{initialize:function(c){return new a(c);},applyListeners:function(c){c.applyListeners();}});})(EzRez.Application);(function(a,d){function f(g){d.Util.Debug.info(g);console.info(g);}var e=function(h){var i=Object.extend({translations:{AVAILABILITY_MAP_PIN_MOVE_ME:"Move me!",AVAILABILITY_MAP_DROPPED_PIN:"Dropped Pin"}},h);function j(k){var l=i.translations[k];if(!l){return k;}return l;}function g(){var k=new GIcon();k.image="/js/gmaps/images/markers/bluePin/image.png";k.shadow="/js/gmaps/images/markers/bluePin/shadow.png";k.iconSize=new GSize(32,32);k.shadowSize=new GSize(48,32);k.iconAnchor=new GPoint(0,32);k.infoWindowAnchor=new GPoint(16,0);k.printImage="/js/gmaps/images/markers/bluePin/printImage.gif";k.mozPrintImage="/js/gmaps/images/markers/bluePin/mozPrintImage.gif";k.printShadow="/js/gmaps/images/markers/bluePin/printShadow.gif";k.transparent="/js/gmaps/images/markers/bluePin/transparent.png";k.imageMap=[18,0,20,1,23,2,24,3,26,4,26,5,26,6,26,7,24,8,22,9,22,10,22,11,21,12,21,13,20,14,21,15,21,16,22,17,22,18,22,19,22,20,22,21,22,22,21,23,19,24,13,25,13,26,12,27,12,28,12,29,11,30,11,31,9,31,9,30,9,29,9,28,9,27,10,26,10,25,10,24,11,23,9,22,8,21,7,20,6,19,5,18,5,17,5,16,5,15,6,14,7,13,8,12,11,11,11,10,11,9,12,8,12,7,12,6,13,5,12,4,11,3,11,2,11,1,12,0];return k;}this.addLocationToMap=function(o,n,m){var l={title:j("AVAILABILITY_MAP_PIN_MOVE_ME"),label:null,labelClass:"LabeledMarker_markerLabel selectedAddressLabeledMarker",marker_opts:{icon:g()}};var k=o.addGeoCord(n.lat,n.lng,l);k.enableDragging();GEvent.addListener(k,"click",function(){k.openInfoWindowHtml("<br/>"+n.address);});GEvent.addListener(k,"dragend",function(p){m(p.lat(),p.lng());});};};var b=function(g){var h=Object.extend({translations:{AVAILABILITY_MAP_PIN_MOVE_ME:"Move me!",AVAILABILITY_MAP_DROPPED_PIN:"Dropped Pin"}},g);function i(j){var k=h.translations[j];if(!k){return j;}return k;}this.addLocationToMap=function(o,l,k){var m=o.addGeoCord(l.lat,l.lng,{});var j=o.getMap();if(!j){return;}else{clearInterval(b.addLocationToMapInterval);}m.setOptions({draggable:true,icon:"/js/gmaps/images/markers/bluePin/image.png",width:32,height:32,zIndex:1002});var n=new Microsoft.Maps.Infobox(m.getLocation(),{showPointer:true,showCloseButton:false,visible:false,zIndex:100,width:150,height:40,offset:new Microsoft.Maps.Point(0,30),description:i("AVAILABILITY_MAP_PIN_MOVE_ME")});j.entities.push(n);Microsoft.Maps.Events.addHandler(m,"mouseover",function(){document.body.style.cursor="move";n.setOptions({visible:true});});Microsoft.Maps.Events.addHandler(m,"mouseout",function(){document.body.style.cursor="default";n.setOptions({visible:false});});Microsoft.Maps.Events.addHandler(m,"dragstart",function(p){n.setOptions({visible:false});});Microsoft.Maps.Events.addHandler(m,"dragend",function(q){var p=q.location;k(p.latitude,p.longitude);});};};b.addLocationToMapInterval=null;var c=function(r){var s=Object.extend({translations:{AVAILABILITY_MAP_PIN_MOVE_ME:"Move me!",AVAILABILITY_MAP_DROPPED_PIN:"Dropped Pin"}},r);var y=".mapAddressSearchContainer";var h="mapAddressSearchActiveContainer";var t=function(M){};var g=new d.UI.DOMCache({rootNode:y,nodes:{addressInput:function(M){return M.down("input.nearbyAddress");},addressResultsUl:function(M){return M.down("ul.addressResults");},addressResultsContainer:function(M){return M.down("div.addressResultsContainer");},noAddressResultsContainer:function(M){return M.down("div.noAddressResultsContainer");},selectedAddressContainer:function(M){return M.down("div.selectedAddressContainer");},selectedAddress:function(M){return M.down("div.selectedAddressContainer span.selectedAddress");},errorMessage:function(M){return M.down("div.errorMessage");}}});var A=d.UI.MapFactory.isCompatible();var D=$H();var H=null;var k=null;var x=false;function w(M){var N=s.translations[M];if(!N){return M;}return N;}function o(){g.addressResultsContainer.hide();g.noAddressResultsContainer.hide();g.selectedAddressContainer.hide();g.errorMessage.hide();}function K(M){g.noAddressResultsContainer.show();}function E(M){var O=a.use("hotelsMap");var N;if(d.Connector.GeocoderFactory.getType()===d.Connector.GeocoderType.GOOGLE){N=new e(s);N.addLocationToMap(O.getMap(),M,u);}else{N=new b(s);if(b.addLocationToMapInterval){clearInterval(b.addLocationToMapInterval);}b.addLocationToMapInterval=setInterval(function(){console.log("running addLocationToMapInterval interval");var P=O.getMap();if(P){N.addLocationToMap(O.getMap(),M,u);}},200);}}function L(M){D=$H();g.addressResultsUl.update("");M.each(function(O){var N=d.StringUtil.isSet(O.formattedAddress)?O.formattedAddress:O.address.toString();D.set(N.toLowerCase(),O);g.addressResultsUl.insert('<li class="addressResults"><a href="#">#{address}</a></li>'.interpolate({address:N}));});g.addressResultsContainer.show();x=true;}function G(M){a.Search.cityMapGeoLocation=M;if(g.rootNode){g.rootNode.removeClassName(h);}l();o();E(M);var N=a.use("hotelMiniMap");if(N){N.createStaticMap(M);}f("  Sorting by distance from: "+M.address);console.dir(M);H=M;var O={lat:M.lat,lng:M.lng,address:M.formattedAddress,sort:"hotel_distance_from_geocords"};t(O);x=false;}function q(P,O,N){f(" Dropped pin: using pin geo coordinates");var M=new d.WebApi.GeoLocation({lat:P,lng:O,formattedAddress:N});G(M);}function l(){var N=a.use("hotelResultsTabs");var O=a.use("hotelsMapWaiting");var M=a.use("hotelsMap").getMap();O.show();N.showTab("hotels_map_view");setTimeout(function(){M.fixCenter(true,function(){O.hide();});},0);}function n(M){o();H=null;k.getLocations(M,function(N){f("Geocoding address: "+M+".");if(N.length===0){K(M);return;}console.dir(N);var O=a.use("hotelsMap");var Q=O.getMapCenter();var P=N.findAll(function(R){var U=Math.abs(Q.lat-R.lat);var T=Math.abs(Q.lng-R.lng);var S=U<=2&&T<=2;if(!S){f("  Inaccurate location: "+R.address);}return S;});if(P.length===0){f("  No accurate locations");f("  Failed to geocode address.");K(M);return;}if(P.length===1){G(P.first());return;}L(P);});}function u(N,M){H=null;k.getAddress(N,M,function(O){f("Reverse Geocoding coordinate: "+N+", "+M+".");if(O.length===0){q(N,M,w("AVAILABILITY_MAP_DROPPED_PIN"));return;}console.dir(O);if(O.length===0){f("  No accurate locations");f("  Failed to reverse geocode coordinate.");q(N,M,w("AVAILABILITY_MAP_DROPPED_PIN"));return;}var P=O.first();f("  Reverse geocode success: "+P.address);G(P);});}function i(M){$(M.target).value="";}function C(M){if(M.keyCode!==Event.KEY_RETURN){return;}g.setRootNode($(M.target).up(y));n(g.addressInput.getValue());}function B(M){g.setRootNode($(M.target).up(y));n(g.addressInput.getValue());}function m(N){Event.stop(N);var O=N.findElement("li.addressResults a");var M=D.get(O.innerHTML.toLowerCase());g.setRootNode(O.up(y));G(M);}function v(M){var N=Event.findElement(M,y);if(!N){return;}g.setRootNode(N);g.rootNode.addClassName(h);}function j(M){var N=Event.findElement(M,y);if(!N||x){return;}g.setRootNode(N);g.rootNode.removeClassName(h);}function J(M){var N=Event.findElement(M,y);if(N){return;}$$(y).each(function(O){if(O.hasClassName(h)){g.setRootNode(O);g.rootNode.removeClassName(h);}});}var z=[];function p(){if(!A){return;}$$(y).each(function(M){z.push(M.on("mouseover",v));z.push(M.on("mouseout",j));});$$(y+" input.nearbyAddress").each(function(M){z.push(M.on("focus",i));z.push(M.on("keydown",C));});z.push($(document.body).on("click",y+" input.submitNearbyAddress",B));z.push($(document.body).on("click",y+" ul.addressResults",m));z.push($(document.body).on("click",J));}function F(){z.invoke("stop");z=[];}function I(){if(!A){return;}if(!k){k=d.Connector.GeocoderFactory.create();}}this.applyListeners=p;this.removeListeners=F;this.reinitialize=function(N){if(!A){return;}I();F();p();if(H){var M=$$(N).first();g.setRootNode(M);E(H);}};this.clearSelectedLocation=function(){H=null;};this.setUpdateCallback=function(M){t=M;};I();};a.createUIComponent("hotelMapDistanceSorter",{initialize:function(g){return new c(g);},applyListeners:function(g){g.applyListeners();},removeListeners:function(g){g.removeListeners();}});})(EzRez.Application,EzRez);(function(b){var a=EzRez.Util.Event.pubsub;b.createUIComponent("alignHotelFilters",(function(){var g="show_hide_modify";var e="hotel_avail_container";var f="hotel_filters";var d=function(){};var c=function(h){if(d){d();}if(!$(e)){return;}if(!$(f)){return;}var l=$(e).cumulativeOffset().top;var i=$(f);var k=i.getStyle("marginTop");if(k){k=parseInt(k.replace("px",""));}if(!k){k=0;}var j=i.cumulativeOffset().top-k;if(l>j){i.setStyle({marginTop:(l-j)+"px"});}else{i.setStyle({marginTop:0});}if(h){Event.stop(h);}};return{initialize:function(){c();if(!$(g)){return;}d=$(g).onclick;$(g).onclick=null;return null;},applyListeners:function(){if(!$(g)){return;}$(g).observe("click",c);},removeListeners:function(){if(!$(g)){return;}$(g).stopObserving("click",c);}};})());b.createUIComponent("hotelsMapWaiting",{initialize:function(){return new EzRez.UI.Spinner("hotels_map_waiting",{hide_sibling:false});}});b.createUIComponent("hotelDescriptionExpander",(function(){var c=function(){var d=function(i){var k=Event.element(i);if(k.tagName.toLowerCase()!="a"){return;}var f=Element.up(k,".supplier-desc");if(!f){return;}var j=Element.select(f,".hotel_description_inner");if(Element.hasClassName(k,"open")){Event.stop(i);var h=Element.select(f,"a.close");if(h.length>0){k.hide();h[0].show();}if(j.length>0){j[0].setStyle({height:"auto"});j[0].setStyle({overflow:"visible"});}}else{if(Element.hasClassName(k,"close")){Event.stop(i);var g=Element.select(f,"a.open");if(g.length>0){k.hide();g[0].show();}if(j.length>0){j[0].setStyle({height:""});j[0].setStyle({overflow:"hidden"});}}}};var e=$("hotel_avail_container");if(!e){e=$$(".hotel_description_outer");if(e.length>0){e=e[0];}else{e=null;}}if(e){Event.observe(e,"click",d);}this.applyListeners=function(){this.hideUnnecessaryLinks();};this.removeListeners=function(){};this.unload=function(){};this.hideUnnecessaryLinks=function(){var f=$("hotel_avail_container");if(!f){return;}var l=f.select(".hotel_description_outer");var k=f.select(".hotel_description_inner");for(var g=k.length-1;g>-1;g--){if(k[g].offsetHeight>=k[g].scrollHeight){var h=Element.select(l[g],".open");if(h.length){h[0].hide();}var j=Element.select(l[g],".close");if(j.length){j[0].hide();}}}};this.hideUnnecessaryLinks();};return{initialize:function(){return new c();}};})());b.createUIComponent("hotelResultsTabs",{initialize:function(){var c=new EzRez.UI.TabLinks({name:"HotelsTabs",default_tab:"hotels_list_view",link_active_css:"active_tab",no_hide_classname:"no_hide",onshow:function(d,e){switch(e.identify()){case"hotels_list_view":$("hotels_list_view").removeClassName("map_active");break;case"hotels_map_view":$("hotels_list_view").addClassName("map_active");if($("hotels_map_view")){$("hotels_map_view").show();}break;}}});return c;}});b.requires("hotelsMap",["hotelsMapWaiting","hotelResultsTabs","hotelMap"]);b.createUIComponent("hotelsMap",(function(){var c=function(){var h=b.use("hotelMap");var g=b.use("hotelsMapWaiting");var d=b.use("hotelResultsTabs");var f=b.getDOMController("hotelResultsController");var i=null;function e(){i=EzRez.UI.MapFactory.createMap({hotelMapData:EzRez.UI.MapHotelData.getList(),canvas_id:"hotels_map_canvas",map_options:{googleBarOptions:{suppressZoomToBounds:true}},setup:function(j){j.addControl(new GSmallMapControl());j.addControl(new GMapTypeControl());j.enableContinuousZoom();j.disableGoogleBar();},geocodeComplete:function(j,k){k.each(function(l){$("hotel_details_"+l.label).addClassName("hide_map_references");});if(0<j.length){g.hide();}}});}this.setMap=function(j){i=j;};this.getMap=function(){if(!i){e();}return i;};this.getMapCenter=function(){if(!i){e();d.showTab("hotels_map_view");}return i.getMapCenter();};this.addGeoCoord=function(l,k,j){return i.addGeoCord(l,k,j);};this.startup=function(){if(!$("hotels_map_canvas")){return false;}g.show();d.addLinks($$("#hotels_view_nav a"));if(!EzRez.UI.MapFactory.isCompatible()){$("hotels_view_nav").down("li.hotels_map_tab").hide();d.showTab("hotels_list_view");if($("hotels_list_view")){$("hotels_list_view").addClassName("gmapsDisabled");}return false;}if(h&&h.closeExtInfoWindow){h.closeExtInfoWindow();}if(EzRez.Util.Cookie.read("HotelsTabs")==="hotels_map_view"){e();}$("hotels_map_tab").observe("click",function(j){if(!i){e();}g.show();setTimeout(function(){i.fixCenter(true,function(){g.hide();});},0);});d.showLastViewedTab();if($("hotels_list_view")){this.reload($("hotels_list_view").select("div.hotel_map_container"));}return true;};this.reload=function(j){if(!EzRez.UI.MapFactory.isCompatible()||EzRez.UI.MapFactory.getMapProvider()===EzRez.UI.MapProvider.BING||!$("hotels_map_canvas")){return false;}g.show();if(!Object.isElement(j.first())){j=j.collect(function(k){return $(k);});}i.parse({elements:j,clear_markers:true,geocodeComplete:function(k,l){l.each(function(m){$("hotel_details_"+m.label).addClassName("hide_map_references");});if(k.size()>0){g.hide();}}});};this.closeExtInfoWindow=function(){if(!i||!i.getMap().closeExtInfoWindow){return;}i.getMap().closeExtInfoWindow();};this.unload=function(){d.removeLinks($$("#hotels_view_nav a"));if(i===null){return;}i.destroy();i=null;};};return{initialize:function(){var d=new c();d.startup();return d;}};})());b.createUIComponent("hotelMap",(function(){var c=function(){var f=null;var e=b.getDOMController("hotelResultsController");var d=b.use("hotelsMap");this.setMap=function(g){f=g;};this.getMap=function(){return f;};this.startup=function(){if(!EzRez.UI.MapFactory.isCompatible()){return false;}var j=$("lightbox");var l=j.select(".hotel_map_canvas");if(l.size()==0){return false;}var g=l[0].identify();if(d&&d.getMap().closeExtInfoWindow){d.getMap().closeExtInfoWindow();}var i=j.down(".gmarker .hotelObjectKey").innerHTML;var k=b.Availability.getHotel(i);var h=[{label:"1",hotel:k}];f=EzRez.UI.MapFactory.createMap({hotelMapData:h,canvas_id:g,info_id:"lightbox",setup:function(m){m.addControl(new GSmallMapControl());m.addControl(new GMapTypeControl());m.enableContinuousZoom();m.disableGoogleBar();}});};this.closeExtInfoWindow=function(){if(!f||!f.getMap().closeExtInfoWindow){return;}f.getMap().closeExtInfoWindow();};this.unload=function(){if(f===null){return;}f.destroy();f=null;};};return{initialize:function(){return new c();}};})());b.createUIComponent("lightBoxForHotelDetails",{initialize:function(){return new EzRez.UI.LightBox({className:"hotel_details",type:"iframe"});}});b.createUIComponent("lightBoxForHotelMap",{initialize:function(){return new EzRez.UI.LightBox({className:"hotel_map",type:"inline",opened:function(e,d,c){setTimeout(function(){b.use("hotelMap").startup();},500);},hidden:function(g,f,c){var e=b.use("hotelMap");e.closeExtInfoWindow();e.unload();var d=b.use("hotelsMap");d.unload();d.startup();if($("hotels_list_view")){d.reload($("hotels_list_view").select("div.hotel_map_container"));}}});}});b.createUIComponent("lightBoxForPromo",{initialize:function(){return new EzRez.UI.LightBox({className:"fhr_promo",type:"inline"});}});b.createUIComponent("lightBoxForTabbedHotelDetails",{initialize:function(){return new EzRez.UI.LightBox({className:"hotel_details_tabbed",type:"iframe"});}});b.createUIComponent("lightBoxForRoomSelectionHotelDetailsMap",{initialize:function(){return new EzRez.UI.LightBox({className:"room_selection_hotel_details_map",headerClassName:"room_selection_hotel_details_map_header",type:"iframe"});}});b.createUIComponent("lightBoxForVirtualTour",{initialize:function(){return new EzRez.UI.LightBox({className:"virtual_tour",type:"iframe"});}});b.createUIComponent("lightBoxForReviews",{initialize:function(){return new EzRez.UI.LightBox({className:"hotel_review_overlay",type:"iframe"});}});b.createUIComponent("lightBoxDefault",{initialize:function(){return new EzRez.UI.LightBox({className:"popup_overlay",type:"iframe"});}});b.requires("hotelUpdater",["hotelResultsController","hotelDescriptionExpander","bonus-offer-display","waitingDialog","hotelsMap","hotelsPerPageComponent","loyaltyPricingOptionSelectComponent"]);b.createUIComponent("hotelUpdater",(function(){var c=function(f){var i=Object.extend({create:function(){EzRez.UI.MapHotelData.clear();b.use("waitingDialog").show();b.getDOMController("hotelResultsController").removeActions();b.use("hotelDescriptionExpander").removeListeners();b.use("bonus-offer-display").removeListeners();setTimeout(function(){b.use("hotelsMap").unload();},50);},loading:function(){},complete:function(){b.getDOMController("hotelResultsController").applyActions();b.use("hotelDescriptionExpander").applyListeners();b.use("loyaltyPricingOptionSelectComponent").applyListeners();b.use("hotelDescriptionExpander").hideUnnecessaryLinks();b.use("bonus-offer-display").applyListeners();b.use("hotelsPerPageComponent").applyListeners();b.use("waitingDialog").hide();var j=b.use("hotelResultsTabs");if(!EzRez.UI.MapFactory.isCompatible()){$("hotels_view_nav").down("li.hotels_map_tab").hide();j.showTab("hotels_list_view");if($("hotels_list_view")){$("hotels_list_view").addClassName("gmapsDisabled");}}else{j.showLastViewedTab();}a.publish("hotelUpdater/succeeded");},failure:function(){b.getDOMController("hotelResultsController").applyActions();b.use("hotelDescriptionExpander").applyListeners();b.use("hotelDescriptionExpander").hideUnnecessaryLinks();b.use("bonus-offer-display").applyListeners();b.use("waitingDialog").hide();},exception:function(j,k){try{b.getDOMController("hotelResultsController").applyActions();b.use("hotelDescriptionExpander").applyListeners();b.use("hotelDescriptionExpander").hideUnnecessaryLinks();b.use("bonus-offer-display").applyListeners();b.use("waitingDialog").hide();}catch(l){}throw (k);},target:"hotel_avail_container",url:"/travel/malibu/hotel_choices_content.cfm",isLandingPage:false,params:{}},f);var g=$H();var e=i.target;var h=i.url;if(i.isLandingPage){i.params.is_landing_page=true;}function d(){var j={},k=b.use("searchFilterSettingsComponent");if(k){j=$H(k.getCurrentHotelSearchFilterSettings());j.set("fromAjax",true);j.unset("start_index");j.unset("scrollPosition");j.set("locationId",j.get("city"));j.set("locationFilterRadius",j.get("cityLocationFilterRadius"));j.set("units",j.get("units"));j.set("neighborhood_ids",j.get("neighborhoods"));j.unset("city");j.unset("startIndex");j.unset("cityFilterLocationRadius");j.unset("neighborhoods");}return j;}this.update=function(){i.create();new Ajax.Updater(e,h,{parameters:g.merge(i.params),evalScripts:true,onLoading:i.loading,onComplete:i.complete,onException:i.exception,onFailure:i.complete});document.fire("ezrez:filterTriggered",g);};this.updatePage=function(j,k){g=g.merge({start_index:j,number_per_page:k});g=g.merge({updateType:"updatePage"});this.update();};this.updateFilter=function(j){g=g.merge(d());g=g.merge(j);g=g.merge({updateType:"updateFilter"});g.unset("start_index");g.unset("scrollPosition");this.update();};this.updateSort=function(j){g=g.merge(d());g=g.merge({sort:j});g=g.merge({updateType:"updateSort"});g.unset("start_index");g.unset("scrollPosition");this.update();};this.resetParameters=function(){g=$H();};this.mergeParameters=function(j){g=g.merge(j);};this.getParameters=function(){return g;};this.isLandingPage=i.isLandingPage;};return{initialize:function(d){return new c(d);}};})());b.requires("hotelPagination",["hotelUpdater"]);b.createUIComponent("hotelPagination",(function(){var c=function(d){var j=$H({outerContainerId:"hotel_avail_container",pagerContainerClassName:"arc_pager",inactivePageClassName:"inactive",pageClassName:"page",scrollToElementSelector:".malibu_choose_hotel_header",itemsPerPage:10}).merge(d).toObject();var h=b.use("hotelUpdater");var e=$$(j.scrollToElementSelector);if(e.length>0){e=e[0];}else{e=null;}var f=$(j.outerContainerId);if(f===null){return;}Event.observe(f,"click",i);var g=parseInt(j.itemsPerPage,10);function i(n){var k=Event.element(n);if(k.tagName.toLowerCase()!="a"){return;}if(!Element.up(k,"."+j.pagerContainerClassName)){return;}if(Element.hasClassName(k,j.inactivePageClassName)){Event.stop(n);return;}if(Element.hasClassName(k,j.pageClassName)){$$(".yui-panel-container").each(function(o){o.hide();});Event.stop(n);if(e){Element.scrollTo(e);}var m=Element.readAttribute(k,"rel");var l=(m*g)-g+1;a.publish("hotelPagination/paginationClicked",[m]);h.updatePage(l,g);}}this.setItemsPerPage=function(k){g=k;};};return{initialize:function(d){return new c(d);}};})());b.createUIComponent("bonus-offer-display",(function(){var c=function(j){var k=$H({bonusParentClass:"bonusOffers",overlayContentClass:"bonusOfferText",priceContainerClass:"priceContainer",cardParentClass:"supplier-info",hotelOptionClass:"hotelOption",overlayWidth:"260",overlayYOffset:86,overlayXOffset:50}).merge(j).toObject();var d=[];var h={};var f=null;var i=function(s){if(f){f.destroy();}if(!s){return;}var o=h[s.identify()];if(!o){return;}var q=Element.up(s,".bonusOffers");if(!q){return;}var t=Element.cumulativeOffset(q);var n=Element.getHeight(q);var r=t.left+(q.getWidth()/2)+q.down().getWidth();var p=t.top-(n/2);f=new YAHOO.widget.Panel("bonusPanel",{xy:[r,p],width:k.overlayWidth+"px",visible:false,draggable:false,close:true,underlay:"none"});f.setBody(o.c);f.render(document.body);f.show();};var l=function(n){if(f){f.hide();}Event.stopObserving(document.body,"click",l);};var e=function(o){if(f){f.hide();}Event.stop(o);var n=Event.element(o);i(n);Event.observe(document.body,"click",l);};var m=function(){if(d.length>0){g();}var t=$$("."+k.bonusParentClass);if(t.length<=0){return;}for(var r=t.length-1;r>-1;r--){var o=t[r];var q=Element.select(o,"a");if(q.length==0){continue;}q=q[0];d.push(q);var p=[];var s=[];var n=Element.up(q,"."+k.cardParentClass);if(n){p=Element.select(n,"."+k.overlayContentClass);}if(p.length>0){p=p[0].innerHTML;}else{p=null;}if(n){s=Element.select(n,"."+k.priceContainerClass);}if(s.length>0){s=s[0];}else{s=null;}if(!p||!s){h[Element.identify(q)]=null;}else{h[Element.identify(q)]={c:p,cx:s};}Event.observe(q,"click",e);}};var g=function(){Event.stopObserving(document.body,"click",l);if(d.length<=0){return;}for(var n=d.length-1;n>-1;n--){Event.stopObserving(d[n],"click",e);}d=[];h={};};this.applyListeners=m;this.removeListeners=g;};return{initialize:function(d){return new c(d);},applyListeners:function(d){d.applyListeners();},removeListeners:function(d){d.removeListeners();},unload:function(d){d.removeListeners();}};})());b.createUIComponent("hotelsPerPageComponent",(function(){var c=function(){var g="#hotelsPerPage";var d=$$(g).first();if(d){var h=d.getValue();}else{var h="";}function f(i){if(i.getValue){return i.getValue();}if(i.value){return i.value;}return null;}function e(i){var k=$(i.target);var j=f(k);if(j===h){return;}b.use("hotelPagination").setItemsPerPage(j);b.use("hotelUpdater").updatePage(1,j);h=j;}this.applyListeners=function(){var i=$("hotel_avail_container");if(i){i.on("change",g,e);}};this.removeListeners=function(){};};return{initialize:function(){return new c();},applyListeners:function(d){d.applyListeners();},removeListeners:function(d){d.removeListeners();},unload:function(d){d.removeListeners();}};})());})(EzRez.Application);(function(e){if(!e){throw new EzRez.Util.Exception({message:"Missing application."});}var d=EzRez.Util.Event.pubsub;var b=function(g,j){var h=$(g.target),i=e.use(j);if(h.nodeName.strip().toLowerCase()!=="a"){h=h.up("a");}h.onclick=null;i.show(h);Event.stop(g);d.publish("hotelResultsController/lightBoxShown",[j]);return false;};var f={hotelAvailability:[],hotelResults:["lightBoxForHotelDetails","lightBoxForVirtualTour","lightBoxForHotelMap","lightBoxForTabbedHotelDetails","lightBoxDefault","lightBoxForReviews","hotelsMap","hotelMap","lightBoxForPromo"]};var a=e.createDOMController("hotelAvailabilityController",{});a.requires(f.hotelAvailability);var c=e.createDOMController("hotelResultsController",{after:function(h){if(!$("hotel_filter")||!$("hotel_results")){return;}e.load("hotelAutoComplete",{inputElement:"hotel_filter",resultsElement:"hotel_results",filterNameElement:"hotel_filter_name"});e.use("hotelAutoComplete").init();var i=$("hotel_filters");var g=$("hotel_pager_container");if(i&&g){if(i.down(".num_hotels_filtered")&&i.down(".num_hotels_unfiltered")){i.down(".num_hotels_filtered").innerHTML=g.down(".num_hotels_filtered").innerHTML;i.down(".num_hotels_unfiltered").innerHTML=g.down(".num_hotels_unfiltered").innerHTML;}}},"#hotel_avail_container div.avail_sort select,change":function(h,g){var i=$(h.target).getValue();e.use("hotelUpdater").updateSort(i);d.publish("hotelResultsController/sortingClicked",[i]);return false;},"#hotel_avail_container div.avail_sort a.sort,click":function(h,g){e.use("waitingDialog").show();var i=$(h.target);if(i.nodeName.strip().toLowerCase()!=="a"){i=i.up("a");}var j=i.href.split("#")[1];e.use("hotelUpdater").updateSort(j);Event.stop(h);return false;},"a.popup_overlay,click":function(h,g){return b(h,"lightBoxForHotelDetails");},"a.virtual_tour_overlay,click":function(h,g){return b(h,"lightBoxForVirtualTour");},"a.virtual_tour_overlay_tabbed,click":function(h,g){return b(h,"lightBoxForTabbedHotelDetails");},"a.view_more_overlay,click":function(h,g){return b(h,"lightBoxForHotelDetails");},"a.view_more_overlay_tabbed,click":function(h,g){return b(h,"lightBoxForTabbedHotelDetails");},"a.gmap_overlay,click":function(h,g){return b(h,"lightBoxForHotelMap");},"a.promo_overlay,click":function(h,g){return b(h,"lightBoxForPromo");},"a.gmap_overlay_tabbed,click":function(h,g){return b(h,"lightBoxForTabbedHotelDetails");},"a.hotel_review_overlay,click":function(h,g){return b(h,"lightBoxForReviews");},"a.hotel_review_overlay_tabbed,click":function(h,g){return b(h,"lightBoxForTabbedHotelDetails");},".card-left a.thumbnail,click":function(i,h){var g=$(i.target),k=g.up(".card-left"),j="display_tabbed_hotel_details";if(g.hasClassName(j)||k.down("."+j)){return;}return b(i,"lightBoxForHotelDetails");}});c.requires(f.hotelResults);})(EzRez.Application);var EzRez=EzRez||{};EzRez.UI=EzRez.UI||{};EzRez.Application=EzRez.Application||{};(function(a){EzRez.UI.SearchFilterSettingsComponent=function(g,i,e){if(!i||!e){return;}var h=Object.extend({sortBy:null,lastScrollPosition:0,selectedHotelIndex:-1,showRoomTypeOptions:"Show rooms",hideRoomTypeOptions:"Hide rooms"},g);var d=this;var l=null;var b=null;var j=null;var k=null;var r=null;var u=null;var o=null;var m=null;var p="SEARCH_FILTER_SETTINGS";var c=["hotel_composite_score","connector_pref","hotel_name","hotel_price_ascending","hotel_price_descending","package_savings_price_descending","package_savings_percent_descending","hotel_min_room_strikethrough_price","hotel_rating","hotel_choice_model"];function q(){l=e("hotel_filters");b=e("avail_sort_select");if(l){j=l.down(".mapAddressSearchContainer");k=l.down("#hotelFilterPriceContainer");r=l.down("#hotelFilterRatingContainer");u=l.down(".city_filter");o=l.down(".amenities_filter");m=l.down(".neighborhood_filter");}}function t(v){return v.replace("px","");}function f(){if(u){var v=u.down("input[name=locationId]:checked");if(v){v.up(".radioLabeledInput").addClassName("activeLabeledInput");}}}function s(){if(h.lastScrollPosition>0){window.scrollTo(0,h.lastScrollPosition);}}function n(){var w=h.selectedHotelIndex,v=i("input[name=hotel_index][value="+w+"]").first();if(w>-1&&v){v.up(".supplier_detail").next().down(".show-hide-button").innerHTML=h.hideRoomTypeOptions;v.up(".hotel-card-component").next().show();}}this.saveHotelSearchFilterSettings=function(v){EzRez.Util.Cookie.create(p,JSON.stringify(this.getCurrentHotelSearchFilterSettings(v)));};this.getCurrentHotelSearchFilterSettings=function(w){q();var J={};var v=i("input[name=hotel_index]").first();if(v){J.startIndex=parseInt(v.value,10)||1;}if(b){var B=b.value;J.sortBy=c.include(B)?B:null;}if(l){if(j){J.findHotelsNearbyMapGeoLocation=a.Search.cityMapGeoLocation;var D=j.down("[name=defaultFindHotelByAddressText]").value;var G=j.down("input.nearbyAddress").value;J.findHotelsNearby=(D!==G)?G:"";}if(k){J.priceRangeMinimum=parseFloat(k.down("input.min").value);J.priceRangeMaximum=parseFloat(k.down("input.max").value);J.priceRangeMinimumPosition=Math.ceil(t(k.down(".thumbMin").getStyle("left")));J.priceRangeMaximumPosition=Math.ceil(t(k.down(".thumbMax").getStyle("left")));}if(r){J.starRatingMinimum=parseFloat(r.down("input.min").value);J.starRatingMaximum=parseFloat(r.down("input.max").value);J.starRatingMinimumPosition=Math.ceil(t(r.down(".thumbMin").getStyle("left")));J.starRatingMaximumPosition=Math.ceil(t(r.down(".thumbMax").getStyle("left")));}if(u){var E=u.down("input[name=locationId]:checked");var z=a.Search.cityFilterGeoLocations;if(E&&z){var F=E.value;var A=z[F];if(A){J.latitude=A.lat;J.longitude=A.lng;J.city=F;}}J.cityLocationFilterRadius=parseFloat(u.down("select[name=locationFilterRadius]").value);var I=u.down("input[name=toggleUnits]:checked");if(I){J.units=I.value;}}if(o){var y=o.select("input[name=amenities]:checked");if(y.length){J.amenities=y.collect(function(K){return K.value;});}}if(m){var x=m.select("input[name=neighborhood_ids]:checked");if(x.length){J.neighborhoods=x.collect(function(K){return K.value;});}}var H=document.documentElement;var C=document.body;J.scrollPosition=parseFloat(H&&H.scrollTop||C&&C.scrollTop||0);}if(w){J.selectedHotelIndex=parseInt(d.findHotelIndex(w));}return J;};this.removeHotelSearchFilterSettings=function(){EzRez.Util.Cookie.erase(p);};this.findHotelIndex=function(w){var v=w.up(".drawer");if(w.className=="choose-and-continue"){return w.up(".hotel-card-component").down("[name='hotel_index']").value;}else{if(v){return v.previous().down("[name='hotel_index']").value;}}};this.applyListeners=function(){e(document.body).on("click","a.choose-and-continue",function(v){d.saveHotelSearchFilterSettings(v.target);});};this.executeSavedHotelSearchFilters=function(){f();s();var v=i(".drawer");if(v.length>0){n();}};q();};a.createUIComponent("searchFilterSettingsComponent",{initialize:function(b){return new EzRez.UI.SearchFilterSettingsComponent(b,$$,$);},applyListeners:function(b){b.applyListeners();}});})(EzRez.Application);(function(a){var b=function(d){var e=f(d);function f(g){return $H({followerElementAnimate:true,followersConfigs:[]}).merge(g).toObject();}function c(h,g){var i=$H({follower:{},topBoundaryElement:{},bottomBoundaryElement:{},boundaryOffsetThreshold:10}).merge(h).toObject();var s=i.follower.getDimensions().height+i.boundaryOffsetThreshold,k=document.viewport.getScrollOffsets().top,n=i.follower.cumulativeOffset().top+s,t=i.topBoundaryElement.cumulativeOffset().top-i.boundaryOffsetThreshold,o=i.bottomBoundaryElement.cumulativeOffset().top;var j=n<o;var r=k>t;var q=(k-t);if(q<0){q=0;}else{var p=q+t+s>=o;if(p){q=o-s-t;if(q<0){q=0;}}}var l=i.follower.getStyle("top")||"0px";var m=l.replace("px","")>q;if((r&&j)||(m)){i.follower.setStyle({top:q+"px",position:"absolute"});if(g){i.follower.addClassName("followerElementAnimate");}}}this.initFollowersConfigs=function(g){e=f(g);};this.adjust=function(){for(var g=0;g<e.followersConfigs.length;g++){c(e.followersConfigs[g],e.followerElementAnimate);}};this.applyListeners=function(){Event.observe(window,"scroll",this.adjust);};};a.createUIComponent("followMeComponent",{initialize:function(c){return new b(c);},applyListeners:function(c){c.applyListeners();}});})(EzRez.Application);(function(a){var b=function(h){var k=Object.extend({taxLinkPopupClassname:"taxLinkPopUp",taxPopupTextClassname:"taxPopupText",taxDisplayPanelId:"taxDisplayPanel"},h);var d=null;var e=false;var c=function(){d.hide();e=false;};var j=function(o){var q=o.cumulativeOffset(),p=o.getDimensions(),n=o.next("."+k.taxPopupTextClassname),m=$$(".yui-panel-container")[0];d.setBody(n.innerHTML);d.cfg.setProperty("x",q.left+p.width);d.cfg.setProperty("y",q.top+p.height);d.render(document.body);m.style.left=d.cfg.getProperty("x")+"px";m.style.top=d.cfg.getProperty("y")+"px";m.show();d.show();e=true;};var l=function(m){Event.stop(m);if(d.cfg.getProperty("visible")){c();return;}var n=m.findElement("."+k.taxLinkPopupClassname);j(n);};var g=function(m){if(Event.findElement(m,"a."+k.taxLinkPopupClassname)){l(m);}else{if(e&&!Event.findElement(m,"#"+k.taxDisplayPanelId)){c();}}};var i=function(m){Event.stop(m);c();};var f=function(){d=new YAHOO.widget.Panel(k.taxDisplayPanelId,{constraintoviewport:true,visible:false,draggable:false,monitorresize:false,iframe:true,close:false,width:"400px"});d.setHeader("<a class='container-close' href='#' alt='close' title='close'>X</a>");d.render(document.body);};this.applyListeners=function(){document.observe("click",g);$(k.taxDisplayPanelId).down("a.container-close").observe("click",i);};this.removeListeners=function(){document.stopObserving("click",g);$(k.taxDisplayPanelId).down("a.container-close").stopObserving("click",i);};f();};a.createUIComponent("taxExclusivePopUp",{initialize:function(c){return new b(c);},applyListeners:function(c){c.applyListeners();},removeListeners:function(c){c.removeListeners();},unload:function(c){c.removeListeners();}});})(EzRez.Application);